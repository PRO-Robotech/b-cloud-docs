"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[473,19678,29395,40008,47291,53843,62251,84207,94869],{6353:(e,s,t)=>{t.d(s,{$:()=>d});var r=t(7478);const d={etcdCA:{keyPath:`${r.M.kubernetesBaseFolderPath.value}/pki/etcd/ca.key`,crtPath:`${r.M.kubernetesBaseFolderPath.value}/pki/etcd/ca.crt`,csrPath:"",crtConf:`${r.M.kubernetesBaseFolderPath.value}/openssl/etcd-ca.conf`,keySize:"2048",cname:"etcd-ca"},kubernetesCA:{keyPath:`${r.M.kubernetesBaseFolderPath.value}/pki/ca.key`,crtPath:`${r.M.kubernetesBaseFolderPath.value}/pki/ca.crt`,csrPath:"",crtConf:`${r.M.kubernetesBaseFolderPath.value}/openssl/ca.conf`,keySize:"2048",cname:"kubernetes"},frontProxyCA:{keyPath:`${r.M.kubernetesBaseFolderPath.value}/pki/front-proxy-ca.key`,crtPath:`${r.M.kubernetesBaseFolderPath.value}/pki/front-proxy-ca.crt`,csrPath:"",crtConf:`${r.M.kubernetesBaseFolderPath.value}/openssl/front-proxy-ca.conf`,keySize:"2048",cname:"front-proxy-ca"},kubernetesControllerManagerClient:{keyPath:`${r.M.kubernetesBaseFolderPath.value}/kubeconfig/controller-manager-client-key.pem`,crtPath:`${r.M.kubernetesBaseFolderPath.value}/kubeconfig/controller-manager-client.pem`,csrPath:`${r.M.kubernetesBaseFolderPath.value}/openssl/csr/controller-manager-client.csr`,crtConf:`${r.M.kubernetesBaseFolderPath.value}/openssl/controller-manager-client.conf`,keySize:"2048",cname:"system:kube-controller-manager"},etcdClient:{keyPath:`${r.M.kubernetesBaseFolderPath.value}/pki/etcd/healthcheck-client.key`,crtPath:`${r.M.kubernetesBaseFolderPath.value}/pki/etcd/healthcheck-client.crt`,csrPath:`${r.M.kubernetesBaseFolderPath.value}/openssl/csr/etcd-client.csr`,crtConf:`${r.M.kubernetesBaseFolderPath.value}/openssl/healthcheck-client.conf`,keySize:"2048",cname:"kube-etcd-healthcheck-client"},etcdServer:{keyPath:`${r.M.kubernetesBaseFolderPath.value}/pki/etcd/server.key`,crtPath:`${r.M.kubernetesBaseFolderPath.value}/pki/etcd/server.crt`,csrPath:`${r.M.kubernetesBaseFolderPath.value}/openssl/csr/etcd-server.csr`,crtConf:`${r.M.kubernetesBaseFolderPath.value}/openssl/etcd-server.conf`,keySize:"2048",cname:""},etcdPeer:{keyPath:`${r.M.kubernetesBaseFolderPath.value}/pki/etcd/peer.key`,crtPath:`${r.M.kubernetesBaseFolderPath.value}/pki/etcd/peer.crt`,csrPath:`${r.M.kubernetesBaseFolderPath.value}/openssl/csr/etcd-peer.csr`,crtConf:`${r.M.kubernetesBaseFolderPath.value}/openssl/etcd-peer.conf`,keySize:"2048",cname:""},kubernetesKubeletClient:{keyPath:`${r.M.kubernetesBaseFolderPath.value}/pki/apiserver-kubelet-client.key`,crtPath:`${r.M.kubernetesBaseFolderPath.value}/pki/apiserver-kubelet-client.crt`,csrPath:`${r.M.kubernetesBaseFolderPath.value}/openssl/csr/apiserver-kubelet-client.csr`,crtConf:`${r.M.kubernetesBaseFolderPath.value}/openssl/apiserver-kubelet-client.conf`,keySize:"2048",cname:"kube-apiserver-kubelet-client"},kubernetesFrontProxyClient:{keyPath:`${r.M.kubernetesBaseFolderPath.value}/pki/front-proxy-client.key`,crtPath:`${r.M.kubernetesBaseFolderPath.value}/pki/front-proxy-client.crt`,csrPath:`${r.M.kubernetesBaseFolderPath.value}/openssl/csr/front-proxy-client.csr`,crtConf:`${r.M.kubernetesBaseFolderPath.value}/openssl/front-proxy-client.conf`,keySize:"2048",cname:"front-proxy-client"},kubernetesEtcdClient:{keyPath:`${r.M.kubernetesBaseFolderPath.value}/pki/apiserver-etcd-client.key`,crtPath:`${r.M.kubernetesBaseFolderPath.value}/pki/apiserver-etcd-client.crt`,csrPath:`${r.M.kubernetesBaseFolderPath.value}/openssl/csr/apiserver-etcd-client.csr`,crtConf:`${r.M.kubernetesBaseFolderPath.value}/openssl/apiserver-etcd-client.conf`,keySize:"2048",cname:"kube-apiserver-etcd-client"},kubernetesServer:{keyPath:`${r.M.kubernetesBaseFolderPath.value}/pki/apiserver.key`,crtPath:`${r.M.kubernetesBaseFolderPath.value}/pki/apiserver.crt`,csrPath:`${r.M.kubernetesBaseFolderPath.value}/openssl/csr/apiserver.csr`,crtConf:`${r.M.kubernetesBaseFolderPath.value}/openssl/apiserver.conf`,keySize:"2048",cname:"kube-apiserver"},kubernetesSuperAdminClient:{keyPath:`${r.M.kubernetesBaseFolderPath.value}/kubeconfig/super-admin.key`,crtPath:`${r.M.kubernetesBaseFolderPath.value}/kubeconfig/super-admin.crt`,csrPath:`${r.M.kubernetesBaseFolderPath.value}/openssl/csr/super-admin.csr`,crtConf:`${r.M.kubernetesBaseFolderPath.value}/openssl/super-admin.conf`,keySize:"2048",cname:"kubernetes-super-admin"},kubernetesAdminClient:{keyPath:`${r.M.kubernetesBaseFolderPath.value}/kubeconfig/admin.key`,crtPath:`${r.M.kubernetesBaseFolderPath.value}/kubeconfig/admin.crt`,csrPath:`${r.M.kubernetesBaseFolderPath.value}/openssl/csr/admin.csr`,crtConf:`${r.M.kubernetesBaseFolderPath.value}/openssl/admin.conf`,keySize:"2048",cname:"kubernetes-admin"},kubernetesSA:{keyPath:`${r.M.kubernetesBaseFolderPath.value}/pki/sa.key`,crtPath:`${r.M.kubernetesBaseFolderPath.value}/pki/sa.pub`,csrPath:"",crtConf:"",keySize:"2048",cname:""},kubeletClient:{keyPath:`${r.M.kuberneteKubeletFolderPath.value}/pki/kubelet-client-key.pem`,crtPath:`${r.M.kuberneteKubeletFolderPath.value}/pki/kubelet-client.pem`,csrPath:`${r.M.kubernetesBaseFolderPath.value}/openssl/csr/kubelet-client.csr`,crtConf:`${r.M.kubernetesBaseFolderPath.value}/openssl/kubelet-client.conf`,keySize:"2048",cname:""},kubeletServer:{keyPath:`${r.M.kuberneteKubeletFolderPath.value}/pki/kubelet-server-key.pem`,crtPath:`${r.M.kuberneteKubeletFolderPath.value}/pki/kubelet-server.pem`,csrPath:`${r.M.kubernetesBaseFolderPath.value}/openssl/csr/kubelet-server.csr`,crtConf:`${r.M.kubernetesBaseFolderPath.value}/openssl/kubelet-server.conf`,keySize:"2048",cname:""},kubeletCurrentClient:{keyPath:"",crtPath:`${r.M.kuberneteKubeletFolderPath.value}/pki/kubelet-client-current.pem`,csrPath:"",crtConf:"",keySize:"2048",cname:""},kubeletNowClient:{keyPath:"",crtPath:`${r.M.kuberneteKubeletFolderPath.value}/pki/kubelet-client-$(date '+%Y-%m-%d-%H-%M-%S').pem`,csrPath:"",crtConf:"",keySize:"2048",cname:""},kubeletCurrentServer:{keyPath:"",crtPath:`${r.M.kuberneteKubeletFolderPath.value}/pki/kubelet-server-current.pem`,csrPath:"",crtConf:"",keySize:"2048",cname:""},kubeletNowServer:{keyPath:"",crtPath:`${r.M.kuberneteKubeletFolderPath.value}/pki/kubelet-server-$(date '+%Y-%m-%d-%H-%M-%S').pem`,csrPath:"",crtConf:"",keySize:"2048",cname:""},kubernetesSchedulerClient:{keyPath:`${r.M.kubernetesBaseFolderPath.value}/kubeconfig/scheduler-client-key.pem`,crtPath:`${r.M.kubernetesBaseFolderPath.value}/kubeconfig/scheduler-client.pem`,csrPath:`${r.M.kubernetesBaseFolderPath.value}/openssl/csr/scheduler-client.csr`,crtConf:`${r.M.kubernetesBaseFolderPath.value}/openssl/scheduler-client.conf`,keySize:"2048",cname:"system:kube-scheduler"}}},8450:(e,s,t)=>{t.r(s),t.d(s,{ETCD_api_address:()=>S,ETCD_endpoint_1:()=>A,ETCD_endpoint_2:()=>N,ETCD_endpoint_3:()=>k,ETCD_endpoints:()=>$,ETCD_etcd_pod_1:()=>b,ETCD_etcd_pod_2:()=>m,ETCD_etcd_pod_3:()=>C,ETCD_k8s_cluster_name:()=>f,ETCD_k8s_node_1:()=>_,ETCD_k8s_node_2:()=>B,ETCD_k8s_node_3:()=>v,ETCD_k8s_node_address_1:()=>g,ETCD_k8s_node_address_2:()=>P,ETCD_k8s_node_address_3:()=>T,assets:()=>E,contentTitle:()=>p,default:()=>R,frontMatter:()=>j,metadata:()=>r,toc:()=>y});const r=JSON.parse('{"id":"tech-docs/etcd/troubleshooting/restore/ThreeNodeK8s","title":"ThreeNodeK8s","description":"\u0412 \u0434\u0430\u043d\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u0435\u0441\u043b\u0438 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0443\u0437\u043b\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u0432 \u0435\u0433\u043e \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0431\u0443\u0434\u0443\u0442 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c","source":"@site/docs/tech-docs/etcd/troubleshooting/restore/threeNodeK8s.mdx","sourceDirName":"tech-docs/etcd/troubleshooting/restore","slug":"/tech-docs/etcd/troubleshooting/restore/ThreeNodeK8s","permalink":"/tech-docs/etcd/troubleshooting/restore/ThreeNodeK8s","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"ThreeNodeK8s"}}');var d=t(74848),n=t(28453),l=t(1775),c=t(60513),i=t(7478),a=t(87464),h=t(62774),o=t(10119),D=(t(80206),t(6353)),u=t(31798),x=t(57462);const j={id:"ThreeNodeK8s"},p=void 0,E={},$="https://10.10.10.3:2379,https://10.10.10.4:2379,https://10.10.10.5:2379",A="https://10.10.10.3:2379",N="https://10.10.10.4:2379",k="https://10.10.10.5:2379",b="etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-7plhz",m="etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-h9g49",C="etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-wps6k",_="in-cloud-k8s-sandbox-dev-csko-1-tcgzn-7plhz",B="in-cloud-k8s-sandbox-dev-csko-1-tcgzn-h9g49",v="in-cloud-k8s-sandbox-dev-csko-1-tcgzn-wps6k",g="10.10.10.3",P="10.10.10.4",T="10.10.10.5",S="10.10.10.2",f="in-cloud-k8s-sandbox-test-csko-1",y=[];function O(e){const s={a:"a",admonition:"admonition",code:"code",li:"li",ol:"ol",p:"p",...(0,n.R)(),...e.components};return x.YX||M("ThreeNodeFunctionsK8s",!1),x.YX.Input1||M("ThreeNodeFunctionsK8s.Input1",!0),x.YX.Output1||M("ThreeNodeFunctionsK8s.Output1",!0),x.YX.Provider||M("ThreeNodeFunctionsK8s.Provider",!0),(0,d.jsxs)(x.YX.Provider,{children:[(0,d.jsx)(x.YX.Input1,{}),(0,d.jsx)(x.YX.Output1,{}),(0,d.jsx)(s.admonition,{type:"warning",children:(0,d.jsx)(s.p,{children:"\u0412 \u0434\u0430\u043d\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u0435\u0441\u043b\u0438 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0443\u0437\u043b\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u0432 \u0435\u0433\u043e \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0431\u0443\u0434\u0443\u0442 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c\n\u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0438 \u0438\u043c\u0435\u043d\u0430 \u0434\u0440\u0443\u0433\u0438\u0445 \u0443\u0437\u043b\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435 \u0441\u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u043c \u0443\u0437\u043b\u043e\u043c,\n\u0442\u043e\u0433\u0434\u0430 \u043f\u043e\u0434 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043c\u043e\u0436\u0435\u0442 \u043f\u0430\u0434\u0430\u0442\u044c \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439, \u0434\u043e \u0442\u0435\u0445 \u043f\u043e\u0440, \u043f\u043e\u043a\u0430 \u043d\u0430 \u0434\u0440\u0443\u0433\u0438\u0445 \u0443\u0437\u043b\u0430\u0445 \u043d\u0435 \u043f\u043e\u044f\u0432\u0438\u0442\u0441\u044f \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u0430\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f."})}),(0,d.jsx)(s.p,{children:"\u0428\u0430\u0433\u0438 \u0441 1 \u043f\u043e 8 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u0442\u0441\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e \u043d\u0430 \u0432\u0441\u0435\u0445 \u0442\u0440\u0435\u0445 \u0443\u0437\u043b\u0430\u0445 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."}),(0,d.jsxs)(h.A,{groupId:"etcd-node",children:[(0,d.jsxs)(a.A,{value:"Master-1",children:[(0,d.jsxs)(s.ol,{children:["\n",(0,d.jsxs)(s.li,{children:["\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0444\u0430\u0439\u043b \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043d\u0438\u043c\u043a\u0430 \u043d\u0430 \u0412\u041c \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e \u043f\u0443\u0442\u0438 ",(0,d.jsxs)("code",{children:[o.D.workDir.value,"/backup.db"]})," \u043f\u0440\u0438 \u043f\u043e\u043c\u043e\u0449\u0438 rsync"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        ssh capv@$\{K8S_NODE_ADDRESS_1} "mkdir -p ${o.D.workDir.value}"
        rsync --rsync-path="sudo rsync" \
          LOCAL_PATH_TO_BACKUP/backup.db \
          capv@$\{K8S_NODE_ADDRESS_1}:${o.D.workDir.value}/backup.db
      `}),(0,d.jsxs)(s.ol,{start:"2",children:["\n",(0,d.jsxs)(s.li,{children:["\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a \u0412\u041c \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e ssh \u0438 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043d\u0430 \u0441\u0443\u043f\u0435\u0440\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.\n\u0417\u0430\u0442\u0435\u043c \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 ",(0,d.jsx)(s.code,{children:"kubelet"}),", \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u0438\u0442\u044c \u0435\u043c\u0443 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c ETCD."]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"systemctl stop kubelet"}),(0,d.jsxs)(s.ol,{start:"3",children:["\n",(0,d.jsxs)(s.li,{children:["\u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 \u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 ",(0,d.jsx)(s.code,{children:"etcd"}),":"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        export CONTAINER_ID="$(crictl ps -a  \
          --label io.kubernetes.container.name=etcd \
          --label io.kubernetes.pod.namespace=kube-system \
          | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"
        crictl stop \${CONTAINER_ID}
        crictl rm \${CONTAINER_ID}
      `}),(0,d.jsxs)(s.ol,{start:"4",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 ",(0,d.jsx)(s.a,{href:"#%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-%D1%80%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%BD%D0%BE%D0%B9-%D0%BA%D0%BE%D0%BF%D0%B8%D0%B8-%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2-%D0%B1%D0%B4",children:"\u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e"}),"."]}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0441\u0442\u0430\u0440\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0438\u0437 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,d.jsx)("code",{children:o.D.dataDir.value})]}),"\n"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:`rm -rf ${o.D.dataDir.value}/*`}),(0,d.jsxs)(s.ol,{start:"6",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u044c\u0442\u0435 \u0411\u0414 \u0438\u0437 \u0441\u043d\u0438\u043c\u043a\u0430:"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        etcdctl snapshot restore ${o.D.workDir.value}/backup.db \
          --name=\${K8S_NODE_1} \
          --data-dir ${o.D.dataDir.value} \
          --initial-advertise-peer-urls=https://\${K8S_NODE_ADDRESS_1}:2380 \
          --initial-cluster=\${K8S_NODE_1}=https://\${K8S_NODE_ADDRESS_1}:${u.h.etcdPeer.portNumber},\${K8S_NODE_2}=https://\${K8S_NODE_ADDRESS_2}:${u.h.etcdPeer.portNumber},\${K8S_NODE_3}=https://\${K8S_NODE_ADDRESS_3}:${u.h.etcdPeer.portNumber}
      `}),(0,d.jsx)(s.admonition,{type:"note",children:(0,d.jsxs)(s.p,{children:["\u041e\u0431\u0440\u0430\u0442\u0438\u0442\u0435 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435, \u0447\u0442\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0444\u0430\u0439\u043b ",(0,d.jsx)(s.code,{children:"etcdctl"})," \u0438 \u0441\u043d\u0438\u043c\u043e\u043a \u0442\u0430\u043a \u0436\u0435 \u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0435\u043d \u043d\u0430 \u043c\u0430\u0441\u0442\u0435\u0440\u0435 \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,d.jsx)("code",{children:o.D.workDir.value}),".\n\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 ",(0,d.jsx)(s.code,{children:"data-dir"})," \u0443\u043a\u0430\u0437\u0430\u043d\u0430 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u043d\u0430 \u0445\u043e\u0441\u0442\u0435, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043c\u043e\u043d\u0442\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0432\u043d\u0443\u0442\u0440\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 ETCD \u0438 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432 \u0411\u0414."]})}),(0,d.jsxs)(s.ol,{start:"7",children:["\n",(0,d.jsxs)(s.li,{children:["\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0438 \u043f\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u043f\u0443\u0441\u043a\u0430 ETCD \u0432 \u0444\u0430\u0439\u043b\u0435 ",(0,d.jsxs)("code",{children:["$",i.M.kubernetesBaseFolderPath.value,"/manifests/etcd.yaml"]}),"\n\u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 ",(0,d.jsx)(s.code,{children:"spec.containers[0].command"}),".\n\u0410 \u0438\u043c\u0435\u043d\u043d\u043e \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0445 \u043f\u043e\u043b\u0435\u0439 \u0438 \u0438\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, \u043f\u043e\u043b\u044f \u043d\u0435 \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0432 \u0434\u0430\u043d\u043d\u044b\u0439 \u043f\u0435\u0440\u0435\u0447\u0435\u043d\u044c \u0443\u0434\u0430\u043b\u044f\u0442\u044c \u043d\u0435 \u043d\u0443\u0436\u043d\u043e!"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:`--advertise-client-urls=${A}\n  --cert-file=${D.$.etcdServer.crtPath}\n  --client-cert-auth=true\n  --data-dir=${o.D.dataDir.value}\n  --key-file=${D.$.etcdServer.keyPath}\n  --listen-client-urls=https://127.0.0.1:${u.h.etcdServer.portNumber},${A}\n  --listen-metrics-urls=http://0.0.0.0:${u.h.etcdMetricServer.portNumber}\n  --listen-peer-urls=https://${g}:${u.h.etcdPeer.portNumber}\n  --name=${_}\n  --peer-cert-file=${D.$.etcdPeer.crtPath}\n  --peer-client-cert-auth=true\n  --peer-key-file=${D.$.etcdPeer.keyPath}\n  --peer-trusted-ca-file=${D.$.etcdCA.crtPath}\n  --trusted-ca-file=${D.$.etcdCA.keyPath}\n`}),(0,d.jsxs)("table",{children:[(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440"}),(0,d.jsx)("th",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"advertise-client-urls"})," "]}),(0,d.jsx)("td",{children:"\u0410\u043d\u043e\u043d\u0441\u0438\u0440\u0443\u0435\u043c\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0443\u0437\u043b\u0443, \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432. \u0421\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442 \u0441 IP \u0430\u0434\u0440\u0435\u0441\u043e\u043c \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"cert-file"}),"             "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"client-cert-auth"}),"      "]}),(0,d.jsx)("td",{children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c/\u0432\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043f\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0443"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"data-dir"}),"              "]}),(0,d.jsx)("td",{children:"\u0414\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0444\u0430\u0439\u043b\u044b \u0411\u0414 ETCD"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"key-file"}),"              "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-client-urls"}),"    "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-metrics-urls"}),"   "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a \u043c\u0435\u0442\u0440\u0438\u043a\u0430\u043c (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-peer-urls"}),"      "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043e\u0442 \u0434\u0440\u0443\u0433\u0438\u0445 \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"name"}),"                  "]}),(0,d.jsx)("td",{children:"\u0418\u043c\u044f \u0443\u0437\u043b\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-cert-file"}),"        "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-client-cert-auth"})," "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-key-file"}),"         "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-trusted-ca-file"}),"  "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"trusted-ca-file"}),"       "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]})]}),(0,d.jsx)(s.admonition,{type:"note",children:(0,d.jsxs)(s.p,{children:["\u0415\u0441\u043b\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 ",(0,d.jsx)(s.code,{children:"initial-cluster-state"}),' \u0440\u0430\u0432\u0435\u043d \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044e "existing" \u0438\u043b\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0444\u0430\u0439\u043b\u044b \u0411\u0414 \u0438 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u043d\u0435\u0439,\n\u0442\u043e\u0433\u0434\u0430 \u0432\u0441\u0435 \u043f\u0440\u043e\u0447\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b, \u0438\u043c\u044f \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442\u0441\u044f \u0441\u043e \u0441\u043b\u043e\u0432\u0430 ',(0,d.jsx)(s.code,{children:"initial"})," \u0431\u0443\u0434\u0443\u0442 \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f.\n\u0412 \u043d\u0430\u0448\u0435\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u043c\u044b \u0443\u0436\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u043b\u0438 \u0444\u0430\u0439\u043b\u044b \u0411\u0414 \u0438 \u0432\u043d\u0435\u0441\u043b\u0438 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430 \u044d\u0442\u0430\u043f\u0435 \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0438 \u0411\u0414 \u0438\u0437 \u0441\u043d\u0438\u043c\u043a\u0430."]})}),(0,d.jsxs)(s.ol,{start:"8",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u044b\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043d\u0430 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u0443\u0437\u043b\u0430\u0445 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"\u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 kubelet:"}),"\n"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"systemctl start kubelet"}),(0,d.jsxs)(s.ol,{start:"10",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0438 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043e\u0448\u0438\u0431\u043e\u043a"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        export CONTAINER_ID="$(crictl ps -a  \
          --label io.kubernetes.container.name=etcd \
          --label io.kubernetes.pod.namespace=kube-system \
          | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"

        crictl ps --id $CONTAINER_ID

        crictl logs $CONTAINER_ID
      `})]}),(0,d.jsxs)(a.A,{value:"Master-2",children:[(0,d.jsxs)(s.ol,{children:["\n",(0,d.jsxs)(s.li,{children:["\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0444\u0430\u0439\u043b \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043d\u0438\u043c\u043a\u0430 \u043d\u0430 \u0412\u041c \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e \u043f\u0443\u0442\u0438 ",(0,d.jsxs)("code",{children:[o.D.workDir.value,"/backup.db"]})," \u043f\u0440\u0438 \u043f\u043e\u043c\u043e\u0449\u0438 rsync"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        ssh capv@$\{K8S_NODE_ADDRESS_1} "mkdir -p ${o.D.workDir.value}"
        rsync --rsync-path="sudo rsync" \
          LOCAL_PATH_TO_BACKUP/backup.db \
          capv@$\{K8S_NODE_ADDRESS_1}:${o.D.workDir.value}/backup.db
      `}),(0,d.jsxs)(s.ol,{start:"2",children:["\n",(0,d.jsxs)(s.li,{children:["\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a \u0412\u041c \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e ssh \u0438 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043d\u0430 \u0441\u0443\u043f\u0435\u0440\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.\n\u0417\u0430\u0442\u0435\u043c \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 ",(0,d.jsx)(s.code,{children:"kubelet"}),", \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u0438\u0442\u044c \u0435\u043c\u0443 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c ETCD."]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"systemctl stop kubelet"}),(0,d.jsxs)(s.ol,{start:"3",children:["\n",(0,d.jsxs)(s.li,{children:["\u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 \u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 ",(0,d.jsx)(s.code,{children:"etcd"}),":"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        export CONTAINER_ID="$(crictl ps -a  \
          --label io.kubernetes.container.name=etcd \
          --label io.kubernetes.pod.namespace=kube-system \
          | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"
        crictl stop \${CONTAINER_ID}
        crictl rm \${CONTAINER_ID}
      `}),(0,d.jsxs)(s.ol,{start:"4",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 ",(0,d.jsx)(s.a,{href:"#%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-%D1%80%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%BD%D0%BE%D0%B9-%D0%BA%D0%BE%D0%BF%D0%B8%D0%B8-%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2-%D0%B1%D0%B4",children:"\u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e"}),"."]}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0441\u0442\u0430\u0440\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0438\u0437 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,d.jsx)("code",{children:o.D.dataDir.value})]}),"\n"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:`rm -rf ${o.D.dataDir.value}/*`}),(0,d.jsxs)(s.ol,{start:"6",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u044c\u0442\u0435 \u0411\u0414 \u0438\u0437 \u0441\u043d\u0438\u043c\u043a\u0430:"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        etcdctl snapshot restore ${o.D.workDir.value}/backup.db \
          --name=\${K8S_NODE_1} \
          --data-dir ${o.D.dataDir.value} \
          --initial-advertise-peer-urls=https://\${K8S_NODE_ADDRESS_1}:2380 \
          --initial-cluster=\${K8S_NODE_1}=https://\${K8S_NODE_ADDRESS_1}:${u.h.etcdPeer.portNumber},\${K8S_NODE_2}=https://\${K8S_NODE_ADDRESS_2}:${u.h.etcdPeer.portNumber},\${K8S_NODE_3}=https://\${K8S_NODE_ADDRESS_3}:${u.h.etcdPeer.portNumber}
      `}),(0,d.jsx)(s.admonition,{type:"note",children:(0,d.jsxs)(s.p,{children:["\u041e\u0431\u0440\u0430\u0442\u0438\u0442\u0435 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435, \u0447\u0442\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0444\u0430\u0439\u043b ",(0,d.jsx)(s.code,{children:"etcdctl"})," \u0438 \u0441\u043d\u0438\u043c\u043e\u043a \u0442\u0430\u043a \u0436\u0435 \u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0435\u043d \u043d\u0430 \u043c\u0430\u0441\u0442\u0435\u0440\u0435 \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,d.jsx)("code",{children:o.D.workDir.value}),".\n\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 ",(0,d.jsx)(s.code,{children:"data-dir"})," \u0443\u043a\u0430\u0437\u0430\u043d\u0430 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u043d\u0430 \u0445\u043e\u0441\u0442\u0435, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043c\u043e\u043d\u0442\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0432\u043d\u0443\u0442\u0440\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 ETCD \u0438 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432 \u0411\u0414."]})}),(0,d.jsxs)(s.ol,{start:"7",children:["\n",(0,d.jsxs)(s.li,{children:["\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0438 \u043f\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u043f\u0443\u0441\u043a\u0430 ETCD \u0432 \u0444\u0430\u0439\u043b\u0435 ",(0,d.jsxs)("code",{children:["$",i.M.kubernetesBaseFolderPath.value,"/manifests/etcd.yaml"]}),"\n\u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 ",(0,d.jsx)(s.code,{children:"spec.containers[0].command"}),".\n\u0410 \u0438\u043c\u0435\u043d\u043d\u043e \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0445 \u043f\u043e\u043b\u0435\u0439 \u0438 \u0438\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, \u043f\u043e\u043b\u044f \u043d\u0435 \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0432 \u0434\u0430\u043d\u043d\u044b\u0439 \u043f\u0435\u0440\u0435\u0447\u0435\u043d\u044c \u0443\u0434\u0430\u043b\u044f\u0442\u044c \u043d\u0435 \u043d\u0443\u0436\u043d\u043e!"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:`--advertise-client-urls=${A}\n  --cert-file=${D.$.etcdServer.crtPath}\n  --client-cert-auth=true\n  --data-dir=${o.D.dataDir.value}\n  --key-file=${D.$.etcdServer.keyPath}\n  --listen-client-urls=https://127.0.0.1:${u.h.etcdServer.portNumber},${A}\n  --listen-metrics-urls=http://0.0.0.0:${u.h.etcdMetricServer.portNumber}\n  --listen-peer-urls=https://${g}:${u.h.etcdPeer.portNumber}\n  --name=${_}\n  --peer-cert-file=${D.$.etcdPeer.crtPath}\n  --peer-client-cert-auth=true\n  --peer-key-file=${D.$.etcdPeer.keyPath}\n  --peer-trusted-ca-file=${D.$.etcdCA.crtPath}\n  --trusted-ca-file=${D.$.etcdCA.keyPath}\n`}),(0,d.jsxs)("table",{children:[(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440"}),(0,d.jsx)("th",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"advertise-client-urls"})," "]}),(0,d.jsx)("td",{children:"\u0410\u043d\u043e\u043d\u0441\u0438\u0440\u0443\u0435\u043c\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0443\u0437\u043b\u0443, \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432. \u0421\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442 \u0441 IP \u0430\u0434\u0440\u0435\u0441\u043e\u043c \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"cert-file"}),"             "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"client-cert-auth"}),"      "]}),(0,d.jsx)("td",{children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c/\u0432\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043f\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0443"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"data-dir"}),"              "]}),(0,d.jsx)("td",{children:"\u0414\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0444\u0430\u0439\u043b\u044b \u0411\u0414 ETCD"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"key-file"}),"              "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-client-urls"}),"    "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-metrics-urls"}),"   "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a \u043c\u0435\u0442\u0440\u0438\u043a\u0430\u043c (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-peer-urls"}),"      "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043e\u0442 \u0434\u0440\u0443\u0433\u0438\u0445 \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"name"}),"                  "]}),(0,d.jsx)("td",{children:"\u0418\u043c\u044f \u0443\u0437\u043b\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-cert-file"}),"        "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-client-cert-auth"})," "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-key-file"}),"         "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-trusted-ca-file"}),"  "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"trusted-ca-file"}),"       "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]})]}),(0,d.jsx)(s.admonition,{type:"note",children:(0,d.jsxs)(s.p,{children:["\u0415\u0441\u043b\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 ",(0,d.jsx)(s.code,{children:"initial-cluster-state"}),' \u0440\u0430\u0432\u0435\u043d \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044e "existing" \u0438\u043b\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0444\u0430\u0439\u043b\u044b \u0411\u0414 \u0438 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u043d\u0435\u0439,\n\u0442\u043e\u0433\u0434\u0430 \u0432\u0441\u0435 \u043f\u0440\u043e\u0447\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b, \u0438\u043c\u044f \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442\u0441\u044f \u0441\u043e \u0441\u043b\u043e\u0432\u0430 ',(0,d.jsx)(s.code,{children:"initial"})," \u0431\u0443\u0434\u0443\u0442 \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f.\n\u0412 \u043d\u0430\u0448\u0435\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u043c\u044b \u0443\u0436\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u043b\u0438 \u0444\u0430\u0439\u043b\u044b \u0411\u0414 \u0438 \u0432\u043d\u0435\u0441\u043b\u0438 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430 \u044d\u0442\u0430\u043f\u0435 \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0438 \u0411\u0414 \u0438\u0437 \u0441\u043d\u0438\u043c\u043a\u0430."]})}),(0,d.jsxs)(s.ol,{start:"8",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u044b\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043d\u0430 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u0443\u0437\u043b\u0430\u0445 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"\u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 kubelet:"}),"\n"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"systemctl start kubelet"}),(0,d.jsxs)(s.ol,{start:"10",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0438 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043e\u0448\u0438\u0431\u043e\u043a"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        export CONTAINER_ID="$(crictl ps -a  \
          --label io.kubernetes.container.name=etcd \
          --label io.kubernetes.pod.namespace=kube-system \
          | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"

        crictl ps --id $CONTAINER_ID

        crictl logs $CONTAINER_ID
      `})]}),(0,d.jsxs)(a.A,{value:"Master-3",children:[(0,d.jsxs)(s.ol,{children:["\n",(0,d.jsxs)(s.li,{children:["\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0444\u0430\u0439\u043b \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043d\u0438\u043c\u043a\u0430 \u043d\u0430 \u0412\u041c \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e \u043f\u0443\u0442\u0438 ",(0,d.jsxs)("code",{children:[o.D.workDir.value,"/backup.db"]})," \u043f\u0440\u0438 \u043f\u043e\u043c\u043e\u0449\u0438 rsync"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        ssh capv@$\{K8S_NODE_ADDRESS_1} "mkdir -p ${o.D.workDir.value}"
        rsync --rsync-path="sudo rsync" \
          LOCAL_PATH_TO_BACKUP/backup.db \
          capv@$\{K8S_NODE_ADDRESS_1}:${o.D.workDir.value}/backup.db
      `}),(0,d.jsxs)(s.ol,{start:"2",children:["\n",(0,d.jsxs)(s.li,{children:["\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a \u0412\u041c \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e ssh \u0438 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043d\u0430 \u0441\u0443\u043f\u0435\u0440\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.\n\u0417\u0430\u0442\u0435\u043c \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 ",(0,d.jsx)(s.code,{children:"kubelet"}),", \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u0438\u0442\u044c \u0435\u043c\u0443 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c ETCD."]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"systemctl stop kubelet"}),(0,d.jsxs)(s.ol,{start:"3",children:["\n",(0,d.jsxs)(s.li,{children:["\u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 \u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 ",(0,d.jsx)(s.code,{children:"etcd"}),":"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        export CONTAINER_ID="$(crictl ps -a  \
          --label io.kubernetes.container.name=etcd \
          --label io.kubernetes.pod.namespace=kube-system \
          | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"
        crictl stop \${CONTAINER_ID}
        crictl rm \${CONTAINER_ID}
      `}),(0,d.jsxs)(s.ol,{start:"4",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 ",(0,d.jsx)(s.a,{href:"#%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-%D1%80%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%BD%D0%BE%D0%B9-%D0%BA%D0%BE%D0%BF%D0%B8%D0%B8-%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2-%D0%B1%D0%B4",children:"\u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e"}),"."]}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0441\u0442\u0430\u0440\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0438\u0437 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,d.jsx)("code",{children:o.D.dataDir.value})]}),"\n"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:`rm -rf ${o.D.dataDir.value}/*`}),(0,d.jsxs)(s.ol,{start:"6",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u044c\u0442\u0435 \u0411\u0414 \u0438\u0437 \u0441\u043d\u0438\u043c\u043a\u0430:"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        etcdctl snapshot restore ${o.D.workDir.value}/backup.db \
          --name=\${K8S_NODE_1} \
          --data-dir ${o.D.dataDir.value} \
          --initial-advertise-peer-urls=https://\${K8S_NODE_ADDRESS_1}:2380 \
          --initial-cluster=\${K8S_NODE_1}=https://\${K8S_NODE_ADDRESS_1}:${u.h.etcdPeer.portNumber},\${K8S_NODE_2}=https://\${K8S_NODE_ADDRESS_2}:${u.h.etcdPeer.portNumber},\${K8S_NODE_3}=https://\${K8S_NODE_ADDRESS_3}:${u.h.etcdPeer.portNumber}
      `}),(0,d.jsx)(s.admonition,{type:"note",children:(0,d.jsxs)(s.p,{children:["\u041e\u0431\u0440\u0430\u0442\u0438\u0442\u0435 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435, \u0447\u0442\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0444\u0430\u0439\u043b ",(0,d.jsx)(s.code,{children:"etcdctl"})," \u0438 \u0441\u043d\u0438\u043c\u043e\u043a \u0442\u0430\u043a \u0436\u0435 \u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0435\u043d \u043d\u0430 \u043c\u0430\u0441\u0442\u0435\u0440\u0435 \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,d.jsx)("code",{children:o.D.workDir.value}),".\n\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 ",(0,d.jsx)(s.code,{children:"data-dir"})," \u0443\u043a\u0430\u0437\u0430\u043d\u0430 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u043d\u0430 \u0445\u043e\u0441\u0442\u0435, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043c\u043e\u043d\u0442\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0432\u043d\u0443\u0442\u0440\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 ETCD \u0438 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432 \u0411\u0414."]})}),(0,d.jsxs)(s.ol,{start:"7",children:["\n",(0,d.jsxs)(s.li,{children:["\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0438 \u043f\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u043f\u0443\u0441\u043a\u0430 ETCD \u0432 \u0444\u0430\u0439\u043b\u0435 ",(0,d.jsxs)("code",{children:["$",i.M.kubernetesBaseFolderPath.value,"/manifests/etcd.yaml"]}),"\n\u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 ",(0,d.jsx)(s.code,{children:"spec.containers[0].command"}),".\n\u0410 \u0438\u043c\u0435\u043d\u043d\u043e \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0445 \u043f\u043e\u043b\u0435\u0439 \u0438 \u0438\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, \u043f\u043e\u043b\u044f \u043d\u0435 \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0432 \u0434\u0430\u043d\u043d\u044b\u0439 \u043f\u0435\u0440\u0435\u0447\u0435\u043d\u044c \u0443\u0434\u0430\u043b\u044f\u0442\u044c \u043d\u0435 \u043d\u0443\u0436\u043d\u043e!"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:`--advertise-client-urls=${A}\n  --cert-file=${D.$.etcdServer.crtPath}\n  --client-cert-auth=true\n  --data-dir=${o.D.dataDir.value}\n  --key-file=${D.$.etcdServer.keyPath}\n  --listen-client-urls=https://127.0.0.1:${u.h.etcdServer.portNumber},${A}\n  --listen-metrics-urls=http://0.0.0.0:${u.h.etcdMetricServer.portNumber}\n  --listen-peer-urls=https://${g}:${u.h.etcdPeer.portNumber}\n  --name=${_}\n  --peer-cert-file=${D.$.etcdPeer.crtPath}\n  --peer-client-cert-auth=true\n  --peer-key-file=${D.$.etcdPeer.keyPath}\n  --peer-trusted-ca-file=${D.$.etcdCA.crtPath}\n  --trusted-ca-file=${D.$.etcdCA.keyPath}\n`}),(0,d.jsxs)("table",{children:[(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440"}),(0,d.jsx)("th",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"advertise-client-urls"})," "]}),(0,d.jsx)("td",{children:"\u0410\u043d\u043e\u043d\u0441\u0438\u0440\u0443\u0435\u043c\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0443\u0437\u043b\u0443, \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432. \u0421\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442 \u0441 IP \u0430\u0434\u0440\u0435\u0441\u043e\u043c \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"cert-file"}),"             "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"client-cert-auth"}),"      "]}),(0,d.jsx)("td",{children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c/\u0432\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043f\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0443"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"data-dir"}),"              "]}),(0,d.jsx)("td",{children:"\u0414\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0444\u0430\u0439\u043b\u044b \u0411\u0414 ETCD"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"key-file"}),"              "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-client-urls"}),"    "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-metrics-urls"}),"   "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a \u043c\u0435\u0442\u0440\u0438\u043a\u0430\u043c (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-peer-urls"}),"      "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043e\u0442 \u0434\u0440\u0443\u0433\u0438\u0445 \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"name"}),"                  "]}),(0,d.jsx)("td",{children:"\u0418\u043c\u044f \u0443\u0437\u043b\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-cert-file"}),"        "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-client-cert-auth"})," "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-key-file"}),"         "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-trusted-ca-file"}),"  "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"trusted-ca-file"}),"       "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]})]}),(0,d.jsx)(s.admonition,{type:"note",children:(0,d.jsxs)(s.p,{children:["\u0415\u0441\u043b\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 ",(0,d.jsx)(s.code,{children:"initial-cluster-state"}),' \u0440\u0430\u0432\u0435\u043d \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044e "existing" \u0438\u043b\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0444\u0430\u0439\u043b\u044b \u0411\u0414 \u0438 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u043d\u0435\u0439,\n\u0442\u043e\u0433\u0434\u0430 \u0432\u0441\u0435 \u043f\u0440\u043e\u0447\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b, \u0438\u043c\u044f \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442\u0441\u044f \u0441\u043e \u0441\u043b\u043e\u0432\u0430 ',(0,d.jsx)(s.code,{children:"initial"})," \u0431\u0443\u0434\u0443\u0442 \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f.\n\u0412 \u043d\u0430\u0448\u0435\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u043c\u044b \u0443\u0436\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u043b\u0438 \u0444\u0430\u0439\u043b\u044b \u0411\u0414 \u0438 \u0432\u043d\u0435\u0441\u043b\u0438 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430 \u044d\u0442\u0430\u043f\u0435 \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0438 \u0411\u0414 \u0438\u0437 \u0441\u043d\u0438\u043c\u043a\u0430."]})}),(0,d.jsxs)(s.ol,{start:"8",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u044b\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043d\u0430 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u0443\u0437\u043b\u0430\u0445 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"\u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 kubelet:"}),"\n"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"systemctl start kubelet"}),(0,d.jsxs)(s.ol,{start:"10",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0438 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043e\u0448\u0438\u0431\u043e\u043a"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        export CONTAINER_ID="$(crictl ps -a  \
          --label io.kubernetes.container.name=etcd \
          --label io.kubernetes.pod.namespace=kube-system \
          | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"

        crictl ps --id $CONTAINER_ID

        crictl logs $CONTAINER_ID
      `})]})]}),(0,d.jsxs)(s.ol,{start:"11",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u044d\u0442\u0430\u043f\u044b \u0441\u0431\u043e\u0440\u0430 ",(0,d.jsx)(s.a,{href:"#%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0-%D0%BE%D0%BA%D1%80%D1%83%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F",children:"\u043f\u0440\u0435\u0440\u0435\u043a\u0432\u0438\u0437\u0438\u0442\u043e\u0432"})," \u0438 ",(0,d.jsx)(s.a,{href:"#%D0%BF%D0%BE%D0%B4%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BA-etcd",children:"\u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f"})," \u043a \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0443 ETCD."]}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u041f\u0440\u0438 \u043f\u043e\u043c\u043e\u0449\u0438 \u043a\u043e\u043c\u0430\u043d\u0434 ",(0,d.jsx)(s.code,{children:"member list"})," \u0438 ",(0,d.jsx)(s.code,{children:"endpoint status"})," \u043e\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0445 \u0432\u044b\u0448\u0435 ",(0,d.jsx)(s.a,{href:"#%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0-%D0%BF%D0%BE%D0%B4%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D1%8F-%D0%B8-%D1%81%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%B8%D1%8F-%D0%BA%D0%BB%D0%B0%D1%81%D1%82%D0%B5%D1%80%D0%B0",children:"\u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"}),"."]}),"\n"]}),"\n"]}),(0,d.jsx)(s.p,{children:"\u041f\u043e\u0441\u043b\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0440\u0430\u0431\u043e\u0442 \u043d\u0430 \u0432\u0441\u0435\u0445 \u0442\u0440\u0435\u0445 \u0443\u0437\u043b\u0430\u0445 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u043a\u043b\u0430\u0441\u0442\u0435\u0440 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u0438 \u0433\u043e\u0442\u043e\u0432 \u043a \u0440\u0430\u0431\u043e\u0442\u0435."})]})}function R(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,d.jsx)(s,{...e,children:(0,d.jsx)(O,{...e})}):O(e)}function M(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},10119:(e,s,t)=>{t.d(s,{D:()=>n});var r=t(6353),d=t(31798);const n={name:{value:"${FULL_HOST_NAME}"},initialCluster:{value:"${ETCD_INITIAL_CLUSTER}"},initialAdvertisePeerUrls:{value:`https://\${MACHINE_LOCAL_ADDRESS}:${d.h.etcdPeer.portNumber}`},initialClusterToken:{value:"etcd"},initialClusterState:{value:"new"},peerCertFile:{value:`${r.$.etcdPeer.crtPath}`},peerKeyFile:{value:`${r.$.etcdPeer.keyPath}`},peerTrustedCAFile:{value:`${r.$.etcdCA.crtPath}`},peerClientCertAuth:{value:"true"},certFile:{value:`${r.$.etcdServer.crtPath}`},keyFile:{value:`${r.$.etcdServer.keyPath}`},trustedCAFile:{value:`${r.$.etcdCA.crtPath}`},listenClientUrls:{value:`https://0.0.0.0:${d.h.etcdServer.portNumber}`},listenPeerUrls:{value:`https://0.0.0.0:${d.h.etcdPeer.portNumber}`},listenMetricsUrls:{value:`http://0.0.0.0:${d.h.etcdMetricServer.portNumber}`},dataDir:{value:"/var/lib/etcd"},quotaBackendBytes:{value:"10737418240"},clientCertAuth:{value:"true"},heartbeatInterval:{value:"250"},electionTimeout:{value:"1500"},maxSnapshots:{value:"10"},maxWals:{value:"10"},autoCompactionRetention:{value:"8"},metrics:{value:"extensive"},logger:{value:"zap"},advertiseClientUrls:{value:`https://\${MACHINE_LOCAL_ADDRESS}:${d.h.etcdServer.portNumber}`},workDir:{value:"/tmp/etcd"},dbPath:{value:"/var/lib/etcd/member/snap/db"},snapshotCount:{value:"10000"},experimentalInitialCorruptCheck:{value:"true"},experimentalWatchProgressNotifyInterval:{value:"5s"}}},16049:(e,s,t)=>{t.r(s),t.d(s,{ETCD_api_address:()=>S,ETCD_endpoint_1:()=>A,ETCD_endpoint_2:()=>N,ETCD_endpoint_3:()=>k,ETCD_endpoints:()=>$,ETCD_etcd_pod_1:()=>b,ETCD_etcd_pod_2:()=>m,ETCD_etcd_pod_3:()=>C,ETCD_k8s_cluster_name:()=>f,ETCD_k8s_node_1:()=>_,ETCD_k8s_node_2:()=>B,ETCD_k8s_node_3:()=>v,ETCD_k8s_node_address_1:()=>g,ETCD_k8s_node_address_2:()=>P,ETCD_k8s_node_address_3:()=>T,assets:()=>E,contentTitle:()=>p,default:()=>R,frontMatter:()=>j,metadata:()=>r,toc:()=>y});const r=JSON.parse('{"id":"tech-docs/etcd/troubleshooting/restore/ThreeNodeKubeApi","title":"ThreeNodeKubeApi","description":"\u0412 \u0434\u0430\u043d\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u0435\u0441\u043b\u0438 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0443\u0437\u043b\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u0432 \u0435\u0433\u043e \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0431\u0443\u0434\u0443\u0442 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c","source":"@site/docs/tech-docs/etcd/troubleshooting/restore/threeNodeKubeApi.mdx","sourceDirName":"tech-docs/etcd/troubleshooting/restore","slug":"/tech-docs/etcd/troubleshooting/restore/ThreeNodeKubeApi","permalink":"/tech-docs/etcd/troubleshooting/restore/ThreeNodeKubeApi","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"ThreeNodeKubeApi"}}');var d=t(74848),n=t(28453),l=t(1775),c=t(60513),i=t(7478),a=t(87464),h=t(62774),o=t(10119),D=(t(80206),t(6353)),u=t(31798),x=t(57462);const j={id:"ThreeNodeKubeApi"},p=void 0,E={},$="https://10.10.10.3:2379,https://10.10.10.4:2379,https://10.10.10.5:2379",A="https://10.10.10.3:2379",N="https://10.10.10.4:2379",k="https://10.10.10.5:2379",b="etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-7plhz",m="etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-h9g49",C="etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-wps6k",_="in-cloud-k8s-sandbox-dev-csko-1-tcgzn-7plhz",B="in-cloud-k8s-sandbox-dev-csko-1-tcgzn-h9g49",v="in-cloud-k8s-sandbox-dev-csko-1-tcgzn-wps6k",g="10.10.10.3",P="10.10.10.4",T="10.10.10.5",S="10.10.10.2",f="in-cloud-k8s-sandbox-test-csko-1",y=[];function O(e){const s={a:"a",admonition:"admonition",code:"code",li:"li",ol:"ol",p:"p",...(0,n.R)(),...e.components};return x.xz||M("ThreeNodeFunctionsKubeApi",!1),x.xz.Master||M("ThreeNodeFunctionsKubeApi.Master",!0),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(x.xz.Master,{}),"\n",(0,d.jsx)(s.admonition,{type:"warning",children:(0,d.jsx)(s.p,{children:"\u0412 \u0434\u0430\u043d\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u0435\u0441\u043b\u0438 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0443\u0437\u043b\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u0432 \u0435\u0433\u043e \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0431\u0443\u0434\u0443\u0442 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c\n\u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0438 \u0438\u043c\u0435\u043d\u0430 \u0434\u0440\u0443\u0433\u0438\u0445 \u0443\u0437\u043b\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435 \u0441\u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u043c \u0443\u0437\u043b\u043e\u043c,\n\u0442\u043e\u0433\u0434\u0430 \u043f\u043e\u0434 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043c\u043e\u0436\u0435\u0442 \u043f\u0430\u0434\u0430\u0442\u044c \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439, \u0434\u043e \u0442\u0435\u0445 \u043f\u043e\u0440, \u043f\u043e\u043a\u0430 \u043d\u0430 \u0434\u0440\u0443\u0433\u0438\u0445 \u0443\u0437\u043b\u0430\u0445 \u043d\u0435 \u043f\u043e\u044f\u0432\u0438\u0442\u0441\u044f \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u0430\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f."})}),"\n",(0,d.jsx)(s.p,{children:"\u0428\u0430\u0433\u0438 \u0441 1 \u043f\u043e 8 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u0442\u0441\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e \u043d\u0430 \u0432\u0441\u0435\u0445 \u0442\u0440\u0435\u0445 \u0443\u0437\u043b\u0430\u0445 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."}),"\n",(0,d.jsxs)(h.A,{groupId:"etcd-node",children:[(0,d.jsxs)(a.A,{value:"Master-1",children:[(0,d.jsxs)(s.ol,{children:["\n",(0,d.jsxs)(s.li,{children:["\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0444\u0430\u0439\u043b \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043d\u0438\u043c\u043a\u0430 \u043d\u0430 \u0412\u041c \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e \u043f\u0443\u0442\u0438 ",(0,d.jsxs)("code",{children:[o.D.workDir.value,"/backup.db"]})," \u043f\u0440\u0438 \u043f\u043e\u043c\u043e\u0449\u0438 rsync"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
      ssh capv@$\{K8S_NODE_ADDRESS_1} "mkdir -p ${o.D.workDir.value}"
      rsync --rsync-path="sudo rsync" \
        LOCAL_PATH_TO_BACKUP/backup.db \
        capv@$\{K8S_NODE_ADDRESS_1}:${o.D.workDir.value}/backup.db
    `}),(0,d.jsxs)(s.ol,{start:"2",children:["\n",(0,d.jsxs)(s.li,{children:["\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a \u0412\u041c \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e ssh \u0438 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043d\u0430 \u0441\u0443\u043f\u0435\u0440\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.\n\u0417\u0430\u0442\u0435\u043c \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 ",(0,d.jsx)(s.code,{children:"kubelet"}),", \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u0438\u0442\u044c \u0435\u043c\u0443 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c ETCD."]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"systemctl stop kubelet"}),(0,d.jsxs)(s.ol,{start:"3",children:["\n",(0,d.jsxs)(s.li,{children:["\u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 \u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 ",(0,d.jsx)(s.code,{children:"etcd"}),":"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
      export CONTAINER_ID="$(crictl ps -a  \
        --label io.kubernetes.container.name=etcd \
        --label io.kubernetes.pod.namespace=kube-system \
        | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"
      crictl stop \${CONTAINER_ID}
      crictl rm \${CONTAINER_ID}
    `}),(0,d.jsxs)(s.ol,{start:"4",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 ",(0,d.jsx)(s.a,{href:"#%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-%D1%80%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%BD%D0%BE%D0%B9-%D0%BA%D0%BE%D0%BF%D0%B8%D0%B8-%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2-%D0%B1%D0%B4",children:"\u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e"}),"."]}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0441\u0442\u0430\u0440\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0438\u0437 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,d.jsx)("code",{children:o.D.dataDir.value})]}),"\n"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:`rm -rf ${o.D.dataDir.value}/*`}),(0,d.jsxs)(s.ol,{start:"6",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u044c\u0442\u0435 \u0411\u0414 \u0438\u0437 \u0441\u043d\u0438\u043c\u043a\u0430:"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
      etcdctl snapshot restore ${o.D.workDir.value}/backup.db \
        --name=\${K8S_NODE_1} \
        --data-dir ${o.D.dataDir.value} \
        --initial-advertise-peer-urls=https://\${K8S_NODE_ADDRESS_1}:2380 \
        --initial-cluster=\${K8S_NODE_1}=https://\${K8S_NODE_ADDRESS_1}:${u.h.etcdPeer.portNumber},\${K8S_NODE_2}=https://\${K8S_NODE_ADDRESS_2}:${u.h.etcdPeer.portNumber},\${K8S_NODE_3}=https://\${K8S_NODE_ADDRESS_3}:${u.h.etcdPeer.portNumber}
    `}),(0,d.jsx)(s.admonition,{type:"note",children:(0,d.jsxs)(s.p,{children:["\u041e\u0431\u0440\u0430\u0442\u0438\u0442\u0435 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435, \u0447\u0442\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0444\u0430\u0439\u043b ",(0,d.jsx)(s.code,{children:"etcdctl"})," \u0438 \u0441\u043d\u0438\u043c\u043e\u043a \u0442\u0430\u043a \u0436\u0435 \u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0435\u043d \u043d\u0430 \u043c\u0430\u0441\u0442\u0435\u0440\u0435 \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,d.jsx)("code",{children:o.D.workDir.value}),".\n\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 ",(0,d.jsx)(s.code,{children:"data-dir"})," \u0443\u043a\u0430\u0437\u0430\u043d\u0430 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u043d\u0430 \u0445\u043e\u0441\u0442\u0435, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043c\u043e\u043d\u0442\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0432\u043d\u0443\u0442\u0440\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 ETCD \u0438 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432 \u0411\u0414."]})}),(0,d.jsxs)(s.ol,{start:"7",children:["\n",(0,d.jsxs)(s.li,{children:["\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0438 \u043f\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u043f\u0443\u0441\u043a\u0430 ETCD \u0432 \u0444\u0430\u0439\u043b\u0435 ",(0,d.jsxs)("code",{children:["$",i.M.kubernetesBaseFolderPath.value,"/manifests/etcd.yaml"]}),"\n\u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 ",(0,d.jsx)(s.code,{children:"spec.containers[0].command"}),".\n\u0410 \u0438\u043c\u0435\u043d\u043d\u043e \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0445 \u043f\u043e\u043b\u0435\u0439 \u0438 \u0438\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, \u043f\u043e\u043b\u044f \u043d\u0435 \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0432 \u0434\u0430\u043d\u043d\u044b\u0439 \u043f\u0435\u0440\u0435\u0447\u0435\u043d\u044c \u0443\u0434\u0430\u043b\u044f\u0442\u044c \u043d\u0435 \u043d\u0443\u0436\u043d\u043e!"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
      --advertise-client-urls=${A}
      --cert-file=${D.$.etcdServer.crtPath}
      --client-cert-auth=true
      --data-dir=${o.D.dataDir.value}
      --key-file=${D.$.etcdServer.keyPath}
      --listen-client-urls=https://127.0.0.1:${u.h.etcdServer.portNumber},${A}
      --listen-metrics-urls=http://0.0.0.0:${u.h.etcdMetricServer.portNumber}
      --listen-peer-urls=https://${g}:${u.h.etcdPeer.portNumber}
      --name=${_}
      --peer-cert-file=${D.$.etcdPeer.crtPath}
      --peer-client-cert-auth=true
      --peer-key-file=${D.$.etcdPeer.keyPath}
      --peer-trusted-ca-file=${D.$.etcdCA.crtPath}
      --trusted-ca-file=${D.$.etcdCA.keyPath}
    `}),(0,d.jsxs)("table",{children:[(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440"}),(0,d.jsx)("th",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"advertise-client-urls"})," "]}),(0,d.jsx)("td",{children:"\u0410\u043d\u043e\u043d\u0441\u0438\u0440\u0443\u0435\u043c\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0443\u0437\u043b\u0443, \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432. \u0421\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442 \u0441 IP \u0430\u0434\u0440\u0435\u0441\u043e\u043c \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"cert-file"}),"             "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"client-cert-auth"}),"      "]}),(0,d.jsx)("td",{children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c/\u0432\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043f\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0443"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"data-dir"}),"              "]}),(0,d.jsx)("td",{children:"\u0414\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0444\u0430\u0439\u043b\u044b \u0411\u0414 ETCD"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"key-file"}),"              "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-client-urls"}),"    "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-metrics-urls"}),"   "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a \u043c\u0435\u0442\u0440\u0438\u043a\u0430\u043c (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-peer-urls"}),"      "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043e\u0442 \u0434\u0440\u0443\u0433\u0438\u0445 \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"name"}),"                  "]}),(0,d.jsx)("td",{children:"\u0418\u043c\u044f \u0443\u0437\u043b\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-cert-file"}),"        "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-client-cert-auth"})," "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-key-file"}),"         "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-trusted-ca-file"}),"  "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"trusted-ca-file"}),"       "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]})]}),(0,d.jsx)(s.admonition,{type:"note",children:(0,d.jsxs)(s.p,{children:["\u0415\u0441\u043b\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 ",(0,d.jsx)(s.code,{children:"initial-cluster-state"}),' \u0440\u0430\u0432\u0435\u043d \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044e "existing" \u0438\u043b\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0444\u0430\u0439\u043b\u044b \u0411\u0414 \u0438 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u043d\u0435\u0439,\n\u0442\u043e\u0433\u0434\u0430 \u0432\u0441\u0435 \u043f\u0440\u043e\u0447\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b, \u0438\u043c\u044f \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442\u0441\u044f \u0441\u043e \u0441\u043b\u043e\u0432\u0430 ',(0,d.jsx)(s.code,{children:"initial"})," \u0431\u0443\u0434\u0443\u0442 \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f.\n\u0412 \u043d\u0430\u0448\u0435\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u043c\u044b \u0443\u0436\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u043b\u0438 \u0444\u0430\u0439\u043b\u044b \u0411\u0414 \u0438 \u0432\u043d\u0435\u0441\u043b\u0438 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430 \u044d\u0442\u0430\u043f\u0435 \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0438 \u0411\u0414 \u0438\u0437 \u0441\u043d\u0438\u043c\u043a\u0430."]})}),(0,d.jsxs)(s.ol,{start:"8",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u044b\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043d\u0430 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u0443\u0437\u043b\u0430\u0445 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"\u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 kubelet:"}),"\n"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"systemctl start kubelet"}),(0,d.jsxs)(s.ol,{start:"10",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0438 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043e\u0448\u0438\u0431\u043e\u043a"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
      export CONTAINER_ID="$(crictl ps -a  \
        --label io.kubernetes.container.name=etcd \
        --label io.kubernetes.pod.namespace=kube-system \
        | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"

      crictl ps --id $CONTAINER_ID

      crictl logs $CONTAINER_ID
    `})]}),(0,d.jsxs)(a.A,{value:"Master-2",children:[(0,d.jsxs)(s.ol,{children:["\n",(0,d.jsxs)(s.li,{children:["\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0444\u0430\u0439\u043b \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043d\u0438\u043c\u043a\u0430 \u043d\u0430 \u0412\u041c \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e \u043f\u0443\u0442\u0438 ",(0,d.jsxs)("code",{children:[o.D.workDir.value,"/backup.db"]})," \u043f\u0440\u0438 \u043f\u043e\u043c\u043e\u0449\u0438 rsync"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
      ssh capv@$\{K8S_NODE_ADDRESS_1} "mkdir -p ${o.D.workDir.value}"
      rsync --rsync-path="sudo rsync" \
        LOCAL_PATH_TO_BACKUP/backup.db \
        capv@$\{K8S_NODE_ADDRESS_1}:${o.D.workDir.value}/backup.db
    `}),(0,d.jsxs)(s.ol,{start:"2",children:["\n",(0,d.jsxs)(s.li,{children:["\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a \u0412\u041c \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e ssh \u0438 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043d\u0430 \u0441\u0443\u043f\u0435\u0440\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.\n\u0417\u0430\u0442\u0435\u043c \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 ",(0,d.jsx)(s.code,{children:"kubelet"}),", \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u0438\u0442\u044c \u0435\u043c\u0443 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c ETCD."]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"systemctl stop kubelet"}),(0,d.jsxs)(s.ol,{start:"3",children:["\n",(0,d.jsxs)(s.li,{children:["\u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 \u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 ",(0,d.jsx)(s.code,{children:"etcd"}),":"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
      export CONTAINER_ID="$(crictl ps -a  \
        --label io.kubernetes.container.name=etcd \
        --label io.kubernetes.pod.namespace=kube-system \
        | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"
      crictl stop \${CONTAINER_ID}
      crictl rm \${CONTAINER_ID}
    `}),(0,d.jsxs)(s.ol,{start:"4",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 ",(0,d.jsx)(s.a,{href:"#%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-%D1%80%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%BD%D0%BE%D0%B9-%D0%BA%D0%BE%D0%BF%D0%B8%D0%B8-%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2-%D0%B1%D0%B4",children:"\u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e"}),"."]}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0441\u0442\u0430\u0440\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0438\u0437 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,d.jsx)("code",{children:o.D.dataDir.value})]}),"\n"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:`rm -rf ${o.D.dataDir.value}/*`}),(0,d.jsxs)(s.ol,{start:"6",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u044c\u0442\u0435 \u0411\u0414 \u0438\u0437 \u0441\u043d\u0438\u043c\u043a\u0430:"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
      etcdctl snapshot restore ${o.D.workDir.value}/backup.db \
        --name=\${K8S_NODE_1} \
        --data-dir ${o.D.dataDir.value} \
        --initial-advertise-peer-urls=https://\${K8S_NODE_ADDRESS_1}:2380 \
        --initial-cluster=\${K8S_NODE_1}=https://\${K8S_NODE_ADDRESS_1}:${u.h.etcdPeer.portNumber},\${K8S_NODE_2}=https://\${K8S_NODE_ADDRESS_2}:${u.h.etcdPeer.portNumber},\${K8S_NODE_3}=https://\${K8S_NODE_ADDRESS_3}:${u.h.etcdPeer.portNumber}
    `}),(0,d.jsx)(s.admonition,{type:"note",children:(0,d.jsxs)(s.p,{children:["\u041e\u0431\u0440\u0430\u0442\u0438\u0442\u0435 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435, \u0447\u0442\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0444\u0430\u0439\u043b ",(0,d.jsx)(s.code,{children:"etcdctl"})," \u0438 \u0441\u043d\u0438\u043c\u043e\u043a \u0442\u0430\u043a \u0436\u0435 \u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0435\u043d \u043d\u0430 \u043c\u0430\u0441\u0442\u0435\u0440\u0435 \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,d.jsx)("code",{children:o.D.workDir.value}),".\n\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 ",(0,d.jsx)(s.code,{children:"data-dir"})," \u0443\u043a\u0430\u0437\u0430\u043d\u0430 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u043d\u0430 \u0445\u043e\u0441\u0442\u0435, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043c\u043e\u043d\u0442\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0432\u043d\u0443\u0442\u0440\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 ETCD \u0438 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432 \u0411\u0414."]})}),(0,d.jsxs)(s.ol,{start:"7",children:["\n",(0,d.jsxs)(s.li,{children:["\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0438 \u043f\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u043f\u0443\u0441\u043a\u0430 ETCD \u0432 \u0444\u0430\u0439\u043b\u0435 ",(0,d.jsxs)("code",{children:["$",i.M.kubernetesBaseFolderPath.value,"/manifests/etcd.yaml"]}),"\n\u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 ",(0,d.jsx)(s.code,{children:"spec.containers[0].command"}),".\n\u0410 \u0438\u043c\u0435\u043d\u043d\u043e \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0445 \u043f\u043e\u043b\u0435\u0439 \u0438 \u0438\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, \u043f\u043e\u043b\u044f \u043d\u0435 \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0432 \u0434\u0430\u043d\u043d\u044b\u0439 \u043f\u0435\u0440\u0435\u0447\u0435\u043d\u044c \u0443\u0434\u0430\u043b\u044f\u0442\u044c \u043d\u0435 \u043d\u0443\u0436\u043d\u043e!"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
      --advertise-client-urls=${A}
      --cert-file=${D.$.etcdServer.crtPath}
      --client-cert-auth=true
      --data-dir=${o.D.dataDir.value}
      --key-file=${D.$.etcdServer.keyPath}
      --listen-client-urls=https://127.0.0.1:${u.h.etcdServer.portNumber},${A}
      --listen-metrics-urls=http://0.0.0.0:${u.h.etcdMetricServer.portNumber}
      --listen-peer-urls=https://${g}:${u.h.etcdPeer.portNumber}
      --name=${_}
      --peer-cert-file=${D.$.etcdPeer.crtPath}
      --peer-client-cert-auth=true
      --peer-key-file=${D.$.etcdPeer.keyPath}
      --peer-trusted-ca-file=${D.$.etcdCA.crtPath}
      --trusted-ca-file=${D.$.etcdCA.keyPath}
    `}),(0,d.jsxs)("table",{children:[(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440"}),(0,d.jsx)("th",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"advertise-client-urls"})," "]}),(0,d.jsx)("td",{children:"\u0410\u043d\u043e\u043d\u0441\u0438\u0440\u0443\u0435\u043c\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0443\u0437\u043b\u0443, \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432. \u0421\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442 \u0441 IP \u0430\u0434\u0440\u0435\u0441\u043e\u043c \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"cert-file"}),"             "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"client-cert-auth"}),"      "]}),(0,d.jsx)("td",{children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c/\u0432\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043f\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0443"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"data-dir"}),"              "]}),(0,d.jsx)("td",{children:"\u0414\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0444\u0430\u0439\u043b\u044b \u0411\u0414 ETCD"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"key-file"}),"              "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-client-urls"}),"    "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-metrics-urls"}),"   "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a \u043c\u0435\u0442\u0440\u0438\u043a\u0430\u043c (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-peer-urls"}),"      "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043e\u0442 \u0434\u0440\u0443\u0433\u0438\u0445 \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"name"}),"                  "]}),(0,d.jsx)("td",{children:"\u0418\u043c\u044f \u0443\u0437\u043b\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-cert-file"}),"        "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-client-cert-auth"})," "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-key-file"}),"         "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-trusted-ca-file"}),"  "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"trusted-ca-file"}),"       "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]})]}),(0,d.jsx)(s.admonition,{type:"note",children:(0,d.jsxs)(s.p,{children:["\u0415\u0441\u043b\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 ",(0,d.jsx)(s.code,{children:"initial-cluster-state"}),' \u0440\u0430\u0432\u0435\u043d \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044e "existing" \u0438\u043b\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0444\u0430\u0439\u043b\u044b \u0411\u0414 \u0438 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u043d\u0435\u0439,\n\u0442\u043e\u0433\u0434\u0430 \u0432\u0441\u0435 \u043f\u0440\u043e\u0447\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b, \u0438\u043c\u044f \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442\u0441\u044f \u0441\u043e \u0441\u043b\u043e\u0432\u0430 ',(0,d.jsx)(s.code,{children:"initial"})," \u0431\u0443\u0434\u0443\u0442 \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f.\n\u0412 \u043d\u0430\u0448\u0435\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u043c\u044b \u0443\u0436\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u043b\u0438 \u0444\u0430\u0439\u043b\u044b \u0411\u0414 \u0438 \u0432\u043d\u0435\u0441\u043b\u0438 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430 \u044d\u0442\u0430\u043f\u0435 \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0438 \u0411\u0414 \u0438\u0437 \u0441\u043d\u0438\u043c\u043a\u0430."]})}),(0,d.jsxs)(s.ol,{start:"8",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u044b\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043d\u0430 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u0443\u0437\u043b\u0430\u0445 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"\u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 kubelet:"}),"\n"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"systemctl start kubelet"}),(0,d.jsxs)(s.ol,{start:"10",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0438 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043e\u0448\u0438\u0431\u043e\u043a"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
      export CONTAINER_ID="$(crictl ps -a  \
        --label io.kubernetes.container.name=etcd \
        --label io.kubernetes.pod.namespace=kube-system \
        | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"

      crictl ps --id $CONTAINER_ID

      crictl logs $CONTAINER_ID
    `})]}),(0,d.jsxs)(a.A,{value:"Master-3",children:[(0,d.jsxs)(s.ol,{children:["\n",(0,d.jsxs)(s.li,{children:["\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0444\u0430\u0439\u043b \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043d\u0438\u043c\u043a\u0430 \u043d\u0430 \u0412\u041c \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e \u043f\u0443\u0442\u0438 ",(0,d.jsxs)("code",{children:[o.D.workDir.value,"/backup.db"]})," \u043f\u0440\u0438 \u043f\u043e\u043c\u043e\u0449\u0438 rsync"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
      ssh capv@$\{K8S_NODE_ADDRESS_1} "mkdir -p ${o.D.workDir.value}"
      rsync --rsync-path="sudo rsync" \
        LOCAL_PATH_TO_BACKUP/backup.db \
        capv@$\{K8S_NODE_ADDRESS_1}:${o.D.workDir.value}/backup.db
    `}),(0,d.jsxs)(s.ol,{start:"2",children:["\n",(0,d.jsxs)(s.li,{children:["\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a \u0412\u041c \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e ssh \u0438 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043d\u0430 \u0441\u0443\u043f\u0435\u0440\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.\n\u0417\u0430\u0442\u0435\u043c \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 ",(0,d.jsx)(s.code,{children:"kubelet"}),", \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u0438\u0442\u044c \u0435\u043c\u0443 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c ETCD."]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"systemctl stop kubelet"}),(0,d.jsxs)(s.ol,{start:"3",children:["\n",(0,d.jsxs)(s.li,{children:["\u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 \u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 ",(0,d.jsx)(s.code,{children:"etcd"}),":"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
      export CONTAINER_ID="$(crictl ps -a  \
        --label io.kubernetes.container.name=etcd \
        --label io.kubernetes.pod.namespace=kube-system \
        | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"
      crictl stop \${CONTAINER_ID}
      crictl rm \${CONTAINER_ID}
    `}),(0,d.jsxs)(s.ol,{start:"4",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 ",(0,d.jsx)(s.a,{href:"#%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-%D1%80%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%BD%D0%BE%D0%B9-%D0%BA%D0%BE%D0%BF%D0%B8%D0%B8-%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2-%D0%B1%D0%B4",children:"\u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e"}),"."]}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0441\u0442\u0430\u0440\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0438\u0437 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,d.jsx)("code",{children:o.D.dataDir.value})]}),"\n"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:`rm -rf ${o.D.dataDir.value}/*`}),(0,d.jsxs)(s.ol,{start:"6",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u044c\u0442\u0435 \u0411\u0414 \u0438\u0437 \u0441\u043d\u0438\u043c\u043a\u0430:"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
      etcdctl snapshot restore ${o.D.workDir.value}/backup.db \
        --name=\${K8S_NODE_1} \
        --data-dir ${o.D.dataDir.value} \
        --initial-advertise-peer-urls=https://\${K8S_NODE_ADDRESS_1}:2380 \
        --initial-cluster=\${K8S_NODE_1}=https://\${K8S_NODE_ADDRESS_1}:${u.h.etcdPeer.portNumber},\${K8S_NODE_2}=https://\${K8S_NODE_ADDRESS_2}:${u.h.etcdPeer.portNumber},\${K8S_NODE_3}=https://\${K8S_NODE_ADDRESS_3}:${u.h.etcdPeer.portNumber}
    `}),(0,d.jsx)(s.admonition,{type:"note",children:(0,d.jsxs)(s.p,{children:["\u041e\u0431\u0440\u0430\u0442\u0438\u0442\u0435 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435, \u0447\u0442\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0444\u0430\u0439\u043b ",(0,d.jsx)(s.code,{children:"etcdctl"})," \u0438 \u0441\u043d\u0438\u043c\u043e\u043a \u0442\u0430\u043a \u0436\u0435 \u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0435\u043d \u043d\u0430 \u043c\u0430\u0441\u0442\u0435\u0440\u0435 \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,d.jsx)("code",{children:o.D.workDir.value}),".\n\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 ",(0,d.jsx)(s.code,{children:"data-dir"})," \u0443\u043a\u0430\u0437\u0430\u043d\u0430 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u043d\u0430 \u0445\u043e\u0441\u0442\u0435, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043c\u043e\u043d\u0442\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0432\u043d\u0443\u0442\u0440\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 ETCD \u0438 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432 \u0411\u0414."]})}),(0,d.jsxs)(s.ol,{start:"7",children:["\n",(0,d.jsxs)(s.li,{children:["\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0438 \u043f\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u043f\u0443\u0441\u043a\u0430 ETCD \u0432 \u0444\u0430\u0439\u043b\u0435 ",(0,d.jsxs)("code",{children:["$",i.M.kubernetesBaseFolderPath.value,"/manifests/etcd.yaml"]}),"\n\u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 ",(0,d.jsx)(s.code,{children:"spec.containers[0].command"}),".\n\u0410 \u0438\u043c\u0435\u043d\u043d\u043e \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0445 \u043f\u043e\u043b\u0435\u0439 \u0438 \u0438\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, \u043f\u043e\u043b\u044f \u043d\u0435 \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0432 \u0434\u0430\u043d\u043d\u044b\u0439 \u043f\u0435\u0440\u0435\u0447\u0435\u043d\u044c \u0443\u0434\u0430\u043b\u044f\u0442\u044c \u043d\u0435 \u043d\u0443\u0436\u043d\u043e!"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
    --advertise-client-urls=${A}
    --cert-file=${D.$.etcdServer.crtPath}
    --client-cert-auth=true
    --data-dir=${o.D.dataDir.value}
    --key-file=${D.$.etcdServer.keyPath}
    --listen-client-urls=https://127.0.0.1:${u.h.etcdServer.portNumber},${A}
    --listen-metrics-urls=http://0.0.0.0:${u.h.etcdMetricServer.portNumber}
    --listen-peer-urls=https://${g}:${u.h.etcdPeer.portNumber}
    --name=${_}
    --peer-cert-file=${D.$.etcdPeer.crtPath}
    --peer-client-cert-auth=true
    --peer-key-file=${D.$.etcdPeer.keyPath}
    --peer-trusted-ca-file=${D.$.etcdCA.crtPath}
    --trusted-ca-file=${D.$.etcdCA.keyPath}
  `}),(0,d.jsxs)("table",{children:[(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440"}),(0,d.jsx)("th",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"advertise-client-urls"})," "]}),(0,d.jsx)("td",{children:"\u0410\u043d\u043e\u043d\u0441\u0438\u0440\u0443\u0435\u043c\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0443\u0437\u043b\u0443, \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432. \u0421\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442 \u0441 IP \u0430\u0434\u0440\u0435\u0441\u043e\u043c \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"cert-file"}),"             "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"client-cert-auth"}),"      "]}),(0,d.jsx)("td",{children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c/\u0432\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043f\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0443"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"data-dir"}),"              "]}),(0,d.jsx)("td",{children:"\u0414\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0444\u0430\u0439\u043b\u044b \u0411\u0414 ETCD"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"key-file"}),"              "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-client-urls"}),"    "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-metrics-urls"}),"   "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a \u043c\u0435\u0442\u0440\u0438\u043a\u0430\u043c (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-peer-urls"}),"      "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043e\u0442 \u0434\u0440\u0443\u0433\u0438\u0445 \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"name"}),"                  "]}),(0,d.jsx)("td",{children:"\u0418\u043c\u044f \u0443\u0437\u043b\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-cert-file"}),"        "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-client-cert-auth"})," "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-key-file"}),"         "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-trusted-ca-file"}),"  "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"trusted-ca-file"}),"       "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]})]}),(0,d.jsx)(s.admonition,{type:"note",children:(0,d.jsxs)(s.p,{children:["\u0415\u0441\u043b\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 ",(0,d.jsx)(s.code,{children:"initial-cluster-state"}),' \u0440\u0430\u0432\u0435\u043d \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044e "existing" \u0438\u043b\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0444\u0430\u0439\u043b\u044b \u0411\u0414 \u0438 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u043d\u0435\u0439,\n\u0442\u043e\u0433\u0434\u0430 \u0432\u0441\u0435 \u043f\u0440\u043e\u0447\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b, \u0438\u043c\u044f \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442\u0441\u044f \u0441\u043e \u0441\u043b\u043e\u0432\u0430 ',(0,d.jsx)(s.code,{children:"initial"})," \u0431\u0443\u0434\u0443\u0442 \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f.\n\u0412 \u043d\u0430\u0448\u0435\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u043c\u044b \u0443\u0436\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u043b\u0438 \u0444\u0430\u0439\u043b\u044b \u0411\u0414 \u0438 \u0432\u043d\u0435\u0441\u043b\u0438 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430 \u044d\u0442\u0430\u043f\u0435 \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0438 \u0411\u0414 \u0438\u0437 \u0441\u043d\u0438\u043c\u043a\u0430."]})}),(0,d.jsxs)(s.ol,{start:"8",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u044b\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043d\u0430 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u0443\u0437\u043b\u0430\u0445 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"\u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 kubelet:"}),"\n"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"systemctl start kubelet"}),(0,d.jsxs)(s.ol,{start:"10",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0438 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043e\u0448\u0438\u0431\u043e\u043a"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
      export CONTAINER_ID="$(crictl ps -a  \
        --label io.kubernetes.container.name=etcd \
        --label io.kubernetes.pod.namespace=kube-system \
        | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"

      crictl ps --id $CONTAINER_ID

      crictl logs $CONTAINER_ID
    `})]})]}),"\n",(0,d.jsxs)(s.ol,{start:"11",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u044d\u0442\u0430\u043f\u044b \u0441\u0431\u043e\u0440\u0430 ",(0,d.jsx)(s.a,{href:"#%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0-%D0%BE%D0%BA%D1%80%D1%83%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F",children:"\u043f\u0440\u0435\u0440\u0435\u043a\u0432\u0438\u0437\u0438\u0442\u043e\u0432"})," \u0438 ",(0,d.jsx)(s.a,{href:"#%D0%BF%D0%BE%D0%B4%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BA-etcd",children:"\u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f"})," \u043a \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0443 ETCD."]}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u041f\u0440\u0438 \u043f\u043e\u043c\u043e\u0449\u0438 \u043a\u043e\u043c\u0430\u043d\u0434 ",(0,d.jsx)(s.code,{children:"member list"})," \u0438 ",(0,d.jsx)(s.code,{children:"endpoint status"})," \u043e\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0445 \u0432\u044b\u0448\u0435 ",(0,d.jsx)(s.a,{href:"#%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0-%D0%BF%D0%BE%D0%B4%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D1%8F-%D0%B8-%D1%81%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%B8%D1%8F-%D0%BA%D0%BB%D0%B0%D1%81%D1%82%D0%B5%D1%80%D0%B0",children:"\u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"}),"."]}),"\n"]}),"\n"]}),"\n",(0,d.jsx)(s.p,{children:"\u041f\u043e\u0441\u043b\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0440\u0430\u0431\u043e\u0442 \u043d\u0430 \u0432\u0441\u0435\u0445 \u0442\u0440\u0435\u0445 \u0443\u0437\u043b\u0430\u0445 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u043a\u043b\u0430\u0441\u0442\u0435\u0440 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u0438 \u0433\u043e\u0442\u043e\u0432 \u043a \u0440\u0430\u0431\u043e\u0442\u0435."})]})}function R(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,d.jsx)(s,{...e,children:(0,d.jsx)(O,{...e})}):O(e)}function M(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},31798:(e,s,t)=>{t.d(s,{h:()=>r});const r={etcdServer:{portNumber:"2379"},etcdPeer:{portNumber:"2380"},etcdMetricServer:{portNumber:"2381"},kubeAPIServer:{portNumber:"6443"},kubeControllerManager:{portNumber:"10257"},kubeScheduler:{portNumber:"10259"},kubeletHealthz:{portNumber:"10248"},kubeletServer:{portNumber:"10250"},kubeletReadOnlyPort:{portNumber:"10255"}}},57462:(e,s,t)=>{t.d(s,{ij:()=>V,dS:()=>se,iJ:()=>W,hy:()=>Z,YX:()=>Q,xz:()=>ee});var r={};t.r(r),t.d(r,{Input1:()=>k,Master1ETCDArgs:()=>m,Master2ETCDArgs:()=>C,Master3ETCDArgs:()=>_,Output1:()=>b,Provider:()=>A,useContextHook:()=>N});var d={};t.r(d),t.d(d,{Input1:()=>P,Master1ETCDArgs:()=>S,Master2ETCDArgs:()=>f,Master3ETCDArgs:()=>y,Output1:()=>T,Provider:()=>v,useContextHook:()=>g});var n={};t.r(n),t.d(n,{Input1:()=>I,Master1ETCDArgs:()=>F,Master2ETCDArgs:()=>w,Master3ETCDArgs:()=>z,Output1:()=>K,Provider:()=>R,useContextHook:()=>M});var l={};t.r(l),t.d(l,{Master:()=>Y});var c={};t.r(c),t.d(c,{Master:()=>G});var i={};t.r(i),t.d(i,{Master:()=>q});var a=t(96540),h=t(71635),o=t(97833),D=t(1775),u=t(60513),x=t(6353),j=t(31798),p=t(10119),E=t(74848);const $=(0,a.createContext)(void 0),A=e=>{let{children:s}=e;const[t,r]=(0,a.useState)(""),[d,n]=(0,a.useState)(""),[l,c]=(0,a.useState)(""),[i,h]=(0,a.useState)(""),[o,D]=(0,a.useState)(""),[u,x]=(0,a.useState)(""),[j,p]=(0,a.useState)(""),[A,N]=(0,a.useState)(""),[k,b]=(0,a.useState)(""),[m,C]=(0,a.useState)(""),[_,B]=(0,a.useState)(""),[v,g]=(0,a.useState)(""),[P,T]=(0,a.useState)(""),[S,f]=(0,a.useState)("");return(0,E.jsx)($.Provider,{value:{testNamespace:t,setTestNamespace:r,testPodName:d,setTestPodName:n,nodeName1:l,setNodeName1:c,nodeName2:i,setNodeName2:h,nodeName3:o,setNodeName3:D,nodeAddress1:u,setNodeAddress1:x,nodeAddress2:j,setNodeAddress2:p,nodeAddress3:A,setNodeAddress3:N,k8sNodeAddress1:k,setK8sNodeAddress1:b,k8sNodeAddress2:m,setK8sNodeAddress2:C,k8sNodeAddress3:_,setK8sNodeAddress3:B,clientPort:v,setClientPort:g,peerPort:P,setPeerPort:T,nodeUser:S,setNodeUser:f},children:s})},N=()=>{const e=(0,a.useContext)($);if(!e)throw new Error("useContextHook must be used within Provider");return e},k=()=>{const{testNamespace:e,setTestNamespace:s,testPodName:t,setTestPodName:r,nodeName1:d,setNodeName1:n,nodeName2:l,setNodeName2:c,nodeName3:i,setNodeName3:a,nodeAddress1:D,setNodeAddress1:u,nodeAddress2:x,setNodeAddress2:j,nodeAddress3:p,setNodeAddress3:$,k8sNodeAddress1:A,setK8sNodeAddress1:k,k8sNodeAddress2:b,setK8sNodeAddress2:m,k8sNodeAddress3:C,setK8sNodeAddress3:_,clientPort:B,setClientPort:v,peerPort:g,setPeerPort:P,nodeUser:T,setNodeUser:S}=N();return(0,E.jsxs)(h.A,{vertical:!0,gap:"small",children:[(0,E.jsx)(o.A,{placeholder:"testNamespace",value:e,onChange:e=>s(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"testPodName",value:t,onChange:e=>r(e.target.value)}),"\u0414\u043b\u044f \u043d\u0430\u0447\u0430\u043b\u0430 \u0437\u0430\u0434\u0430\u0439\u0442\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435:",(0,E.jsx)(o.A,{placeholder:"\u0418\u043c\u044f 1\u0439 \u043d\u043e\u0434\u044b ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430",value:d,onChange:e=>n(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"\u0418\u043c\u044f 2\u0439 \u043d\u043e\u0434\u044b ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430",value:l,onChange:e=>c(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"\u0418\u043c\u044f 3\u0439 \u043d\u043e\u0434\u044b ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430",value:i,onChange:e=>a(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"IP \u0430\u0434\u0440\u0435\u0441 1\u0439 \u043d\u043e\u0434\u044b ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430",value:D,onChange:e=>u(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"IP \u0430\u0434\u0440\u0435\u0441 2\u0439 \u043d\u043e\u0434\u044b ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430",value:x,onChange:e=>j(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"IP \u0430\u0434\u0440\u0435\u0441 3\u0439 \u043d\u043e\u0434\u044b ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430",value:p,onChange:e=>$(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"IP \u0430\u0434\u0440\u0435\u0441 1\u0439 \u043d\u043e\u0434\u044b K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440",value:A,onChange:e=>k(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"IP \u0430\u0434\u0440\u0435\u0441 2\u0439 \u043d\u043e\u0434\u044b K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440",value:b,onChange:e=>m(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"IP \u0430\u0434\u0440\u0435\u0441 3\u0439 \u043d\u043e\u0434\u044b K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440",value:C,onChange:e=>_(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"\u041f\u043e\u0440\u0442 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u0430\u043c\u0438 \u043a ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0443",value:B,onChange:e=>v(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"\u041f\u043e\u0440\u0442 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043d\u043e\u0434 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043c\u0435\u0436\u0434\u0443 \u0441\u043e\u0431\u043e\u0439",value:g,onChange:e=>P(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u043d\u043e\u0434\u0430 K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e SSH",value:T,onChange:e=>S(e.target.value)})]})},b=()=>{const{nodeName1:e,nodeName2:s,nodeName3:t,nodeAddress1:r,nodeAddress2:d,nodeAddress3:n,k8sNodeAddress1:l,k8sNodeAddress2:c,k8sNodeAddress3:i,clientPort:a,peerPort:o,nodeUser:x}=N();return(0,E.jsx)(h.A,{vertical:!0,gap:"small",children:(0,E.jsx)(D.A,{language:"bash",children:u.A`
          export ETCD_NODE_NAME_1=${e}
          export ETCD_NODE_NAME_2=${s}
          export ETCD_NODE_NAME_3=${t}
          export ETCD_NODE_ADDRESS=${r}
          export ETCD_NODE_ADDRESS=${d}
          export ETCD_NODE_ADDRESS=${n}
          export K8S_NODE_ADDRESS_1=${l}
          export K8S_NODE_ADDRESS_1=${c}
          export K8S_NODE_ADDRESS_1=${i}
          export ETCD_CLIENT_PORT=${a}
          export ETCD_PEER_PORT=${o}
          export K8S_NODE_USERNAME=${x}
          `})})},m=()=>{const{nodeName1:e,nodeAddress1:s,clientPort:t}=N();return(0,E.jsx)(h.A,{vertical:!0,gap:"small",children:(0,E.jsx)(D.A,{language:"bash",children:u.A`
          --advertise-client-urls=https://${s}:${t}
          --cert-file=${x.$.etcdServer.crtPath}
          --client-cert-auth=true
          --data-dir=${p.D.dataDir.value}
          --key-file=${x.$.etcdServer.keyPath}
          --listen-client-urls=https://127.0.0.1:${j.h.etcdServer.portNumber},https://${s}:${t}
          --listen-metrics-urls=http://0.0.0.0:${j.h.etcdMetricServer.portNumber}
          --listen-peer-urls=https://${s}:${j.h.etcdPeer.portNumber}
          --name=${e}
          --peer-cert-file=${x.$.etcdPeer.crtPath}
          --peer-client-cert-auth=true
          --peer-key-file=${x.$.etcdPeer.keyPath}
          --peer-trusted-ca-file=${x.$.etcdCA.crtPath}
          --trusted-ca-file=${x.$.etcdCA.keyPath}
        `})})},C=()=>{const{nodeName1:e,nodeAddress1:s,nodeName2:t,nodeAddress2:r,clientPort:d}=N();return(0,E.jsx)(h.A,{vertical:!0,gap:"small",children:(0,E.jsx)(D.A,{language:"bash",children:u.A`
          --advertise-client-urls=https://${r}:${d}
          --cert-file=${x.$.etcdServer.crtPath}
          --client-cert-auth=true
          --data-dir=${p.D.dataDir.value}
          --initial-advertise-peer-urls=https://${r}:${j.h.etcdPeer.portNumber}
          --initial-cluster=${e}=https://${s}:${j.h.etcdPeer.portNumber},${t}=https://${r}:${j.h.etcdPeer.portNumber}
          --key-file=${x.$.etcdServer.keyPath}
          --listen-client-urls=https://127.0.0.1:${j.h.etcdServer.portNumber},https://${r}:${d}
          --listen-metrics-urls=http://0.0.0.0:${j.h.etcdMetricServer.portNumber}
          --listen-peer-urls=https://${r}:${j.h.etcdPeer.portNumber}
          --name=${t}
          --peer-cert-file=${x.$.etcdPeer.crtPath}
          --peer-client-cert-auth=true
          --peer-key-file=${x.$.etcdPeer.keyPath}
          --peer-trusted-ca-file=${x.$.etcdCA.crtPath}
          --trusted-ca-file=${x.$.etcdCA.keyPath}
        `})})},_=()=>{const{nodeName1:e,nodeAddress1:s,nodeName2:t,nodeAddress2:r,nodeName3:d,nodeAddress3:n,clientPort:l}=N();return(0,E.jsx)(h.A,{vertical:!0,gap:"small",children:(0,E.jsx)(D.A,{language:"bash",children:u.A`
          --advertise-client-urls=https://${n}:${l}
          --cert-file=${x.$.etcdServer.crtPath}
          --client-cert-auth=true
          --data-dir=${p.D.dataDir.value}
          --initial-advertise-peer-urls=https://${n}:${j.h.etcdPeer.portNumber}
          --initial-cluster=${e}=https://${s}:${j.h.etcdPeer.portNumber},${t}=https://${r}:${j.h.etcdPeer.portNumber},${d}=https://${n}:${j.h.etcdPeer.portNumber}
          --key-file=${x.$.etcdServer.keyPath}
          --listen-client-urls=https://127.0.0.1:${j.h.etcdServer.portNumber},https://${n}:${l}
          --listen-metrics-urls=http://0.0.0.0:${j.h.etcdMetricServer.portNumber}
          --listen-peer-urls=https://${n}:${j.h.etcdPeer.portNumber}
          --name=${d}
          --peer-cert-file=${x.$.etcdPeer.crtPath}
          --peer-client-cert-auth=true
          --peer-key-file=${x.$.etcdPeer.keyPath}
          --peer-trusted-ca-file=${x.$.etcdCA.crtPath}
          --trusted-ca-file=${x.$.etcdCA.keyPath}
        `})})},B=(0,a.createContext)(void 0),v=e=>{let{children:s}=e;const[t,r]=(0,a.useState)(""),[d,n]=(0,a.useState)(""),[l,c]=(0,a.useState)("etcd-main-1"),[i,h]=(0,a.useState)("etcd-main-2"),[o,D]=(0,a.useState)("etcd-main-3"),[u,x]=(0,a.useState)("10.10.10.3"),[j,p]=(0,a.useState)("10.10.10.4"),[$,A]=(0,a.useState)("10.10.10.5"),[N,k]=(0,a.useState)("10.10.10.3"),[b,m]=(0,a.useState)("10.10.10.4"),[C,_]=(0,a.useState)("10.10.10.5"),[v,g]=(0,a.useState)("2379"),[P,T]=(0,a.useState)("2380"),[S,f]=(0,a.useState)("admin");return(0,E.jsx)(B.Provider,{value:{testNamespace:t,setTestNamespace:r,testPodName:d,setTestPodName:n,nodeName1:l,setNodeName1:c,nodeName2:i,setNodeName2:h,nodeName3:o,setNodeName3:D,nodeAddress1:u,setNodeAddress1:x,nodeAddress2:j,setNodeAddress2:p,nodeAddress3:$,setNodeAddress3:A,k8sNodeAddress1:N,setK8sNodeAddress1:k,k8sNodeAddress2:b,setK8sNodeAddress2:m,k8sNodeAddress3:C,setK8sNodeAddress3:_,clientPort:v,setClientPort:g,peerPort:P,setPeerPort:T,nodeUser:S,setNodeUser:f},children:s})},g=()=>{const e=(0,a.useContext)(B);if(!e)throw new Error("useContextHook must be used within Provider");return e},P=()=>{const{testNamespace:e,setTestNamespace:s,testPodName:t,setTestPodName:r,nodeName1:d,setNodeName1:n,nodeName2:l,setNodeName2:c,nodeName3:i,setNodeName3:a,nodeAddress1:D,setNodeAddress1:u,nodeAddress2:x,setNodeAddress2:j,nodeAddress3:p,setNodeAddress3:$,k8sNodeAddress1:A,setK8sNodeAddress1:N,k8sNodeAddress2:k,setK8sNodeAddress2:b,k8sNodeAddress3:m,setK8sNodeAddress3:C,clientPort:_,setClientPort:B,peerPort:v,setPeerPort:P,nodeUser:T,setNodeUser:S}=g();return(0,E.jsxs)(h.A,{vertical:!0,gap:"small",children:[(0,E.jsx)(o.A,{placeholder:"testNamespace",value:e,onChange:e=>s(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"testPodName",value:t,onChange:e=>r(e.target.value)}),"\u0414\u043b\u044f \u043d\u0430\u0447\u0430\u043b\u0430 \u0437\u0430\u0434\u0430\u0439\u0442\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435:",(0,E.jsx)(o.A,{placeholder:"nodeName1",value:d,onChange:e=>n(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"nodeName2",value:l,onChange:e=>c(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"nodeName3",value:i,onChange:e=>a(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"nodeAddress1",value:D,onChange:e=>u(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"nodeAddress2",value:x,onChange:e=>j(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"nodeAddress3",value:p,onChange:e=>$(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeAddress1",value:A,onChange:e=>N(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeAddress2",value:k,onChange:e=>b(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeAddress3",value:m,onChange:e=>C(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"clientPort",value:_,onChange:e=>B(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"peerPort",value:v,onChange:e=>P(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"nodeUser",value:T,onChange:e=>S(e.target.value)})]})},T=()=>{const{nodeName1:e,nodeName2:s,nodeName3:t,nodeAddress1:r,nodeAddress2:d,nodeAddress3:n,k8sNodeAddress1:l,k8sNodeAddress2:c,k8sNodeAddress3:i,clientPort:a,peerPort:o,nodeUser:x}=g();return(0,E.jsx)(h.A,{vertical:!0,gap:"small",children:(0,E.jsx)(D.A,{language:"bash",children:u.A`
          export ETCD_NODE_NAME_1=${e}
          export ETCD_NODE_NAME_2=${s}
          export ETCD_NODE_NAME_3=${t}
          export ETCD_NODE_ADDRESS=${r}
          export ETCD_NODE_ADDRESS=${d}
          export ETCD_NODE_ADDRESS=${n}
          export K8S_NODE_ADDRESS_1=${l}
          export K8S_NODE_ADDRESS_1=${c}
          export K8S_NODE_ADDRESS_1=${i}
          export ETCD_CLIENT_PORT=${a}
          export ETCD_PEER_PORT=${o}
          export K8S_NODE_USERNAME=${x}
          `})})},S=()=>{const{nodeName1:e,nodeAddress1:s,clientPort:t}=g();return(0,E.jsx)(h.A,{vertical:!0,gap:"small",children:(0,E.jsx)(D.A,{language:"bash",children:u.A`
          --advertise-client-urls=https://${s}:${t}
          --cert-file=${x.$.etcdServer.crtPath}
          --client-cert-auth=true
          --data-dir=${p.D.dataDir.value}
          --key-file=${x.$.etcdServer.keyPath}
          --listen-client-urls=https://127.0.0.1:${j.h.etcdServer.portNumber},https://${s}:${t}
          --listen-metrics-urls=http://0.0.0.0:${j.h.etcdMetricServer.portNumber}
          --listen-peer-urls=https://${s}:${j.h.etcdPeer.portNumber}
          --name=${e}
          --peer-cert-file=${x.$.etcdPeer.crtPath}
          --peer-client-cert-auth=true
          --peer-key-file=${x.$.etcdPeer.keyPath}
          --peer-trusted-ca-file=${x.$.etcdCA.crtPath}
          --trusted-ca-file=${x.$.etcdCA.keyPath}
        `})})},f=()=>{const{nodeName1:e,nodeAddress1:s,nodeName2:t,nodeAddress2:r,clientPort:d}=g();return(0,E.jsx)(h.A,{vertical:!0,gap:"small",children:(0,E.jsx)(D.A,{language:"bash",children:u.A`
          --advertise-client-urls=https://${r}:${d}
          --cert-file=${x.$.etcdServer.crtPath}
          --client-cert-auth=true
          --data-dir=${p.D.dataDir.value}
          --initial-advertise-peer-urls=https://${r}:${j.h.etcdPeer.portNumber}
          --initial-cluster=${e}=https://${s}:${j.h.etcdPeer.portNumber},${t}=https://${r}:${j.h.etcdPeer.portNumber}
          --key-file=${x.$.etcdServer.keyPath}
          --listen-client-urls=https://127.0.0.1:${j.h.etcdServer.portNumber},https://${r}:${d}
          --listen-metrics-urls=http://0.0.0.0:${j.h.etcdMetricServer.portNumber}
          --listen-peer-urls=https://${r}:${j.h.etcdPeer.portNumber}
          --name=${t}
          --peer-cert-file=${x.$.etcdPeer.crtPath}
          --peer-client-cert-auth=true
          --peer-key-file=${x.$.etcdPeer.keyPath}
          --peer-trusted-ca-file=${x.$.etcdCA.crtPath}
          --trusted-ca-file=${x.$.etcdCA.keyPath}
        `})})},y=()=>{const{nodeName1:e,nodeAddress1:s,nodeName2:t,nodeAddress2:r,nodeName3:d,nodeAddress3:n,clientPort:l}=g();return(0,E.jsx)(h.A,{vertical:!0,gap:"small",children:(0,E.jsx)(D.A,{language:"bash",children:u.A`
          --advertise-client-urls=https://${n}:${l}
          --cert-file=${x.$.etcdServer.crtPath}
          --client-cert-auth=true
          --data-dir=${p.D.dataDir.value}
          --initial-advertise-peer-urls=https://${n}:${j.h.etcdPeer.portNumber}
          --initial-cluster=${e}=https://${s}:${j.h.etcdPeer.portNumber},${t}=https://${r}:${j.h.etcdPeer.portNumber},${d}=https://${n}:${j.h.etcdPeer.portNumber}
          --key-file=${x.$.etcdServer.keyPath}
          --listen-client-urls=https://127.0.0.1:${j.h.etcdServer.portNumber},https://${n}:${l}
          --listen-metrics-urls=http://0.0.0.0:${j.h.etcdMetricServer.portNumber}
          --listen-peer-urls=https://${n}:${j.h.etcdPeer.portNumber}
          --name=${d}
          --peer-cert-file=${x.$.etcdPeer.crtPath}
          --peer-client-cert-auth=true
          --peer-key-file=${x.$.etcdPeer.keyPath}
          --peer-trusted-ca-file=${x.$.etcdCA.crtPath}
          --trusted-ca-file=${x.$.etcdCA.keyPath}
        `})})},O=(0,a.createContext)(void 0),R=e=>{let{children:s}=e;const[t,r]=(0,a.useState)(""),[d,n]=(0,a.useState)(""),[l,c]=(0,a.useState)("etcd-main-1"),[i,h]=(0,a.useState)("etcd-main-2"),[o,D]=(0,a.useState)("etcd-main-3"),[u,x]=(0,a.useState)("10.10.10.3"),[j,p]=(0,a.useState)("10.10.10.4"),[$,A]=(0,a.useState)("10.10.10.5"),[N,k]=(0,a.useState)("10.10.10.3"),[b,m]=(0,a.useState)("10.10.10.4"),[C,_]=(0,a.useState)("10.10.10.5"),[B,v]=(0,a.useState)("2379"),[g,P]=(0,a.useState)("2380"),[T,S]=(0,a.useState)("admin");return(0,E.jsx)(O.Provider,{value:{testNamespace:t,setTestNamespace:r,testPodName:d,setTestPodName:n,nodeName1:l,setNodeName1:c,nodeName2:i,setNodeName2:h,nodeName3:o,setNodeName3:D,nodeAddress1:u,setNodeAddress1:x,nodeAddress2:j,setNodeAddress2:p,nodeAddress3:$,setNodeAddress3:A,k8sNodeAddress1:N,setK8sNodeAddress1:k,k8sNodeAddress2:b,setK8sNodeAddress2:m,k8sNodeAddress3:C,setK8sNodeAddress3:_,clientPort:B,setClientPort:v,peerPort:g,setPeerPort:P,nodeUser:T,setNodeUser:S},children:s})},M=()=>{const e=(0,a.useContext)(O);if(!e)throw new Error("useContextHook must be used within Provider");return e},I=()=>{const{testNamespace:e,setTestNamespace:s,testPodName:t,setTestPodName:r,nodeName1:d,setNodeName1:n,nodeName2:l,setNodeName2:c,nodeName3:i,setNodeName3:a,nodeAddress1:D,setNodeAddress1:u,nodeAddress2:x,setNodeAddress2:j,nodeAddress3:p,setNodeAddress3:$,k8sNodeAddress1:A,setK8sNodeAddress1:N,k8sNodeAddress2:k,setK8sNodeAddress2:b,k8sNodeAddress3:m,setK8sNodeAddress3:C,clientPort:_,setClientPort:B,peerPort:v,setPeerPort:g,nodeUser:P,setNodeUser:T}=M();return(0,E.jsxs)(h.A,{vertical:!0,gap:"small",children:[(0,E.jsx)(o.A,{placeholder:"testNamespace",value:e,onChange:e=>s(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"testPodName",value:t,onChange:e=>r(e.target.value)}),"\u0414\u043b\u044f \u043d\u0430\u0447\u0430\u043b\u0430 \u0437\u0430\u0434\u0430\u0439\u0442\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435:",(0,E.jsx)(o.A,{placeholder:"nodeName1",value:d,onChange:e=>n(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"nodeName2",value:l,onChange:e=>c(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"nodeName3",value:i,onChange:e=>a(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"nodeAddress1",value:D,onChange:e=>u(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"nodeAddress2",value:x,onChange:e=>j(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"nodeAddress3",value:p,onChange:e=>$(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeAddress1",value:A,onChange:e=>N(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeAddress2",value:k,onChange:e=>b(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeAddress3",value:m,onChange:e=>C(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"clientPort",value:_,onChange:e=>B(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"peerPort",value:v,onChange:e=>g(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"nodeUser",value:P,onChange:e=>T(e.target.value)})]})},K=()=>{const{nodeName1:e,nodeName2:s,nodeName3:t,nodeAddress1:r,nodeAddress2:d,nodeAddress3:n,k8sNodeAddress1:l,k8sNodeAddress2:c,k8sNodeAddress3:i,clientPort:a,peerPort:o,nodeUser:x}=M();return(0,E.jsx)(h.A,{vertical:!0,gap:"small",children:(0,E.jsx)(D.A,{language:"bash",children:u.A`
          export ETCD_NODE_NAME_1=${e}
          export ETCD_NODE_NAME_2=${s}
          export ETCD_NODE_NAME_3=${t}
          export ETCD_NODE_ADDRESS=${r}
          export ETCD_NODE_ADDRESS=${d}
          export ETCD_NODE_ADDRESS=${n}
          export K8S_NODE_ADDRESS_1=${l}
          export K8S_NODE_ADDRESS_1=${c}
          export K8S_NODE_ADDRESS_1=${i}
          export ETCD_CLIENT_PORT=${a}
          export ETCD_PEER_PORT=${o}
          export K8S_NODE_USERNAME=${x}
          `})})},F=()=>{const{nodeName1:e,nodeAddress1:s,clientPort:t}=M();return(0,E.jsx)(h.A,{vertical:!0,gap:"small",children:(0,E.jsx)(D.A,{language:"bash",children:u.A`
          --advertise-client-urls=https://${s}:${t}
          --cert-file=${x.$.etcdServer.crtPath}
          --client-cert-auth=true
          --data-dir=${p.D.dataDir.value}
          --key-file=${x.$.etcdServer.keyPath}
          --listen-client-urls=https://127.0.0.1:${j.h.etcdServer.portNumber},https://${s}:${t}
          --listen-metrics-urls=http://0.0.0.0:${j.h.etcdMetricServer.portNumber}
          --listen-peer-urls=https://${s}:${j.h.etcdPeer.portNumber}
          --name=${e}
          --peer-cert-file=${x.$.etcdPeer.crtPath}
          --peer-client-cert-auth=true
          --peer-key-file=${x.$.etcdPeer.keyPath}
          --peer-trusted-ca-file=${x.$.etcdCA.crtPath}
          --trusted-ca-file=${x.$.etcdCA.keyPath}
        `})})},w=()=>{const{nodeName1:e,nodeAddress1:s,nodeName2:t,nodeAddress2:r,clientPort:d}=M();return(0,E.jsx)(h.A,{vertical:!0,gap:"small",children:(0,E.jsx)(D.A,{language:"bash",children:u.A`
          --advertise-client-urls=https://${r}:${d}
          --cert-file=${x.$.etcdServer.crtPath}
          --client-cert-auth=true
          --data-dir=${p.D.dataDir.value}
          --initial-advertise-peer-urls=https://${r}:${j.h.etcdPeer.portNumber}
          --initial-cluster=${e}=https://${s}:${j.h.etcdPeer.portNumber},${t}=https://${r}:${j.h.etcdPeer.portNumber}
          --key-file=${x.$.etcdServer.keyPath}
          --listen-client-urls=https://127.0.0.1:${j.h.etcdServer.portNumber},https://${r}:${d}
          --listen-metrics-urls=http://0.0.0.0:${j.h.etcdMetricServer.portNumber}
          --listen-peer-urls=https://${r}:${j.h.etcdPeer.portNumber}
          --name=${t}
          --peer-cert-file=${x.$.etcdPeer.crtPath}
          --peer-client-cert-auth=true
          --peer-key-file=${x.$.etcdPeer.keyPath}
          --peer-trusted-ca-file=${x.$.etcdCA.crtPath}
          --trusted-ca-file=${x.$.etcdCA.keyPath}
        `})})},z=()=>{const{nodeName1:e,nodeAddress1:s,nodeName2:t,nodeAddress2:r,nodeName3:d,nodeAddress3:n,clientPort:l}=M();return(0,E.jsx)(h.A,{vertical:!0,gap:"small",children:(0,E.jsx)(D.A,{language:"bash",children:u.A`
          --advertise-client-urls=https://${n}:${l}
          --cert-file=${x.$.etcdServer.crtPath}
          --client-cert-auth=true
          --data-dir=${p.D.dataDir.value}
          --initial-advertise-peer-urls=https://${n}:${j.h.etcdPeer.portNumber}
          --initial-cluster=${e}=https://${s}:${j.h.etcdPeer.portNumber},${t}=https://${r}:${j.h.etcdPeer.portNumber},${d}=https://${n}:${j.h.etcdPeer.portNumber}
          --key-file=${x.$.etcdServer.keyPath}
          --listen-client-urls=https://127.0.0.1:${j.h.etcdServer.portNumber},https://${n}:${l}
          --listen-metrics-urls=http://0.0.0.0:${j.h.etcdMetricServer.portNumber}
          --listen-peer-urls=https://${n}:${j.h.etcdPeer.portNumber}
          --name=${d}
          --peer-cert-file=${x.$.etcdPeer.crtPath}
          --peer-client-cert-auth=true
          --peer-key-file=${x.$.etcdPeer.keyPath}
          --peer-trusted-ca-file=${x.$.etcdCA.crtPath}
          --trusted-ca-file=${x.$.etcdCA.keyPath}
        `})})};var H=t(65160),U=t(7478),L=t(87464),J=t(62774),X=t(80206);const Y=()=>{const[e,s]=(0,a.useState)("etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-7plhz"),[t,r]=(0,a.useState)("etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-h9g49"),[d,n]=(0,a.useState)("etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-wps6k"),[l,c]=(0,a.useState)("in-cloud-k8s-sandbox-dev-csko-1-tcgzn-7plhz"),[i,$]=(0,a.useState)("in-cloud-k8s-sandbox-dev-csko-1-tcgzn-h9g49"),[A,N]=(0,a.useState)("in-cloud-k8s-sandbox-dev-csko-1-tcgzn-wps6k"),[k,b]=(0,a.useState)("10.10.10.3"),[m,C]=(0,a.useState)("10.10.10.4"),[_,B]=(0,a.useState)("10.10.10.5"),[v,g]=(0,a.useState)("2379"),[P,T]=(0,a.useState)("2380"),[S,f]=(0,a.useState)("admin");return(0,E.jsxs)(h.A,{vertical:!0,gap:"small",children:["\u0414\u0430\u043d\u043d\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0440\u0430\u0437\u0432\u043e\u0440\u0430\u0447\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043d\u0430 ControlPlane \u043d\u043e\u0434\u0430\u0445 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u043f\u043e 1\u043c\u0443 \u043d\u0430 \u043a\u0430\u0436\u0434\u0443\u044e. ",(0,E.jsx)("br",{}),"\u0414\u043b\u044f \u043d\u0430\u0447\u0430\u043b\u0430 \u0437\u0430\u0434\u0430\u0439\u0442\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435:",(0,E.jsxs)("li",{children:[(0,E.jsx)("code",{children:"ETCD_NODE_NAME_N"}),"    - \u0418\u043c\u044f \u043f\u043e\u0434\u0430 ETCD (\u041e\u0431\u044b\u0447\u043d\u043e \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 `etcd-\u0418\u041c\u042f_CONTROLPLANE_\u041d\u041e\u0414\u042b`)"]}),(0,E.jsxs)("li",{children:[(0,E.jsx)("code",{children:"K8S_NODE_NAME_N"}),"     - \u0418\u043c\u044f \u043d\u043e\u0434\u044b K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u043f\u043e\u0434\u043d\u0438\u043c\u0430\u0435\u0442\u0441\u044f ETCD."]}),(0,E.jsxs)("li",{children:[(0,E.jsx)("code",{children:"K8S_NODE_ADDRESS_N"}),"  - IP \u0430\u0434\u0440\u0435\u0441 \u043d\u043e\u0434\u044b K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u043f\u043e\u0434\u043d\u0438\u043c\u0430\u0435\u0442\u0441\u044f ETCD."]}),(0,E.jsxs)("li",{children:[(0,E.jsx)("code",{children:"ETCD_CLIENT_PORT"}),"    - \u041f\u043e\u0440\u0442 \u043a \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u044e\u0442\u0441\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u044b ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."]}),(0,E.jsxs)("li",{children:[(0,E.jsx)("code",{children:"ETCD_PEER_PORT"}),"      - \u041f\u043e\u0440\u0442 \u043a \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u044e\u0442\u0441\u044f \u0434\u0440\u0443\u0433\u0438\u0435 \u0443\u0437\u043b\u044b ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."]}),(0,E.jsxs)("li",{children:[(0,E.jsx)("code",{children:"K8S_NODE_USERNAME"}),"   - \u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u043f\u043e \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a \u0443\u0437\u043b\u0430\u043c K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e SSH."]}),(0,E.jsx)(o.A,{placeholder:"etcdNodeName1",value:e,onChange:e=>s(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"etcdNodeName2",value:t,onChange:e=>r(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"etcdNodeName3",value:d,onChange:e=>n(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeName1",value:l,onChange:e=>c(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeName2",value:i,onChange:e=>$(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeName3",value:A,onChange:e=>N(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeAddress1",value:k,onChange:e=>b(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeAddress2",value:m,onChange:e=>C(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeAddress3",value:_,onChange:e=>B(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"clientPort",value:v,onChange:e=>g(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"peerPort",value:P,onChange:e=>T(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"nodeUser",value:S,onChange:e=>f(e.target.value)}),(0,E.jsx)(D.A,{language:"bash",children:u.A`
          export ETCD_NODE_NAME_1=${e}
          export ETCD_NODE_NAME_2=${t}
          export ETCD_NODE_NAME_3=${d}
          export K8S_NODE_NAME_1=${k}
          export K8S_NODE_NAME_2=${m}
          export K8S_NODE_NAME_3=${_}
          export K8S_NODE_ADDRESS_1=${k}
          export K8S_NODE_ADDRESS_2=${m}
          export K8S_NODE_ADDRESS_3=${_}
          export ETCD_CLIENT_PORT=${v}
          export ETCD_PEER_PORT=${P}
          export K8S_NODE_USERNAME=${S}
          `}),(0,E.jsx)(H.A,{message:"WARNING",description:"\u0415\u0441\u043b\u0438 \u0430\u0434\u0440\u0435\u0441 \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0443\u043a\u0430\u0437\u0430\u043d \u0432 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0434\u0440\u0443\u0433\u0438\u0445 \u0432\u0441\u0435 \u0435\u0449\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0445 \u0443\u0437\u043b\u043e\u0432, \u043e\u043d\u0438 \u0443\u043f\u0430\u0434\u0443\u0442 \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439, \u043f\u043e\u043a\u0430 \u043d\u0435 \u0431\u0443\u0434\u0443\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u044b \u043a \u043d\u043e\u0432\u043e\u043c\u0443 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0443.",type:"warning",showIcon:!0}),(0,E.jsx)(H.A,{message:"INFO",description:"\u041f\u0440\u043e\u0446\u0435\u0441\u0441 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043e\u043f\u0438\u0441\u0430\u043d \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c CRICTL \u0438 NSENTER. \u0414\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0432\u0430\u043c \u043f\u043e\u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0443\u0437\u043b\u0430\u043c K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e SSH.",type:"info",showIcon:!0}),(0,E.jsx)(H.A,{message:"INFO",description:"\u0412 \u0440\u0430\u0431\u043e\u0442\u0435 \u0432\u0430\u043c \u043f\u043e\u043d\u0430\u0434\u043e\u0431\u044f\u0442\u0441\u044f alias-\u044b: <code>cidsearch</code>.",type:"info",showIcon:!0}),(0,E.jsxs)(J.A,{groupId:"etcd-node",children:[(0,E.jsxs)(L.A,{value:"Master-1",children:["1. \u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0444\u0430\u0439\u043b \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043d\u0438\u043c\u043a\u0430 \u043d\u0430 \u0412\u041c \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e \u043f\u0443\u0442\u0438 ",(0,E.jsxs)("code",{children:[p.D.workDir.value,"/backup.db"]})," \u043f\u0440\u0438 \u043f\u043e\u043c\u043e\u0449\u0438 rsync",(0,E.jsx)(D.A,{language:"bash",children:u.A`
              ssh \${K8S_NODE_USERNAME}@$\{K8S_NODE_ADDRESS_1} "mkdir -p ${p.D.workDir.value}"
              rsync --rsync-path="sudo rsync" \\
                backup.db \\
                \${K8S_NODE_USERNAME}@$\{K8S_NODE_ADDRESS_1}:${p.D.workDir.value}/backup.db
            `}),"2. \u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a \u0412\u041c \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e ssh \u0438 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043d\u0430 \u0441\u0443\u043f\u0435\u0440\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u0417\u0430\u0442\u0435\u043c \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 `kubelet`, \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u0438\u0442\u044c \u0435\u043c\u0443 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c ETCD.",(0,E.jsx)(D.A,{language:"bash",children:u.A`
              ssh \${K8S_NODE_USERNAME}@$\{K8S_NODE_ADDRESS_1}
              sudo su -
              systemctl stop kubelet
            `}),"3. \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 `etcd` \u043d\u0430 \u043d\u043e\u0434\u0435: \u0412\u044b\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043f\u0438\u0441\u043e\u043a \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0445 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432 etcd.",(0,E.jsx)(D.A,{language:"bash",children:u.A`
              crictl ps \\
              --label io.kubernetes.container.name=etcd \\
              -o json | jq -r \\
                '(["PODNAME","PODNAMESPACE","CONTAINERNAME","CONTAINERID"] | (., map(length*"-"))), (.containers[] | [.labels."io.kubernetes.pod.name", .labels."io.kubernetes.pod.namespace", .metadata.name, .id ])| @tsv' | column -t
            `}),"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0432\u044b\u0432\u043e\u0434 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0437\u0430\u0434\u0430\u0439\u0442\u0435 \u043d\u0435\u0439\u043c\u0441\u043f\u0435\u0439\u0441 \u0438 \u0438\u043c\u044f \u043f\u043e\u0434\u0430 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430:",(0,E.jsx)(X.LX,{}),"4. \u0421\u0431\u043e\u0440 \u0424\u043b\u0430\u0433\u043e\u0432",(0,E.jsx)(D.A,{language:"bash",children:u.A`
              ectlflagsearch() {
                ETCD_ARGS=$(
                    crictl inspect \\
                    -o yaml \\
                    $(cidsearch \\
                      \${SEARCH_POD_NAME} \\
                      \${SEARCH_NAMESPACE} \\
                    )) ; \\
                  echo -n \\
                  '--cert='$(grep --\
                    '--peer-cert-file=' <<< $ETCD_ARGS |
                      head -n1 |
                      sed 's/[^=]*=//') \\
                  '--key='$(grep --\
                    '--peer-key-file=' <<< $ETCD_ARGS |
                      head -n1 |
                      sed 's/[^=]*=//') \\
                  '--cacert='$(grep --\
                    '--trusted-ca-file=' <<< $ETCD_ARGS |
                      head -n1 |
                      sed 's/[^=]*=//') \\
                  '--endpoints='$(grep --\
                    '--advertise-client-urls=' <<< $ETCD_ARGS |
                      head -n1 |
                      sed 's/[^=]*=//' |
                      sed 's/$(POD_NAME)/'\${SEARCH_POD_NAME}'/' |
                      sed 's/$(POD_NAMESPACE)/'\${SEARCH_NAMESPACE}'/')
              }
            `}),"\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0434\u043b\u044f \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430:",(0,E.jsx)(D.A,{language:"bash",children:u.A`
              crictl stop $(cidsearch \${SEARCH_POD_NAME} \${SEARCH_NAMESPACE})
              crictl rm $(cidsearch \${SEARCH_POD_NAME} \${SEARCH_NAMESPACE})
            `}),"4. \u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e \u0424\u0421 (\u041f\u0440\u043e\u0446\u0435\u0441\u0441 \u043e\u043f\u0438\u0441\u0430\u043d \u0432 \u0433\u043b\u0430\u0432\u044b \u0411\u0435\u043a\u0430\u043f\u044b). 5. \u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0441\u0442\u0430\u0440\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0438\u0437 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,E.jsx)("code",{children:p.D.dataDir.value}),(0,E.jsx)(D.A,{language:"bash",children:`rm -rf ${p.D.dataDir.value}/*`}),"6. \u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u044c\u0442\u0435 \u0411\u0414 \u0438\u0437 \u0441\u043d\u0438\u043c\u043a\u0430:",(0,E.jsx)(D.A,{language:"bash",children:u.A`
              etcdctl snapshot restore ${p.D.workDir.value}/backup.db \\
                --name=\${ETCD_NODE_NAME_1} \\
                --data-dir ${p.D.dataDir.value} \\
                --initial-advertise-peer-urls=https://\${K8S_NODE_ADDRESS_1}:\${ETCD_PEER_PORT} \\
                --initial-cluster=\${ETCD_NODE_NAME_1}=https://\${K8S_NODE_ADDRESS_1}:\${ETCD_PEER_PORT}
            `}),":::note \u041e\u0431\u0440\u0430\u0442\u0438\u0442\u0435 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435, \u0447\u0442\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0444\u0430\u0439\u043b `etcdctl` \u0438 \u0441\u043d\u0438\u043c\u043e\u043a \u0442\u0430\u043a \u0436\u0435 \u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0435\u043d \u043d\u0430 \u043c\u0430\u0441\u0442\u0435\u0440\u0435 \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,E.jsx)("code",{children:p.D.workDir.value}),". \u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 `data-dir` \u0443\u043a\u0430\u0437\u0430\u043d\u0430 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043c\u043e\u043d\u0442\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0432\u043d\u0443\u0442\u0440\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 ETCD \u0438 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432 \u0411\u0414. ::: 7. \u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0438 \u043f\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u043f\u0443\u0441\u043a\u0430 ETCD \u0432 \u0444\u0430\u0439\u043b\u0435 ",(0,E.jsxs)("code",{children:["$",U.M.kubernetesBaseFolderPath.value,"/manifests/etcd.yaml"]}),"\u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 `spec.containers[0].command`. \u0410 \u0438\u043c\u0435\u043d\u043d\u043e \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0445 \u043f\u043e\u043b\u0435\u0439 \u0438 \u0438\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, \u043f\u043e\u043b\u044f \u043d\u0435 \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u0432 \u0434\u0430\u043d\u043d\u044b\u0439 \u043f\u0435\u0440\u0435\u0447\u0435\u043d\u044c \u0443\u0434\u0430\u043b\u044f\u0442\u044c \u043d\u0435 \u043d\u0443\u0436\u043d\u043e!",(0,E.jsx)(D.A,{language:"bash",children:u.A`
              --advertise-client-urls=https://${k}:${v}
              --cert-file=${x.$.etcdServer.crtPath}
              --client-cert-auth=true
              --data-dir=${p.D.dataDir.value}
              --key-file=${x.$.etcdServer.keyPath}
              --listen-client-urls=https://127.0.0.1:${j.h.etcdServer.portNumber},https://${k}:${v}
              --listen-metrics-urls=http://0.0.0.0:${j.h.etcdMetricServer.portNumber}
              --listen-peer-urls=https://${k}:${j.h.etcdPeer.portNumber}
              --name=${e}
              --peer-cert-file=${x.$.etcdPeer.crtPath}
              --peer-client-cert-auth=true
              --peer-key-file=${x.$.etcdPeer.keyPath}
              --peer-trusted-ca-file=${x.$.etcdCA.crtPath}
              --trusted-ca-file=${x.$.etcdCA.keyPath}
            `}),(0,E.jsxs)("table",{children:[(0,E.jsxs)("tr",{children:[(0,E.jsx)("th",{children:"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440"}),(0,E.jsx)("th",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`advertise-client-urls` "}),(0,E.jsx)("td",{children:"\u0410\u043d\u043e\u043d\u0441\u0438\u0440\u0443\u0435\u043c\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0443\u0437\u043b\u0443, \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432. \u0421\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442 \u0441 IP \u0430\u0434\u0440\u0435\u0441\u043e\u043c \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`cert-file`             "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`client-cert-auth`      "}),(0,E.jsx)("td",{children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c/\u0432\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043f\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0443"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`data-dir`              "}),(0,E.jsx)("td",{children:"\u0414\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0444\u0430\u0439\u043b\u044b \u0411\u0414 ETCD"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`key-file`              "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`listen-client-urls`    "}),(0,E.jsx)("td",{children:"\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b (`0.0.0.0`, `127.0.0.1` \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`listen-metrics-urls`   "}),(0,E.jsx)("td",{children:"\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a \u043c\u0435\u0442\u0440\u0438\u043a\u0430\u043c (`0.0.0.0`, `127.0.0.1` \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`listen-peer-urls`      "}),(0,E.jsx)("td",{children:"\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043e\u0442 \u0434\u0440\u0443\u0433\u0438\u0445 \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 (`0.0.0.0`, `127.0.0.1` \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`name`                  "}),(0,E.jsx)("td",{children:"\u0418\u043c\u044f \u0443\u0437\u043b\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`peer-cert-file`        "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`peer-client-cert-auth` "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`peer-key-file`         "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`peer-trusted-ca-file`  "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`trusted-ca-file`       "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]})]}),(0,E.jsx)(H.A,{message:"Warning",description:"\u0415\u0441\u043b\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 `initial-cluster-state` \u0440\u0430\u0432\u0435\u043d \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044e `existing` \u0438\u043b\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0444\u0430\u0439\u043b\u044b \u0411\u0414 \u0438 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u043d\u0435\u0439, \u0442\u043e\u0433\u0434\u0430 \u0432\u0441\u0435 \u043f\u0440\u043e\u0447\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b, \u0438\u043c\u044f \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442\u0441\u044f \u0441\u043e \u0441\u043b\u043e\u0432\u0430 `initial` \u0431\u0443\u0434\u0443\u0442 \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f. \u0412 \u043d\u0430\u0448\u0435\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u043c\u044b \u0443\u0436\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u043b\u0438 \u0444\u0430\u0439\u043b\u044b \u0411\u0414 \u0438 \u0432\u043d\u0435\u0441\u043b\u0438 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430 \u044d\u0442\u0430\u043f\u0435 \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0438 \u0411\u0414 \u0438\u0437 \u0441\u043d\u0438\u043c\u043a\u0430.",type:"warning",showIcon:!0}),"8. \u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 kubelet:",(0,E.jsx)(D.A,{language:"bash",children:u.A`
              systemctl start kubelet
            `}),"9. \u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0438 \u043b\u043e\u0433\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0412\u044b\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043f\u0438\u0441\u043e\u043a \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0445 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0449\u0438\u0445 etcd \u0432 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0438 \u043f\u043e\u0434\u0430, \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430, \u0438\u043b\u0438 \u043d\u0435\u0439\u043c\u0441\u043f\u0435\u0439\u0441\u0430",(0,E.jsx)(D.A,{language:"bash",children:u.A`
              crictl ps -o json | jq -r \\
                '(["PODNAME","PODNAMESPACE","CONTAINERNAME","CONTAINERID"] | (., map(length*"-"))), (.containers[] | [.labels."io.kubernetes.pod.name", .labels."io.kubernetes.pod.namespace", .metadata.name, .id ])| @tsv' |
              grep -e "etcd" -e "PODNAME" -e "---"  |
              column -t
            `}),"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0432\u044b\u0432\u043e\u0434 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0437\u0430\u0434\u0430\u0439\u0442\u0435 \u043d\u0435\u0439\u043c\u0441\u043f\u0435\u0439\u0441 \u0438 \u0438\u043c\u044f \u043f\u043e\u0434\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0443\u0436\u043d\u043e \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c:",(0,E.jsx)(X.LX,{}),(0,E.jsx)(D.A,{language:"bash",children:u.A`
              crictl ps $(cidsearch \${SEARCH_POD_NAME} \${SEARCH_NAMESPACE})
              crictl logs $(cidsearch \${SEARCH_POD_NAME} \${SEARCH_NAMESPACE})
            `}),"11. \u041f\u0440\u0438 \u043f\u043e\u043c\u043e\u0449\u0438 \u043a\u043e\u043c\u0430\u043d\u0434 `etcdctl member list` \u0438 `etcdctl endpoint status --cluster` \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430. 12. \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0438\u0442\u0435 \u043a \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0435 \u0432\u0442\u043e\u0440\u043e\u0433\u043e \u0443\u0437\u043b\u0430."]}),(0,E.jsxs)(L.A,{value:"Master-2",children:["1. \u041d\u0430 \u043f\u0435\u0440\u0432\u043e\u043c \u0443\u0437\u043b\u0435 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0434\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0432\u0442\u043e\u0440\u043e\u0439 \u0443\u0437\u0435\u043b \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 \u043e\u0431\u0443\u0447\u0430\u044e\u0449\u0435\u0433\u043e\u0441\u044f:",(0,E.jsx)(D.A,{language:"bash",children:`etcdctl member add \${ETCD_NODE_NAME_2} --peer-urls=https://\${K8S_NODE_ADDRESS_2}:${P} --learner ;`}),"2. \u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a \u0412\u041c  \u0432\u0442\u043e\u0440\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e ssh \u0438 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 `kubelet`, \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u0438\u0442\u044c \u0435\u043c\u0443 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c ETCD.",(0,E.jsx)(D.A,{language:"bash",children:"systemctl stop kubelet"}),"3. \u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 \u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 `etcd`:",(0,E.jsx)(D.A,{language:"bash",children:u.A`
              export CONTAINER_ID="$(crictl ps -a  \\
                --label io.kubernetes.container.name=etcd \\
                --label io.kubernetes.pod.namespace=kube-system \\
                | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"
              crictl stop \${CONTAINER_ID}
              crictl rm \${CONTAINER_ID}
            `}),"4. \u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 [\u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e](#\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435-\u0440\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0439-\u043a\u043e\u043f\u0438\u0438-\u0444\u0430\u0439\u043b\u043e\u0432-\u0431\u0434). 5. \u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0441\u0442\u0430\u0440\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0438\u0437 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,E.jsx)("code",{children:p.D.dataDir.value}),(0,E.jsx)(D.A,{language:"bash",children:`rm -rf ${p.D.workDir.value}/*`}),"6. \u041e\u0442\u043a\u0440\u043e\u0439\u0442\u0435 \u043d\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0444\u0430\u0439\u043b ",(0,E.jsxs)("code",{children:["$",U.M.kubernetesBaseFolderPath.value,"/manifests/etcd.yaml"]}),": \u041d\u0430\u0439\u0434\u0438\u0442\u0435 \u0438 \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0445 \u043a\u043b\u044e\u0447\u0435\u0439 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 `spec.containers[0].command` \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u043e \u043f\u0440\u0438\u043c\u0435\u0440\u0443 \u043d\u0438\u0436\u0435 \u0432 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0438 \u0441 \u0432\u0430\u0448\u0438\u043c\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438\u0438 \u0442\u0430\u0431\u043b\u0438\u0446\u0435\u0439 \u0441 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435\u043c:",(0,E.jsx)(D.A,{language:"bash",children:u.A`
              --advertise-client-urls=https://${m}:${v}
              --cert-file=${x.$.etcdServer.crtPath}
              --client-cert-auth=true
              --data-dir=${p.D.dataDir.value}
              --initial-advertise-peer-urls=https://${m}:${j.h.etcdPeer.portNumber}
              --initial-cluster=${e}=https://${k}:${j.h.etcdPeer.portNumber},${t}=https://${m}:${j.h.etcdPeer.portNumber}
              --key-file=${x.$.etcdServer.keyPath}
              --listen-client-urls=https://127.0.0.1:${j.h.etcdServer.portNumber},https://${m}:${v}
              --listen-metrics-urls=http://0.0.0.0:${j.h.etcdMetricServer.portNumber}
              --listen-peer-urls=https://${m}:${j.h.etcdPeer.portNumber}
              --name=${t}
              --peer-cert-file=${x.$.etcdPeer.crtPath}
              --peer-client-cert-auth=true
              --peer-key-file=${x.$.etcdPeer.keyPath}
              --peer-trusted-ca-file=${x.$.etcdCA.crtPath}
              --trusted-ca-file=${x.$.etcdCA.keyPath}
            `}),(0,E.jsxs)("table",{children:[(0,E.jsxs)("tr",{children:[(0,E.jsx)("th",{children:"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440"}),(0,E.jsx)("th",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`advertise-client-urls`       "}),(0,E.jsx)("td",{children:"\u0410\u043d\u043e\u043d\u0441\u0438\u0440\u0443\u0435\u043c\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0443\u0437\u043b\u0443, \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432. \u0421\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442 \u0441 IP \u0430\u0434\u0440\u0435\u0441\u043e\u043c \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`cert-file`                   "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`client-cert-auth`            "}),(0,E.jsx)("td",{children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c/\u0432\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043f\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0443"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`data-dir`                    "}),(0,E.jsx)("td",{children:"\u0414\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0444\u0430\u0439\u043b\u044b \u0411\u0414 ETCD"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`key-file`                    "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`initial-advertise-peer-urls` "}),(0,E.jsx)("td",{children:"\u0410\u043d\u043e\u043d\u0441\u0438\u0440\u0443\u0435\u043c\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0434\u0430\u043d\u043d\u043e\u043c\u0443 \u0443\u0437\u043b\u0443 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`initial-cluster`             "}),(0,E.jsx)("td",{children:"\u041f\u0435\u0440\u0435\u0447\u0435\u043d\u044c \u0443\u0437\u043b\u043e\u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 ETCD \u0438 \u0438\u0445 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u0432 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0411\u0414 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0443\u0437\u043b\u0430."})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`listen-client-urls`          "}),(0,E.jsx)("td",{children:"\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b (`0.0.0.0`, `127.0.0.1` \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`listen-metrics-urls`         "}),(0,E.jsx)("td",{children:"\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a \u043c\u0435\u0442\u0440\u0438\u043a\u0430\u043c (`0.0.0.0`, `127.0.0.1` \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`listen-peer-urls`            "}),(0,E.jsx)("td",{children:"\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043e\u0442 \u0434\u0440\u0443\u0433\u0438\u0445 \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 (`0.0.0.0`, `127.0.0.1` \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`name`                        "}),(0,E.jsx)("td",{children:"\u0418\u043c\u044f \u0443\u0437\u043b\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`peer-cert-file`              "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`peer-client-cert-auth`       "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`peer-key-file`               "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`peer-trusted-ca-file`        "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`trusted-ca-file`             "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]})]}),"7. \u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 kubelet:",(0,E.jsx)(D.A,{language:"bash",children:"systemctl start kubelet"}),"8. \u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0438 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043e\u0448\u0438\u0431\u043e\u043a",(0,E.jsx)(D.A,{language:"bash",children:u.A`
              export CONTAINER_ID="$(crictl ps -a  \\
                --label io.kubernetes.container.name=etcd \\
                --label io.kubernetes.pod.namespace=kube-system \\
                | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"

              crictl ps --id $CONTAINER_ID

              crictl logs $CONTAINER_ID
            `}),"9. \u0412\u0435\u0440\u043d\u0438\u0442\u0435\u0441\u044c \u043a \u043f\u0435\u0440\u0432\u043e\u043c\u0443 \u0443\u0437\u043b\u0443 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435, \u0447\u0442\u043e \u0432\u0442\u043e\u0440\u043e\u0439 \u0443\u0437\u0435\u043b \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u043b\u0441\u044f (\u0415\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c `started`):",(0,E.jsx)(D.A,{language:"bash",children:"ectl member list -w table"}),"10. \u041f\u043e\u0441\u043b\u0435 \u044d\u0442\u043e\u0433\u043e \u043f\u0435\u0440\u0435\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0442\u043e\u0440\u043e\u0439 \u0443\u0437\u0435\u043b \u0432 \u0440\u0430\u0431\u043e\u0447\u0438\u0439 \u0440\u0435\u0436\u0438\u043c:",(0,E.jsx)(D.A,{language:"bash",children:"ectl member promote ${ETCD_NODE_NAME_2}"}),"11. \u041f\u0440\u0438 \u043f\u043e\u043c\u043e\u0449\u0438 \u043a\u043e\u043c\u0430\u043d\u0434 `member list` \u0438 `endpoint status` \u043e\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0445 \u0432\u044b\u0448\u0435 [\u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430](#\u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430-\u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f-\u0438-\u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f-\u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430). 12. \u041f\u0435\u0440\u0435\u0445\u043e\u0434\u0438\u0442\u0435 \u043a \u0442\u0440\u0435\u0442\u044c\u0435\u043c\u0443 \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"]}),(0,E.jsxs)(L.A,{value:"Master-3",children:["1. \u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a \u043f\u0435\u0440\u0432\u043e\u043c\u0443 \u0443\u0437\u043b\u0443 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0438 \u0434\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0442\u0440\u0435\u0442\u0438\u0439 \u0443\u0437\u0435\u043b \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 \u043e\u0431\u0443\u0447\u0430\u044e\u0449\u0435\u0433\u043e\u0441\u044f:",(0,E.jsx)(D.A,{language:"bash",children:`etcdctl member add \${ETCD_NODE_NAME_3} --peer-urls=https://\${K8S_NODE_ADDRESS_3}:${P} --learner ;`}),"2. \u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a \u0412\u041c  \u0442\u0440\u0435\u0442\u044c\u0435\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e ssh \u0438 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 `kubelet`, \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u0438\u0442\u044c \u0435\u043c\u0443 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c ETCD.",(0,E.jsx)(D.A,{language:"bash",children:"systemctl stop kubelet"}),"3. \u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 \u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 `etcd`:",(0,E.jsx)(D.A,{language:"bash",children:u.A`
              export CONTAINER_ID="$(crictl ps -a  \\
                --label io.kubernetes.container.name=etcd \\
                --label io.kubernetes.pod.namespace=kube-system \\
                | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"
              crictl stop \${CONTAINER_ID}
              crictl rm \${CONTAINER_ID}
            `}),"4. \u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 [\u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e](#\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435-\u0440\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0439-\u043a\u043e\u043f\u0438\u0438-\u0444\u0430\u0439\u043b\u043e\u0432-\u0431\u0434). 5. \u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0441\u0442\u0430\u0440\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0438\u0437 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,E.jsx)("code",{children:p.D.dataDir.value}),(0,E.jsx)(D.A,{language:"bash",children:`rm -rf ${p.D.workDir.value}/*`}),"6. \u041e\u0442\u043a\u0440\u043e\u0439\u0442\u0435 \u043d\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0444\u0430\u0439\u043b ",(0,E.jsxs)("code",{children:["$",U.M.kubernetesBaseFolderPath.value,"/manifests/etcd.yaml"]}),": \u041d\u0430\u0439\u0434\u0438\u0442\u0435 \u0438 \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0445 \u043a\u043b\u044e\u0447\u0435\u0439 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 `spec.containers[0].command` \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u043e \u043f\u0440\u0438\u043c\u0435\u0440\u0443 \u043d\u0438\u0436\u0435 \u0432 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0438 \u0441 \u0432\u0430\u0448\u0438\u043c\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438\u0438 \u0442\u0430\u0431\u043b\u0438\u0446\u0435\u0439 \u0441 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435\u043c:",(0,E.jsx)(D.A,{language:"bash",children:u.A`
              --advertise-client-urls=https://${_}:${v}
              --cert-file=${x.$.etcdServer.crtPath}
              --client-cert-auth=true
              --data-dir=${p.D.dataDir.value}
              --initial-advertise-peer-urls=https://${_}:${j.h.etcdPeer.portNumber}
              --initial-cluster=${e}=https://${k}:${j.h.etcdPeer.portNumber},${t}=https://${m}:${j.h.etcdPeer.portNumber},${d}=https://${_}:${j.h.etcdPeer.portNumber}
              --key-file=${x.$.etcdServer.keyPath}
              --listen-client-urls=https://127.0.0.1:${j.h.etcdServer.portNumber},https://${_}:${v}
              --listen-metrics-urls=http://0.0.0.0:${j.h.etcdMetricServer.portNumber}
              --listen-peer-urls=https://${_}:${j.h.etcdPeer.portNumber}
              --name=${d}
              --peer-cert-file=${x.$.etcdPeer.crtPath}
              --peer-client-cert-auth=true
              --peer-key-file=${x.$.etcdPeer.keyPath}
              --peer-trusted-ca-file=${x.$.etcdCA.crtPath}
              --trusted-ca-file=${x.$.etcdCA.keyPath}
            `}),(0,E.jsxs)("table",{children:[(0,E.jsxs)("tr",{children:[(0,E.jsx)("th",{children:"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440"}),(0,E.jsx)("th",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`advertise-client-urls`       "}),(0,E.jsx)("td",{children:"\u0410\u043d\u043e\u043d\u0441\u0438\u0440\u0443\u0435\u043c\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0443\u0437\u043b\u0443, \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432. \u0421\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442 \u0441 IP \u0430\u0434\u0440\u0435\u0441\u043e\u043c \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`cert-file`                   "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`client-cert-auth`            "}),(0,E.jsx)("td",{children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c/\u0432\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043f\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0443"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`data-dir`                    "}),(0,E.jsx)("td",{children:"\u0414\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0444\u0430\u0439\u043b\u044b \u0411\u0414 ETCD"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`key-file`                    "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`initial-advertise-peer-urls` "}),(0,E.jsx)("td",{children:"\u0410\u043d\u043e\u043d\u0441\u0438\u0440\u0443\u0435\u043c\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0434\u0430\u043d\u043d\u043e\u043c\u0443 \u0443\u0437\u043b\u0443 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`initial-cluster`             "}),(0,E.jsx)("td",{children:"\u041f\u0435\u0440\u0435\u0447\u0435\u043d\u044c \u0443\u0437\u043b\u043e\u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 ETCD \u0438 \u0438\u0445 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u0432 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0411\u0414 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0443\u0437\u043b\u0430."})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`listen-client-urls`          "}),(0,E.jsx)("td",{children:"\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b (`0.0.0.0`, `127.0.0.1` \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`listen-metrics-urls`         "}),(0,E.jsx)("td",{children:"\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a \u043c\u0435\u0442\u0440\u0438\u043a\u0430\u043c (`0.0.0.0`, `127.0.0.1` \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`listen-peer-urls`            "}),(0,E.jsx)("td",{children:"\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043e\u0442 \u0434\u0440\u0443\u0433\u0438\u0445 \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 (`0.0.0.0`, `127.0.0.1` \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`name`                        "}),(0,E.jsx)("td",{children:"\u0418\u043c\u044f \u0443\u0437\u043b\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`peer-cert-file`              "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`peer-client-cert-auth`       "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`peer-key-file`               "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`peer-trusted-ca-file`        "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:"`trusted-ca-file`             "}),(0,E.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]})]}),"7. \u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 kubelet:",(0,E.jsx)(D.A,{language:"bash",children:"systemctl start kubelet"}),"8. \u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0438 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043e\u0448\u0438\u0431\u043e\u043a",(0,E.jsx)(D.A,{language:"bash",children:u.A`
              export CONTAINER_ID="$(crictl ps -a  \\
                --label io.kubernetes.container.name=etcd \\
                --label io.kubernetes.pod.namespace=kube-system \\
                | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"

              crictl ps --id $CONTAINER_ID

              crictl logs $CONTAINER_ID
            `}),"9. \u0412\u0435\u0440\u043d\u0438\u0442\u0435\u0441\u044c \u043a \u043f\u0435\u0440\u0432\u043e\u043c\u0443 \u0443\u0437\u043b\u0443 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435, \u0447\u0442\u043e \u0442\u0440\u0435\u0442\u0438\u0439 \u0443\u0437\u0435\u043b \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u043b\u0441\u044f (\u0415\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c `started`):",(0,E.jsx)(D.A,{language:"bash",children:"ectl member list -w table"}),"10. \u041f\u043e\u0441\u043b\u0435 \u044d\u0442\u043e\u0433\u043e \u043f\u0435\u0440\u0435\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0440\u0435\u0442\u0438\u0439 \u0443\u0437\u0435\u043b \u0432 \u0440\u0430\u0431\u043e\u0447\u0438\u0439 \u0440\u0435\u0436\u0438\u043c:",(0,E.jsx)(D.A,{language:"bash",children:"ectl member promote ${ETCD_NODE_NAME_3}"}),"11. \u041f\u0440\u0438 \u043f\u043e\u043c\u043e\u0449\u0438 \u043a\u043e\u043c\u0430\u043d\u0434 `member list` \u0438 `endpoint status` \u043e\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0445 \u0432\u044b\u0448\u0435 [\u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430](#\u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430-\u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f-\u0438-\u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f-\u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)."]})]}),"\u041f\u043e\u0441\u043b\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0440\u0430\u0431\u043e\u0442 \u043d\u0430 \u0432\u0441\u0435\u0445 \u0442\u0440\u0435\u0445 \u0443\u0437\u043b\u0430\u0445 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u043a\u043b\u0430\u0441\u0442\u0435\u0440 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u0438 \u0433\u043e\u0442\u043e\u0432 \u043a \u0440\u0430\u0431\u043e\u0442\u0435."]})},G=()=>{const[e,s]=(0,a.useState)("etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-7plhz"),[t,r]=(0,a.useState)("etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-h9g49"),[d,n]=(0,a.useState)("etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-wps6k"),[l,c]=(0,a.useState)("in-cloud-k8s-sandbox-dev-csko-1-tcgzn-7plhz"),[i,x]=(0,a.useState)("in-cloud-k8s-sandbox-dev-csko-1-tcgzn-h9g49"),[j,p]=(0,a.useState)("in-cloud-k8s-sandbox-dev-csko-1-tcgzn-wps6k"),[$,A]=(0,a.useState)("10.10.10.3"),[N,k]=(0,a.useState)("10.10.10.4"),[b,m]=(0,a.useState)("10.10.10.5"),[C,_]=(0,a.useState)("2379"),[B,v]=(0,a.useState)("2380"),[g,P]=(0,a.useState)("admin");return(0,E.jsxs)(h.A,{vertical:!0,gap:"small",children:["\u0414\u0430\u043d\u043d\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0440\u0430\u0437\u0432\u043e\u0440\u0430\u0447\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043d\u0430 ControlPlane \u043d\u043e\u0434\u0430\u0445 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u043f\u043e 1\u043c\u0443 \u043d\u0430 \u043a\u0430\u0436\u0434\u0443\u044e. ",(0,E.jsx)("br",{}),"\u0414\u043b\u044f \u043d\u0430\u0447\u0430\u043b\u0430 \u0437\u0430\u0434\u0430\u0439\u0442\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435:",(0,E.jsxs)("li",{children:[(0,E.jsx)("code",{children:"ETCD_NODE_NAME_N"}),"    - \u0418\u043c\u044f \u043f\u043e\u0434\u0430 ETCD (\u041e\u0431\u044b\u0447\u043d\u043e \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 `etcd-\u0418\u041c\u042f_CONTROLPLANE_\u041d\u041e\u0414\u042b`)"]}),(0,E.jsxs)("li",{children:[(0,E.jsx)("code",{children:"K8S_NODE_NAME_N"}),"     - \u0418\u043c\u044f \u043d\u043e\u0434\u044b K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u043f\u043e\u0434\u043d\u0438\u043c\u0430\u0435\u0442\u0441\u044f ETCD."]}),(0,E.jsxs)("li",{children:[(0,E.jsx)("code",{children:"K8S_NODE_ADDRESS_N"}),"  - IP \u0430\u0434\u0440\u0435\u0441 \u043d\u043e\u0434\u044b K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u043f\u043e\u0434\u043d\u0438\u043c\u0430\u0435\u0442\u0441\u044f ETCD."]}),(0,E.jsxs)("li",{children:[(0,E.jsx)("code",{children:"ETCD_CLIENT_PORT"}),"    - \u041f\u043e\u0440\u0442 \u043a \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u044e\u0442\u0441\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u044b ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."]}),(0,E.jsxs)("li",{children:[(0,E.jsx)("code",{children:"ETCD_PEER_PORT"}),"      - \u041f\u043e\u0440\u0442 \u043a \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u044e\u0442\u0441\u044f \u0434\u0440\u0443\u0433\u0438\u0435 \u0443\u0437\u043b\u044b ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."]}),(0,E.jsxs)("li",{children:[(0,E.jsx)("code",{children:"K8S_NODE_USERNAME"}),"   - \u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u043f\u043e \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a \u0443\u0437\u043b\u0430\u043c K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e SSH."]}),(0,E.jsx)(o.A,{placeholder:"etcdNodeName1",value:e,onChange:e=>s(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"etcdNodeName2",value:t,onChange:e=>r(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"etcdNodeName3",value:d,onChange:e=>n(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeName1",value:l,onChange:e=>c(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeName2",value:i,onChange:e=>x(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeName3",value:j,onChange:e=>p(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeAddress1",value:$,onChange:e=>A(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeAddress2",value:N,onChange:e=>k(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeAddress3",value:b,onChange:e=>m(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"clientPort",value:C,onChange:e=>_(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"peerPort",value:B,onChange:e=>v(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"nodeUser",value:g,onChange:e=>P(e.target.value)}),(0,E.jsx)(D.A,{language:"bash",children:u.A`
          export ETCD_NODE_NAME_1=${e}
          export ETCD_NODE_NAME_2=${t}
          export ETCD_NODE_NAME_3=${d}
          export K8S_NODE_NAME_1=${$}
          export K8S_NODE_NAME_2=${N}
          export K8S_NODE_NAME_3=${b}
          export K8S_NODE_ADDRESS_1=${$}
          export K8S_NODE_ADDRESS_2=${N}
          export K8S_NODE_ADDRESS_3=${b}
          export ETCD_CLIENT_PORT=${C}
          export ETCD_PEER_PORT=${B}
          export K8S_NODE_USERNAME=${g}
          `})]})},q=()=>{const[e,s]=(0,a.useState)("etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-7plhz"),[t,r]=(0,a.useState)("etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-h9g49"),[d,n]=(0,a.useState)("etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-wps6k"),[l,c]=(0,a.useState)("in-cloud-k8s-sandbox-dev-csko-1-tcgzn-7plhz"),[i,x]=(0,a.useState)("in-cloud-k8s-sandbox-dev-csko-1-tcgzn-h9g49"),[j,p]=(0,a.useState)("in-cloud-k8s-sandbox-dev-csko-1-tcgzn-wps6k"),[$,A]=(0,a.useState)("10.10.10.3"),[N,k]=(0,a.useState)("10.10.10.4"),[b,m]=(0,a.useState)("10.10.10.5"),[C,_]=(0,a.useState)("2379"),[B,v]=(0,a.useState)("2380"),[g,P]=(0,a.useState)("admin");return(0,E.jsxs)(h.A,{vertical:!0,gap:"small",children:["\u0414\u0430\u043d\u043d\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0440\u0430\u0437\u0432\u043e\u0440\u0430\u0447\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043d\u0430 ControlPlane \u043d\u043e\u0434\u0430\u0445 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u043f\u043e 1\u043c\u0443 \u043d\u0430 \u043a\u0430\u0436\u0434\u0443\u044e. ",(0,E.jsx)("br",{}),"\u0414\u043b\u044f \u043d\u0430\u0447\u0430\u043b\u0430 \u0437\u0430\u0434\u0430\u0439\u0442\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435:",(0,E.jsxs)("li",{children:[(0,E.jsx)("code",{children:"ETCD_NODE_NAME_N"}),"    - \u0418\u043c\u044f \u043f\u043e\u0434\u0430 ETCD (\u041e\u0431\u044b\u0447\u043d\u043e \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 `etcd-\u0418\u041c\u042f_CONTROLPLANE_\u041d\u041e\u0414\u042b`)"]}),(0,E.jsxs)("li",{children:[(0,E.jsx)("code",{children:"K8S_NODE_NAME_N"}),"     - \u0418\u043c\u044f \u043d\u043e\u0434\u044b K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u043f\u043e\u0434\u043d\u0438\u043c\u0430\u0435\u0442\u0441\u044f ETCD."]}),(0,E.jsxs)("li",{children:[(0,E.jsx)("code",{children:"K8S_NODE_ADDRESS_N"}),"  - IP \u0430\u0434\u0440\u0435\u0441 \u043d\u043e\u0434\u044b K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u043f\u043e\u0434\u043d\u0438\u043c\u0430\u0435\u0442\u0441\u044f ETCD."]}),(0,E.jsxs)("li",{children:[(0,E.jsx)("code",{children:"ETCD_CLIENT_PORT"}),"    - \u041f\u043e\u0440\u0442 \u043a \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u044e\u0442\u0441\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u044b ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."]}),(0,E.jsxs)("li",{children:[(0,E.jsx)("code",{children:"ETCD_PEER_PORT"}),"      - \u041f\u043e\u0440\u0442 \u043a \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u044e\u0442\u0441\u044f \u0434\u0440\u0443\u0433\u0438\u0435 \u0443\u0437\u043b\u044b ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."]}),(0,E.jsxs)("li",{children:[(0,E.jsx)("code",{children:"K8S_NODE_USERNAME"}),"   - \u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u043f\u043e \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a \u0443\u0437\u043b\u0430\u043c K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e SSH."]}),(0,E.jsx)(o.A,{placeholder:"etcdNodeName1",value:e,onChange:e=>s(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"etcdNodeName2",value:t,onChange:e=>r(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"etcdNodeName3",value:d,onChange:e=>n(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeName1",value:l,onChange:e=>c(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeName2",value:i,onChange:e=>x(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeName3",value:j,onChange:e=>p(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeAddress1",value:$,onChange:e=>A(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeAddress2",value:N,onChange:e=>k(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"k8sNodeAddress3",value:b,onChange:e=>m(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"clientPort",value:C,onChange:e=>_(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"peerPort",value:B,onChange:e=>v(e.target.value)}),(0,E.jsx)(o.A,{placeholder:"nodeUser",value:g,onChange:e=>P(e.target.value)}),(0,E.jsx)(D.A,{language:"bash",children:u.A`
          export ETCD_NODE_NAME_1=${e}
          export ETCD_NODE_NAME_2=${t}
          export ETCD_NODE_NAME_3=${d}
          export K8S_NODE_NAME_1=${$}
          export K8S_NODE_NAME_2=${N}
          export K8S_NODE_NAME_3=${b}
          export K8S_NODE_ADDRESS_1=${$}
          export K8S_NODE_ADDRESS_2=${N}
          export K8S_NODE_ADDRESS_3=${b}
          export ETCD_CLIENT_PORT=${C}
          export ETCD_PEER_PORT=${B}
          export K8S_NODE_USERNAME=${g}
          `})]})},W={...r},Q={...d},V={...n},Z={...l},ee={...c},se={...i}},57683:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>h,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"tech-docs/etcd/troubleshooting/restore","title":"5.1.5.8. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435","description":"\u0412 \u0434\u0430\u043d\u043d\u043e\u0439 \u0433\u043b\u0430\u0432\u0435, \u0440\u0430\u0441\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u0434\u0432\u0430 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u0430 ETCD:","source":"@site/docs/tech-docs/etcd/troubleshooting/restore.mdx","sourceDirName":"tech-docs/etcd/troubleshooting","slug":"/tech-docs/etcd/troubleshooting/restore","permalink":"/tech-docs/etcd/troubleshooting/restore","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"restore"},"sidebar":"techDocs","previous":{"title":"5.1.5.7. \u0411\u0435\u043a\u0430\u043f\u044b","permalink":"/tech-docs/etcd/troubleshooting/backups"},"next":{"title":"5.2.1.1. \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u041e\u0421","permalink":"/tech-docs/kubernetes/setup-environments/os-setup"}}');var d=t(74848),n=t(28453),l=(t(1775),t(6353),t(31798),t(7478),t(87464),t(62774),t(63770),t(10119),t(78207)),c=t(91476);const i={id:"restore"},a="5.1.5.8. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435",h={},o=[{value:"5.1.5.8.1. ETCD in k8s cluster",id:"51581-etcd-in-k8s-cluster",level:2},...l.toc,{value:"5.1.5.8.2. ETCD Kube API current k8s cluster",id:"51582-etcd-kube-api-current-k8s-cluster",level:2},...c.toc];function D(e){const s={h1:"h1",h2:"h2",header:"header",hr:"hr",p:"p",...(0,n.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.header,{children:(0,d.jsx)(s.h1,{id:"5158-\u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435",children:"5.1.5.8. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435"})}),"\n",(0,d.jsx)(s.p,{children:"\u0412 \u0434\u0430\u043d\u043d\u043e\u0439 \u0433\u043b\u0430\u0432\u0435, \u0440\u0430\u0441\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u0434\u0432\u0430 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u0430 ETCD:"}),"\n",(0,d.jsx)(s.p,{children:"I. ETCD, \u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044b\u0439 \u0432\u043d\u0443\u0442\u0440\u0438 K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."}),"\n",(0,d.jsx)(s.p,{children:"II. ETCD, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0439 KubeAPI \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."}),"\n",(0,d.jsx)(s.h2,{id:"51581-etcd-in-k8s-cluster",children:"5.1.5.8.1. ETCD in k8s cluster"}),"\n",(0,d.jsx)(l.default,{}),"\n",(0,d.jsx)(s.h2,{id:"51582-etcd-kube-api-current-k8s-cluster",children:"5.1.5.8.2. ETCD Kube API current k8s cluster"}),"\n",(0,d.jsx)(c.default,{}),"\n",(0,d.jsx)(s.hr,{}),"\n",(0,d.jsx)(s.p,{children:"TODO \u043e\u043f\u0438\u0448\u0438 \u043a\u0430\u043a \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 gardener etcd-backup (\u0432 \u0440\u0435\u0436\u0438\u043c\u0435 \u0441\u043d\u0430\u043f\u0448\u043e\u0442\u043e\u0432)"}),"\n",(0,d.jsx)(s.hr,{})]})}function u(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,d.jsx)(s,{...e,children:(0,d.jsx)(D,{...e})}):D(e)}},61087:(e,s,t)=>{t.r(s),t.d(s,{ETCD_api_address:()=>g,ETCD_endpoint_1:()=>p,ETCD_endpoint_2:()=>E,ETCD_endpoint_3:()=>$,ETCD_endpoints:()=>j,ETCD_etcd_pod_1:()=>A,ETCD_etcd_pod_2:()=>N,ETCD_etcd_pod_3:()=>k,ETCD_k8s_cluster_name:()=>P,ETCD_k8s_node_1:()=>b,ETCD_k8s_node_2:()=>m,ETCD_k8s_node_3:()=>C,ETCD_k8s_node_address_1:()=>_,ETCD_k8s_node_address_2:()=>B,ETCD_k8s_node_address_3:()=>v,assets:()=>x,contentTitle:()=>u,default:()=>f,frontMatter:()=>D,metadata:()=>r,toc:()=>T});const r=JSON.parse('{"id":"tech-docs/etcd/troubleshooting/restore/CrushedNodeK8s","title":"CrushedNodeK8s","description":"1. \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u0435 \u0442\u0435\u043a\u0443\u0449\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430.","source":"@site/docs/tech-docs/etcd/troubleshooting/restore/crushedNodeK8s.mdx","sourceDirName":"tech-docs/etcd/troubleshooting/restore","slug":"/tech-docs/etcd/troubleshooting/restore/CrushedNodeK8s","permalink":"/tech-docs/etcd/troubleshooting/restore/CrushedNodeK8s","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"CrushedNodeK8s"}}');var d=t(74848),n=t(28453),l=t(1775),c=t(7478),i=t(87464),a=t(62774),h=(t(10119),t(80206),t(6353),t(31798)),o=t(57462);const D={id:"CrushedNodeK8s"},u=void 0,x={},j="https://10.10.10.3:2379,https://10.10.10.4:2379,https://10.10.10.5:2379",p="https://10.10.10.3:2379",E="https://10.10.10.4:2379",$="https://10.10.10.5:2379",A="etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-7plhz",N="etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-h9g49",k="etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-wps6k",b="in-cloud-k8s-sandbox-dev-csko-1-tcgzn-7plhz",m="in-cloud-k8s-sandbox-dev-csko-1-tcgzn-h9g49",C="in-cloud-k8s-sandbox-dev-csko-1-tcgzn-wps6k",_="10.10.10.3",B="10.10.10.4",v="10.10.10.5",g="10.10.10.2",P="in-cloud-k8s-sandbox-test-csko-1",T=[];function S(e){const s={a:"a",code:"code",li:"li",ol:"ol",p:"p",...(0,n.R)(),...e.components};return o.ij||y("CrushedNodeFunctionsK8s",!1),o.ij.Input1||y("CrushedNodeFunctionsK8s.Input1",!0),o.ij.Output1||y("CrushedNodeFunctionsK8s.Output1",!0),o.ij.Provider||y("CrushedNodeFunctionsK8s.Provider",!0),(0,d.jsxs)(o.ij.Provider,{children:[(0,d.jsx)(o.ij.Input1,{}),(0,d.jsx)(o.ij.Output1,{}),(0,d.jsxs)(s.ol,{children:["\n",(0,d.jsx)(s.li,{children:"\u041e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u0435 \u0442\u0435\u043a\u0443\u0449\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."}),"\n"]}),(0,d.jsxs)(a.A,{groupId:"etcd-kubeapi",children:[(0,d.jsxs)(i.A,{value:"KubeAPI \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c\u043e\u0433\u043e \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430",children:[(0,d.jsx)(s.p,{children:"\u0415\u0441\u043b\u0438 \xa0KubeAPI \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c\u043e\u0433\u043e  \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e, \u0442\u043e\u0433\u0434\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u044d\u0442\u043e\u0442 \u0432\u0430\u0440\u0438\u0430\u043d\u0442."}),(0,d.jsxs)(s.ol,{start:"2",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a KubeAPI \u0438 \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u0443:"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"kubectl get pod -n kube-system -l component=etcd -o wide"}),(0,d.jsxs)(s.ol,{start:"3",children:["\n",(0,d.jsx)(s.li,{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u043e\u0434 \u0443\u0437\u043b\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0438\u0437 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u043e\u0439 \u0442\u0430\u0431\u043b\u0438\u0446\u044b, \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0432\u044b \u0431\u0443\u0434\u0435\u0442\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0442\u044c \u043a\u043b\u0430\u0441\u0442\u0435\u0440."}),"\n"]})]}),(0,d.jsxs)(i.A,{value:"kubeAPI \u0438\u043d\u0444\u0440\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430",children:[(0,d.jsxs)(s.ol,{start:"2",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a KubeAPI \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043d\u043e\u0433\u043e \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0438 \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u0443:"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"kubectl get machine -n in-cloud-k8s-sandbox-test-csko-1\n  -l cluster.x-k8s.io/control-plane=\n  -o custom-columns=NAME:.metadata.name,ADDRESSES:status.addresses[0].address\n"}),(0,d.jsxs)(s.ol,{start:"3",children:["\n",(0,d.jsx)(s.li,{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0443\u0437\u0435\u043b k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u0441 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0432\u044b \u0431\u0443\u0434\u0435\u0442\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0442\u044c \u043a\u043b\u0430\u0441\u0442\u0435\u0440."}),"\n"]})]})]}),(0,d.jsxs)(s.ol,{start:"4",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u043c\u0443 \u0432\u0430\u043c\u0438 \u0443\u0437\u043b\u0443 K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0438\u043b\u0438 \u0443\u0437\u043b\u0443 K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u0432\u0430\u043c\u0438 \u043f\u043e\u0434\u0430."}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["C\u043e\u0431\u0435\u0440\u0438\u0442\u0435 \u0432\u0441\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u044b\u0435 ",(0,d.jsx)(s.a,{href:"#%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0-%D0%BE%D0%BA%D1%80%D1%83%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F",children:"\u043f\u0440\u0435\u0440\u0435\u043a\u0432\u0438\u0437\u0438\u0442\u044b"})," \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a ETCD \u0438 K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0443."]}),"\n"]}),"\n"]}),(0,d.jsxs)(a.A,{groupId:"etcd-status",children:[(0,d.jsx)(i.A,{value:"ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442",children:(0,d.jsxs)(s.ol,{start:"6",children:["\n",(0,d.jsxs)(s.li,{children:["\u0415\u0441\u043b\u0438 \u0443\u0434\u0430\u0435\u0442\u0441\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0443, \u0442\u043e\u0433\u0434\u0430 \u0441\u043e\u0437\u0434\u0430\u0439\u0442\u0435 ",(0,d.jsx)(s.a,{href:"#%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-%D1%80%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%BD%D1%8B%D1%85-%D0%BA%D0%BE%D0%BF%D0%B8%D0%B9",children:"\u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e"}),"\n\u0438 ",(0,d.jsx)(s.a,{href:"#%D0%B2%D0%BE%D1%81%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-%D1%83%D0%B7%D0%BB%D0%B0-%D0%B8%D0%B7-%D0%BC%D0%B3%D0%BD%D0%BE%D0%B2%D0%B5%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE-%D1%81%D0%BD%D0%B8%D0%BC%D0%BA%D0%B0",children:"\u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})," \u0441 \u0434\u0430\u043b\u044c\u043d\u0435\u0439\u0448\u0438\u043c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\u043c\n\u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."]}),"\n"]})}),(0,d.jsxs)(i.A,{value:"ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440 \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442",children:[(0,d.jsxs)(s.ol,{start:"6",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0415\u0441\u043b\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0443 \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e, \u0441\u0434\u0435\u043b\u0430\u0439\u0442\u0435 ",(0,d.jsx)(s.a,{href:"#%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-%D1%80%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%BD%D0%BE%D0%B9-%D0%BA%D0%BE%D0%BF%D0%B8%D0%B8-%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2-%D0%B1%D0%B4",children:"\u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e \u0444\u0430\u0439\u043b\u043e\u0432 \u0411\u0414"}),"."]}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u041e\u0442\u043a\u0440\u043e\u0439\u0442\u0435 \u043d\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0444\u0430\u0439\u043b ",(0,d.jsxs)("code",{children:["$",c.M.kubernetesBaseFolderPath.value,"/manifests/etcd.yaml"]}),"."]}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0412 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u0445 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 ETCD \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 ",(0,d.jsx)(s.code,{children:"spec.containers[0].command"}),"\n\u0434\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u043a\u043b\u044e\u0447:"]}),"\n"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"--force-new-cluster"}),(0,d.jsxs)(s.p,{children:["\u0417\u0434\u0435\u0441\u044c \u0436\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 ",(0,d.jsx)(s.code,{children:"initial-cluster"})," \u0442\u0430\u043a, \u0447\u0442\u043e\u0431\u044b \u0432 \u043d\u0435\u043c \u043e\u0441\u0442\u0430\u043b\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u0443\u0437\u0435\u043b ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."]}),(0,d.jsx)(l.A,{language:"bash",children:`--initial-cluster=${b}=https://${_}:${h.h.etcdPeer.portNumber} `}),(0,d.jsxs)(s.p,{children:["\u0422\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c, \u043f\u0440\u0438 \u0441\u043b\u0435\u0434\u0443\u0449\u0435\u043c \u0437\u0430\u043f\u0443\u0441\u043a\u0435 ETCD \u0431\u0443\u0434\u0443\u0442 \u0443\u0434\u0430\u043b\u0435\u043d\u044b \u0432\u0441\u0435 \u0442\u0435\u043a\u0443\u0449\u0438\u0435 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0444\u0430\u0439\u043b\u043e\u0432 \u0411\u0414,\n\u0438 \u0442\u0443\u0434\u0430 \u0431\u0443\u0434\u0443\u0442 \u0437\u0430\u043f\u0438\u0441\u0430\u043d\u044b \u043d\u043e\u0432\u044b\u0435, \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 ",(0,d.jsx)(s.code,{children:"spec.containers[0].command"})," \u0441 \u0441\u0443\u0444\u0444\u0438\u043a\u0441\u043e\u043c initial."]}),(0,d.jsxs)(s.ol,{start:"9",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"\u0414\u043e\u0436\u0434\u0438\u0442\u0435\u0441\u044c, \u043a\u043e\u0433\u0434\u0430 \u043f\u0435\u0440\u0435\u0441\u043e\u0437\u0434\u0430\u0441\u0442\u0441\u044f \u043f\u043e\u0434 ETCD \u0443\u0437\u043b\u0430 \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0435\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435."}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0412 \u0444\u0430\u0439\u043b\u0435 ",(0,d.jsxs)("code",{children:["$",c.M.kubernetesBaseFolderPath.value,"/manifests/etcd.yaml"]}),"\n\u0432 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u0445 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 ETCD \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 ",(0,d.jsx)(s.code,{children:"spec.containers[0].command"}),"\n\u0443\u0434\u0430\u043b\u0438\u0442\u0435 \u043a\u043b\u044e\u0447:"]}),"\n"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"--force-new-cluster"}),(0,d.jsx)(s.p,{children:"\u0412 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u043f\u0440\u0438 \u043a\u0430\u0436\u0434\u043e\u043c \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u043f\u043e\u0434\u0430/\u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0431\u0443\u0434\u0443\u0442 \u0443\u0434\u0430\u043b\u044f\u0442\u044c\u0441\u044f \u0432\u0441\u0435 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0411\u0414."}),(0,d.jsxs)(s.ol,{start:"10",children:["\n",(0,d.jsxs)(s.li,{children:["\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 2\u0439 \u0438 3\u0439 \u0443\u0437\u043b\u044b \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 ETCD \u043a\u0430\u043a \u044d\u0442\u043e \u0443\u043a\u0430\u0437\u0430\u043d\u043e \u0432 \u0438\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u0438 \u043a\n",(0,d.jsx)(s.a,{href:"#%D0%B2%D0%BE%D1%81%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-%D1%83%D0%B7%D0%BB%D0%B0-%D0%B8%D0%B7-%D0%BC%D0%B3%D0%BD%D0%BE%D0%B2%D0%B5%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE-%D1%81%D0%BD%D0%B8%D0%BC%D0%BA%D0%B0",children:"\u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044e \u0441 \u043e\u0434\u043d\u043e\u0433\u043e \u0443\u0437\u043b\u0430"})," \u0434\u043b\u044f ",(0,d.jsx)(s.code,{children:"Master-2"})," \u0438 ",(0,d.jsx)(s.code,{children:"Master-3"}),"."]}),"\n"]})]})]}),(0,d.jsx)(s.p,{children:"\u041d\u0430 \u044d\u0442\u043e\u043c \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043e."})]})}function f(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,d.jsx)(s,{...e,children:(0,d.jsx)(S,{...e})}):S(e)}function y(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},62582:(e,s,t)=>{t.r(s),t.d(s,{ETCD_api_address:()=>g,ETCD_endpoint_1:()=>p,ETCD_endpoint_2:()=>E,ETCD_endpoint_3:()=>$,ETCD_endpoints:()=>j,ETCD_etcd_pod_1:()=>A,ETCD_etcd_pod_2:()=>N,ETCD_etcd_pod_3:()=>k,ETCD_k8s_cluster_name:()=>P,ETCD_k8s_node_1:()=>b,ETCD_k8s_node_2:()=>m,ETCD_k8s_node_3:()=>C,ETCD_k8s_node_address_1:()=>_,ETCD_k8s_node_address_2:()=>B,ETCD_k8s_node_address_3:()=>v,assets:()=>x,contentTitle:()=>u,default:()=>f,frontMatter:()=>D,metadata:()=>r,toc:()=>T});const r=JSON.parse('{"id":"tech-docs/etcd/troubleshooting/restore/CrushedNodeKubeApi","title":"CrushedNodeKubeApi","description":"1. \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u0435 \u0442\u0435\u043a\u0443\u0449\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430.","source":"@site/docs/tech-docs/etcd/troubleshooting/restore/crushedNodeKubeApi.mdx","sourceDirName":"tech-docs/etcd/troubleshooting/restore","slug":"/tech-docs/etcd/troubleshooting/restore/CrushedNodeKubeApi","permalink":"/tech-docs/etcd/troubleshooting/restore/CrushedNodeKubeApi","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"CrushedNodeKubeApi"}}');var d=t(74848),n=t(28453),l=t(1775),c=t(7478),i=t(87464),a=t(62774),h=(t(10119),t(80206),t(6353),t(31798)),o=t(57462);const D={id:"CrushedNodeKubeApi"},u=void 0,x={},j="https://10.10.10.3:2379,https://10.10.10.4:2379,https://10.10.10.5:2379",p="https://10.10.10.3:2379",E="https://10.10.10.4:2379",$="https://10.10.10.5:2379",A="etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-7plhz",N="etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-h9g49",k="etcd-in-cloud-k8s-sandbox-dev-csko-1-tcgzn-wps6k",b="in-cloud-k8s-sandbox-dev-csko-1-tcgzn-7plhz",m="in-cloud-k8s-sandbox-dev-csko-1-tcgzn-h9g49",C="in-cloud-k8s-sandbox-dev-csko-1-tcgzn-wps6k",_="10.10.10.3",B="10.10.10.4",v="10.10.10.5",g="10.10.10.2",P="in-cloud-k8s-sandbox-test-csko-1",T=[];function S(e){const s={a:"a",code:"code",li:"li",ol:"ol",p:"p",...(0,n.R)(),...e.components};return o.dS||y("CrushedNodeFunctionsKubeApi",!1),o.dS.Master||y("CrushedNodeFunctionsKubeApi.Master",!0),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(o.dS.Master,{}),"\n",(0,d.jsxs)(s.ol,{children:["\n",(0,d.jsx)(s.li,{children:"\u041e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u0435 \u0442\u0435\u043a\u0443\u0449\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."}),"\n"]}),"\n",(0,d.jsxs)(a.A,{groupId:"etcd-kubeapi",children:[(0,d.jsxs)(i.A,{value:"KubeAPI \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c\u043e\u0433\u043e \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430",children:[(0,d.jsx)(s.p,{children:"\u0415\u0441\u043b\u0438 \xa0KubeAPI \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c\u043e\u0433\u043e  \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e, \u0442\u043e\u0433\u0434\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u044d\u0442\u043e\u0442 \u0432\u0430\u0440\u0438\u0430\u043d\u0442."}),(0,d.jsxs)(s.ol,{start:"2",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a KubeAPI \u0438 \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u0443:"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"kubectl get pod -n kube-system -l component=etcd -o wide"}),(0,d.jsxs)(s.ol,{start:"3",children:["\n",(0,d.jsx)(s.li,{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u043e\u0434 \u0443\u0437\u043b\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0438\u0437 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u043e\u0439 \u0442\u0430\u0431\u043b\u0438\u0446\u044b, \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0432\u044b \u0431\u0443\u0434\u0435\u0442\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0442\u044c \u043a\u043b\u0430\u0441\u0442\u0435\u0440."}),"\n"]})]}),(0,d.jsxs)(i.A,{value:"kubeAPI \u0438\u043d\u0444\u0440\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430",children:[(0,d.jsxs)(s.ol,{start:"2",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a KubeAPI \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043d\u043e\u0433\u043e \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0438 \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u0443:"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"kubectl get machine -n in-cloud-k8s-sandbox-test-csko-1\n  -l cluster.x-k8s.io/control-plane=\n  -o custom-columns=NAME:.metadata.name,ADDRESSES:status.addresses[0].address\n"}),(0,d.jsxs)(s.ol,{start:"3",children:["\n",(0,d.jsx)(s.li,{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0443\u0437\u0435\u043b k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u0441 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0432\u044b \u0431\u0443\u0434\u0435\u0442\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0442\u044c \u043a\u043b\u0430\u0441\u0442\u0435\u0440."}),"\n"]})]})]}),"\n",(0,d.jsxs)(s.ol,{start:"4",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u043c\u0443 \u0432\u0430\u043c\u0438 \u0443\u0437\u043b\u0443 K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0438\u043b\u0438 \u0443\u0437\u043b\u0443 K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u0432\u0430\u043c\u0438 \u043f\u043e\u0434\u0430."}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["C\u043e\u0431\u0435\u0440\u0438\u0442\u0435 \u0432\u0441\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u044b\u0435 ",(0,d.jsx)(s.a,{href:"#%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0-%D0%BE%D0%BA%D1%80%D1%83%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F",children:"\u043f\u0440\u0435\u0440\u0435\u043a\u0432\u0438\u0437\u0438\u0442\u044b"})," \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a ETCD \u0438 K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0443."]}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(a.A,{groupId:"etcd-status",children:[(0,d.jsx)(i.A,{value:"ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442",children:(0,d.jsxs)(s.ol,{start:"6",children:["\n",(0,d.jsxs)(s.li,{children:["\u0415\u0441\u043b\u0438 \u0443\u0434\u0430\u0435\u0442\u0441\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0443, \u0442\u043e\u0433\u0434\u0430 \u0441\u043e\u0437\u0434\u0430\u0439\u0442\u0435 ",(0,d.jsx)(s.a,{href:"#%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-%D1%80%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%BD%D1%8B%D1%85-%D0%BA%D0%BE%D0%BF%D0%B8%D0%B9",children:"\u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e"}),"\n\u0438 ",(0,d.jsx)(s.a,{href:"#%D0%B2%D0%BE%D1%81%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-%D1%83%D0%B7%D0%BB%D0%B0-%D0%B8%D0%B7-%D0%BC%D0%B3%D0%BD%D0%BE%D0%B2%D0%B5%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE-%D1%81%D0%BD%D0%B8%D0%BC%D0%BA%D0%B0",children:"\u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})," \u0441 \u0434\u0430\u043b\u044c\u043d\u0435\u0439\u0448\u0438\u043c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\u043c\n\u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."]}),"\n"]})}),(0,d.jsxs)(i.A,{value:"ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440 \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442",children:[(0,d.jsxs)(s.ol,{start:"6",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0415\u0441\u043b\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0443 \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e, \u0441\u0434\u0435\u043b\u0430\u0439\u0442\u0435 ",(0,d.jsx)(s.a,{href:"#%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-%D1%80%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%BD%D0%BE%D0%B9-%D0%BA%D0%BE%D0%BF%D0%B8%D0%B8-%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2-%D0%B1%D0%B4",children:"\u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e \u0444\u0430\u0439\u043b\u043e\u0432 \u0411\u0414"}),"."]}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u041e\u0442\u043a\u0440\u043e\u0439\u0442\u0435 \u043d\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0444\u0430\u0439\u043b ",(0,d.jsxs)("code",{children:["$",c.M.kubernetesBaseFolderPath.value,"/manifests/etcd.yaml"]}),"."]}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0412 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u0445 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 ETCD \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 ",(0,d.jsx)(s.code,{children:"spec.containers[0].command"}),"\n\u0434\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u043a\u043b\u044e\u0447:"]}),"\n"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"--force-new-cluster"}),(0,d.jsxs)(s.p,{children:["\u0417\u0434\u0435\u0441\u044c \u0436\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 ",(0,d.jsx)(s.code,{children:"initial-cluster"})," \u0442\u0430\u043a, \u0447\u0442\u043e\u0431\u044b \u0432 \u043d\u0435\u043c \u043e\u0441\u0442\u0430\u043b\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u0443\u0437\u0435\u043b ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."]}),(0,d.jsx)(l.A,{language:"bash",children:`--initial-cluster=${b}=https://${_}:${h.h.etcdPeer.portNumber} `}),(0,d.jsxs)(s.p,{children:["\u0422\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c, \u043f\u0440\u0438 \u0441\u043b\u0435\u0434\u0443\u0449\u0435\u043c \u0437\u0430\u043f\u0443\u0441\u043a\u0435 ETCD \u0431\u0443\u0434\u0443\u0442 \u0443\u0434\u0430\u043b\u0435\u043d\u044b \u0432\u0441\u0435 \u0442\u0435\u043a\u0443\u0449\u0438\u0435 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0444\u0430\u0439\u043b\u043e\u0432 \u0411\u0414,\n\u0438 \u0442\u0443\u0434\u0430 \u0431\u0443\u0434\u0443\u0442 \u0437\u0430\u043f\u0438\u0441\u0430\u043d\u044b \u043d\u043e\u0432\u044b\u0435, \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 ",(0,d.jsx)(s.code,{children:"spec.containers[0].command"})," \u0441 \u0441\u0443\u0444\u0444\u0438\u043a\u0441\u043e\u043c initial."]}),(0,d.jsxs)(s.ol,{start:"9",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"\u0414\u043e\u0436\u0434\u0438\u0442\u0435\u0441\u044c, \u043a\u043e\u0433\u0434\u0430 \u043f\u0435\u0440\u0435\u0441\u043e\u0437\u0434\u0430\u0441\u0442\u0441\u044f \u043f\u043e\u0434 ETCD \u0443\u0437\u043b\u0430 \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0435\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435."}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0412 \u0444\u0430\u0439\u043b\u0435 ",(0,d.jsxs)("code",{children:["$",c.M.kubernetesBaseFolderPath.value,"/manifests/etcd.yaml"]}),"\n\u0432 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u0445 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 ETCD \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 ",(0,d.jsx)(s.code,{children:"spec.containers[0].command"}),"\n\u0443\u0434\u0430\u043b\u0438\u0442\u0435 \u043a\u043b\u044e\u0447:"]}),"\n"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"--force-new-cluster"}),(0,d.jsx)(s.p,{children:"\u0412 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u043f\u0440\u0438 \u043a\u0430\u0436\u0434\u043e\u043c \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u043f\u043e\u0434\u0430/\u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0431\u0443\u0434\u0443\u0442 \u0443\u0434\u0430\u043b\u044f\u0442\u044c\u0441\u044f \u0432\u0441\u0435 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0411\u0414."}),(0,d.jsxs)(s.ol,{start:"10",children:["\n",(0,d.jsxs)(s.li,{children:["\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 2\u0439 \u0438 3\u0439 \u0443\u0437\u043b\u044b \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 ETCD \u043a\u0430\u043a \u044d\u0442\u043e \u0443\u043a\u0430\u0437\u0430\u043d\u043e \u0432 \u0438\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u0438 \u043a\n",(0,d.jsx)(s.a,{href:"#%D0%B2%D0%BE%D1%81%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-%D1%83%D0%B7%D0%BB%D0%B0-%D0%B8%D0%B7-%D0%BC%D0%B3%D0%BD%D0%BE%D0%B2%D0%B5%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE-%D1%81%D0%BD%D0%B8%D0%BC%D0%BA%D0%B0",children:"\u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044e \u0441 \u043e\u0434\u043d\u043e\u0433\u043e \u0443\u0437\u043b\u0430"})," \u0434\u043b\u044f ",(0,d.jsx)(s.code,{children:"Master-2"})," \u0438 ",(0,d.jsx)(s.code,{children:"Master-3"}),"."]}),"\n"]})]})]}),"\n",(0,d.jsx)(s.p,{children:"\u041d\u0430 \u044d\u0442\u043e\u043c \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043e."})]})}function f(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,d.jsx)(s,{...e,children:(0,d.jsx)(S,{...e})}):S(e)}function y(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},63770:(e,s,t)=>{t.d(s,{M:()=>r});const r={kubernetes:{value:"v1.30.4"},etcd:{value:"3.5.12-0"},etcdctl:{value:"v3.5.12"},runc:{value:"v1.1.12"},containerd:{value:"1.7.19"},crictl:{value:"v1.30.0"}}},74793:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>p,contentTitle:()=>j,default:()=>A,frontMatter:()=>x,metadata:()=>r,toc:()=>E});const r=JSON.parse('{"id":"tech-docs/etcd/troubleshooting/restore/SingleNodeK8s","title":"SingleNodeK8s","description":"\u0415\u0441\u043b\u0438 \u0430\u0434\u0440\u0435\u0441 \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0443\u043a\u0430\u0437\u0430\u043d \u0432 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0434\u0440\u0443\u0433\u0438\u0445 \u0435\u0449\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0445 \u0443\u0437\u043b\u043e\u0432, \u043e\u043d\u0438 \u0443\u043f\u0430\u0434\u0443\u0442 \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439, \u043f\u043e\u043a\u0430 \u043d\u0435 \u0431\u0443\u0434\u0443\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u044b \u043a \u043d\u043e\u0432\u043e\u043c\u0443 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0443.","source":"@site/docs/tech-docs/etcd/troubleshooting/restore/singleNodeK8s.mdx","sourceDirName":"tech-docs/etcd/troubleshooting/restore","slug":"/tech-docs/etcd/troubleshooting/restore/SingleNodeK8s","permalink":"/tech-docs/etcd/troubleshooting/restore/SingleNodeK8s","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"SingleNodeK8s"}}');var d=t(74848),n=t(28453),l=t(1775),c=t(60513),i=t(7478),a=t(87464),h=t(62774),o=t(10119),D=t(80206),u=t(57462);const x={id:"SingleNodeK8s"},j=void 0,p={},E=[];function $(e){const s={a:"a",admonition:"admonition",code:"code",li:"li",ol:"ol",p:"p",...(0,n.R)(),...e.components};return u.iJ||N("SingleNodeFunctionsK8s",!1),u.iJ.Input1||N("SingleNodeFunctionsK8s.Input1",!0),u.iJ.Master1ETCDArgs||N("SingleNodeFunctionsK8s.Master1ETCDArgs",!0),u.iJ.Master2ETCDArgs||N("SingleNodeFunctionsK8s.Master2ETCDArgs",!0),u.iJ.Master3ETCDArgs||N("SingleNodeFunctionsK8s.Master3ETCDArgs",!0),u.iJ.Output1||N("SingleNodeFunctionsK8s.Output1",!0),u.iJ.Provider||N("SingleNodeFunctionsK8s.Provider",!0),(0,d.jsxs)(u.iJ.Provider,{children:[(0,d.jsx)(u.iJ.Input1,{}),(0,d.jsx)(u.iJ.Output1,{}),(0,d.jsx)(s.admonition,{type:"warning",children:(0,d.jsx)(s.p,{children:"\u0415\u0441\u043b\u0438 \u0430\u0434\u0440\u0435\u0441 \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0443\u043a\u0430\u0437\u0430\u043d \u0432 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0434\u0440\u0443\u0433\u0438\u0445 \u0435\u0449\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0445 \u0443\u0437\u043b\u043e\u0432, \u043e\u043d\u0438 \u0443\u043f\u0430\u0434\u0443\u0442 \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439, \u043f\u043e\u043a\u0430 \u043d\u0435 \u0431\u0443\u0434\u0443\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u044b \u043a \u043d\u043e\u0432\u043e\u043c\u0443 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0443."})}),(0,d.jsxs)(h.A,{groupId:"etcd-node",children:[(0,d.jsxs)(a.A,{value:"Master-1",children:[(0,d.jsxs)(s.ol,{children:["\n",(0,d.jsxs)(s.li,{children:["\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0444\u0430\u0439\u043b \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043d\u0438\u043c\u043a\u0430 \u043d\u0430 \u0412\u041c \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e \u043f\u0443\u0442\u0438 ",(0,d.jsxs)("code",{children:[o.D.workDir.value,"/backup.db"]})," \u043f\u0440\u0438 \u043f\u043e\u043c\u043e\u0449\u0438 rsync"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        ssh \${K8S_NODE_USERNAME}@\${K8S_NODE_ADDRESS_1} "mkdir -p ${o.D.workDir.value}"
        rsync --rsync-path="sudo rsync" \
        ${o.D.workDir.value}/backup.db \
          \${K8S_NODE_USERNAME}@\${K8S_NODE_ADDRESS_1}:${o.D.workDir.value}/backup.db
      `}),(0,d.jsxs)(s.ol,{start:"2",children:["\n",(0,d.jsxs)(s.li,{children:["\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a \u0412\u041c \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e ssh \u0438 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043d\u0430 \u0441\u0443\u043f\u0435\u0440\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.\n\u0417\u0430\u0442\u0435\u043c \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 ",(0,d.jsx)(s.code,{children:"kubelet"}),", \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u0438\u0442\u044c \u0435\u043c\u0443 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c ETCD."]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"systemctl stop kubelet"}),(0,d.jsxs)(s.ol,{start:"3",children:["\n",(0,d.jsxs)(s.li,{children:["\u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 \u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 ",(0,d.jsx)(s.code,{children:"etcd"}),":"]}),"\n"]}),(0,d.jsx)(s.p,{children:"\u0412\u044b\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043f\u0438\u0441\u043e\u043a \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0445 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0449\u0438\u0445 etcd \u0432 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0438 \u043f\u043e\u0434\u0430, \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430, \u0438\u043b\u0438 \u043d\u0435\u0439\u043c\u0441\u043f\u0435\u0439\u0441\u0430"}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        crictl ps -o json |
        jq -r \
          '(["PODNAME","PODNAMESPACE","CONTAINERNAME","CONTAINERID"] | (., map(length*"-"))), (.containers[] | [.labels."io.kubernetes.pod.name", .labels."io.kubernetes.pod.namespace", .metadata.name, .id ])| @tsv' |
        grep -e "etcd" -e "PODNAME" -e "---"  |
        column -t
      `}),(0,d.jsx)(s.p,{children:"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0432\u044b\u0432\u043e\u0434 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0437\u0430\u0434\u0430\u0439\u0442\u0435 \u043d\u0435\u0439\u043c\u0441\u043f\u0435\u0439\u0441 \u0438 \u0438\u043c\u044f \u043f\u043e\u0434\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0443\u0436\u043d\u043e \u0443\u0434\u0430\u043b\u0438\u0442\u044c:"}),(0,d.jsx)(D.LX,{}),(0,d.jsx)(s.p,{children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u0443:"}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        crictl stop $(cidsearch \${SEARCH_POD_NAME} \${SEARCH_NAMESPACE})
        crictl rm $(cidsearch \${SEARCH_POD_NAME} \${SEARCH_NAMESPACE})
      `}),(0,d.jsxs)(s.ol,{start:"4",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 ",(0,d.jsx)(s.a,{href:"#%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-%D1%80%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%BD%D0%BE%D0%B9-%D0%BA%D0%BE%D0%BF%D0%B8%D0%B8-%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2-%D0%B1%D0%B4",children:"\u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e"}),"."]}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0441\u0442\u0430\u0440\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0438\u0437 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,d.jsx)("code",{children:o.D.dataDir.value})]}),"\n"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:`rm -rf ${o.D.dataDir.value}/*`}),(0,d.jsxs)(s.ol,{start:"6",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u044c\u0442\u0435 \u0411\u0414 \u0438\u0437 \u0441\u043d\u0438\u043c\u043a\u0430:"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        etcdctl snapshot restore ${o.D.workDir.value}/backup.db \
          --name=\${ETCD_NODE_NAME_1} \
          --data-dir ${o.D.dataDir.value} \
          --initial-advertise-peer-urls=https://\${K8S_NODE_ADDRESS_1}:\${ETCD_PEER_PORT} \
          --initial-cluster=\${ETCD_NODE_NAME_1}=https://\${K8S_NODE_ADDRESS_1}:\${ETCD_PEER_PORT}
      `}),(0,d.jsx)(s.admonition,{type:"note",children:(0,d.jsxs)(s.p,{children:["\u041e\u0431\u0440\u0430\u0442\u0438\u0442\u0435 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435, \u0447\u0442\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0444\u0430\u0439\u043b ",(0,d.jsx)(s.code,{children:"etcdctl"})," \u0438 \u0441\u043d\u0438\u043c\u043e\u043a \u0442\u0430\u043a \u0436\u0435 \u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0435\u043d \u043d\u0430 \u043c\u0430\u0441\u0442\u0435\u0440\u0435 \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,d.jsx)("code",{children:o.D.workDir.value}),".\n\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 ",(0,d.jsx)(s.code,{children:"data-dir"})," \u0443\u043a\u0430\u0437\u0430\u043d\u0430 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043c\u043e\u043d\u0442\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0432\u043d\u0443\u0442\u0440\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 ETCD \u0438 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432 \u0411\u0414."]})}),(0,d.jsxs)(s.ol,{start:"7",children:["\n",(0,d.jsxs)(s.li,{children:["\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0438 \u043f\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u043f\u0443\u0441\u043a\u0430 ETCD \u0432 \u0444\u0430\u0439\u043b\u0435 ",(0,d.jsxs)("code",{children:["$",i.M.kubernetesBaseFolderPath.value,"/manifests/etcd.yaml"]}),"\n\u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 ",(0,d.jsx)(s.code,{children:"spec.containers[0].command"}),".\n\u0410 \u0438\u043c\u0435\u043d\u043d\u043e \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0445 \u043f\u043e\u043b\u0435\u0439 \u0438 \u0438\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, \u043f\u043e\u043b\u044f \u043d\u0435 \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u0432 \u0434\u0430\u043d\u043d\u044b\u0439 \u043f\u0435\u0440\u0435\u0447\u0435\u043d\u044c \u0443\u0434\u0430\u043b\u044f\u0442\u044c \u043d\u0435 \u043d\u0443\u0436\u043d\u043e!"]}),"\n"]}),(0,d.jsx)(u.iJ.Master1ETCDArgs,{}),(0,d.jsxs)("table",{children:[(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440"}),(0,d.jsx)("th",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"advertise-client-urls"})," "]}),(0,d.jsx)("td",{children:"\u0410\u043d\u043e\u043d\u0441\u0438\u0440\u0443\u0435\u043c\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0443\u0437\u043b\u0443, \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432. \u0421\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442 \u0441 IP \u0430\u0434\u0440\u0435\u0441\u043e\u043c \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"cert-file"}),"             "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"client-cert-auth"}),"      "]}),(0,d.jsx)("td",{children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c/\u0432\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043f\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0443"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"data-dir"}),"              "]}),(0,d.jsx)("td",{children:"\u0414\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0444\u0430\u0439\u043b\u044b \u0411\u0414 ETCD"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"key-file"}),"              "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-client-urls"}),"    "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-metrics-urls"}),"   "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a \u043c\u0435\u0442\u0440\u0438\u043a\u0430\u043c (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-peer-urls"}),"      "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043e\u0442 \u0434\u0440\u0443\u0433\u0438\u0445 \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"name"}),"                  "]}),(0,d.jsx)("td",{children:"\u0418\u043c\u044f \u0443\u0437\u043b\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-cert-file"}),"        "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-client-cert-auth"})," "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-key-file"}),"         "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-trusted-ca-file"}),"  "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"trusted-ca-file"}),"       "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]})]}),(0,d.jsx)(s.admonition,{type:"warning",children:(0,d.jsxs)(s.p,{children:["\u0415\u0441\u043b\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 ",(0,d.jsx)(s.code,{children:"initial-cluster-state"})," \u0440\u0430\u0432\u0435\u043d \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044e ",(0,d.jsx)(s.code,{children:"existing"})," \u0438\u043b\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0444\u0430\u0439\u043b\u044b \u0411\u0414 \u0438 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u043d\u0435\u0439, \u0442\u043e\u0433\u0434\u0430 \u0432\u0441\u0435 \u043f\u0440\u043e\u0447\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b, \u0438\u043c\u044f \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442\u0441\u044f \u0441\u043e \u0441\u043b\u043e\u0432\u0430 ",(0,d.jsx)(s.code,{children:"initial"}),' \u0431\u0443\u0434\u0443\u0442 \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f. \u0412 \u043d\u0430\u0448\u0435\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u043c\u044b \u0443\u0436\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u043b\u0438 \u0444\u0430\u0439\u043b\u044b \u0411\u0414 \u0438 \u0432\u043d\u0435\u0441\u043b\u0438 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430 \u044d\u0442\u0430\u043f\u0435 \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0438 \u0411\u0414 \u0438\u0437 \u0441\u043d\u0438\u043c\u043a\u0430."']})}),(0,d.jsxs)(s.ol,{start:"8",children:["\n",(0,d.jsx)(s.li,{children:"\u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 kubelet:"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        systemctl start kubelet
      `}),(0,d.jsxs)(s.ol,{start:"9",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0438 \u043b\u043e\u0433\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430"}),"\n"]}),(0,d.jsx)(s.p,{children:"\u0412\u044b\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043f\u0438\u0441\u043e\u043a \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0445 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0449\u0438\u0445 etcd \u0432 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0438 \u043f\u043e\u0434\u0430, \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430, \u0438\u043b\u0438 \u043d\u0435\u0439\u043c\u0441\u043f\u0435\u0439\u0441\u0430"}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        crictl ps -o json |
        jq -r \
          '(["PODNAME","PODNAMESPACE","CONTAINERNAME","CONTAINERID"] | (., map(length*"-"))), (.containers[] | [.labels."io.kubernetes.pod.name", .labels."io.kubernetes.pod.namespace", .metadata.name, .id ])| @tsv' |
        grep -e "etcd" -e "PODNAME" -e "---"  |
        column -t
      `}),(0,d.jsx)(s.p,{children:"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0432\u044b\u0432\u043e\u0434 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0437\u0430\u0434\u0430\u0439\u0442\u0435 \u043d\u0435\u0439\u043c\u0441\u043f\u0435\u0439\u0441 \u0438 \u0438\u043c\u044f \u043f\u043e\u0434\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0443\u0436\u043d\u043e \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c:"}),(0,d.jsx)(D.LX,{}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        crictl ps $(cidsearch \${SEARCH_POD_NAME} \${SEARCH_NAMESPACE})
        crictl logs $(cidsearch \${SEARCH_POD_NAME} \${SEARCH_NAMESPACE})
      `}),(0,d.jsxs)(s.ol,{start:"11",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u041f\u0440\u0438 \u043f\u043e\u043c\u043e\u0449\u0438 \u043a\u043e\u043c\u0430\u043d\u0434 ",(0,d.jsx)(s.code,{children:"etcdctl member list"})," \u0438 ",(0,d.jsx)(s.code,{children:"etcdctl endpoint status --cluster"})," \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."]}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"\u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0438\u0442\u0435 \u043a \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0435 \u0432\u0442\u043e\u0440\u043e\u0433\u043e \u0443\u0437\u043b\u0430."}),"\n"]}),"\n"]})]}),(0,d.jsxs)(a.A,{value:"Master-2",children:[(0,d.jsxs)(s.ol,{children:["\n",(0,d.jsx)(s.li,{children:"\u041d\u0430 \u043f\u0435\u0440\u0432\u043e\u043c \u0443\u0437\u043b\u0435 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0434\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0432\u0442\u043e\u0440\u043e\u0439 \u0443\u0437\u0435\u043b \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 \u043e\u0431\u0443\u0447\u0430\u044e\u0449\u0435\u0433\u043e\u0441\u044f:"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"etcdctl member add ${ETCD_NODE_NAME_2} --peer-urls=https://${K8S_NODE_ADDRESS_2}:${ETCD_PEER_PORT} --learner ;"}),(0,d.jsxs)(s.ol,{start:"2",children:["\n",(0,d.jsxs)(s.li,{children:["\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a \u0412\u041c  \u0432\u0442\u043e\u0440\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e ssh \u0438 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 ",(0,d.jsx)(s.code,{children:"kubelet"}),", \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u0438\u0442\u044c \u0435\u043c\u0443 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c ETCD."]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"systemctl stop kubelet"}),(0,d.jsxs)(s.ol,{start:"3",children:["\n",(0,d.jsxs)(s.li,{children:["\u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 \u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 ",(0,d.jsx)(s.code,{children:"etcd"}),":"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        export CONTAINER_ID="$(crictl ps -a  \
          --label io.kubernetes.container.name=etcd \
          --label io.kubernetes.pod.namespace=kube-system \
          | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"
        crictl stop \${CONTAINER_ID}
        crictl rm \${CONTAINER_ID}
      `}),(0,d.jsxs)(s.ol,{start:"4",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 ",(0,d.jsx)(s.a,{href:"#%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-%D1%80%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%BD%D0%BE%D0%B9-%D0%BA%D0%BE%D0%BF%D0%B8%D0%B8-%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2-%D0%B1%D0%B4",children:"\u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e"}),"."]}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0441\u0442\u0430\u0440\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0438\u0437 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,d.jsx)("code",{children:o.D.dataDir.value})]}),"\n"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:`rm -rf ${o.D.workDir.value}/*`}),(0,d.jsxs)(s.ol,{start:"6",children:["\n",(0,d.jsxs)(s.li,{children:["\u041e\u0442\u043a\u0440\u043e\u0439\u0442\u0435 \u043d\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0444\u0430\u0439\u043b ",(0,d.jsxs)("code",{children:["$",i.M.kubernetesBaseFolderPath.value,"/manifests/etcd.yaml"]}),":\n\u041d\u0430\u0439\u0434\u0438\u0442\u0435 \u0438 \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0445 \u043a\u043b\u044e\u0447\u0435\u0439 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 ",(0,d.jsx)(s.code,{children:"spec.containers[0].command"})," \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u043e \u043f\u0440\u0438\u043c\u0435\u0440\u0443 \u043d\u0438\u0436\u0435\n\u0432 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0438 \u0441 \u0432\u0430\u0448\u0438\u043c\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438\u0438 \u0442\u0430\u0431\u043b\u0438\u0446\u0435\u0439 \u0441 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435\u043c:"]}),"\n"]}),(0,d.jsx)(u.iJ.Master2ETCDArgs,{}),(0,d.jsxs)("table",{children:[(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440"}),(0,d.jsx)("th",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"advertise-client-urls"}),"       "]}),(0,d.jsx)("td",{children:"\u0410\u043d\u043e\u043d\u0441\u0438\u0440\u0443\u0435\u043c\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0443\u0437\u043b\u0443, \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432. \u0421\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442 \u0441 IP \u0430\u0434\u0440\u0435\u0441\u043e\u043c \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"cert-file"}),"                   "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"client-cert-auth"}),"            "]}),(0,d.jsx)("td",{children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c/\u0432\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043f\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0443"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"data-dir"}),"                    "]}),(0,d.jsx)("td",{children:"\u0414\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0444\u0430\u0439\u043b\u044b \u0411\u0414 ETCD"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"key-file"}),"                    "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"initial-advertise-peer-urls"})," "]}),(0,d.jsx)("td",{children:"\u0410\u043d\u043e\u043d\u0441\u0438\u0440\u0443\u0435\u043c\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0434\u0430\u043d\u043d\u043e\u043c\u0443 \u0443\u0437\u043b\u0443 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"initial-cluster"}),"             "]}),(0,d.jsx)("td",{children:"\u041f\u0435\u0440\u0435\u0447\u0435\u043d\u044c \u0443\u0437\u043b\u043e\u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 ETCD \u0438 \u0438\u0445 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u0432 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0411\u0414 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0443\u0437\u043b\u0430."})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-client-urls"}),"          "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-metrics-urls"}),"         "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a \u043c\u0435\u0442\u0440\u0438\u043a\u0430\u043c (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-peer-urls"}),"            "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043e\u0442 \u0434\u0440\u0443\u0433\u0438\u0445 \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"name"}),"                        "]}),(0,d.jsx)("td",{children:"\u0418\u043c\u044f \u0443\u0437\u043b\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-cert-file"}),"              "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-client-cert-auth"}),"       "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-key-file"}),"               "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-trusted-ca-file"}),"        "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"trusted-ca-file"}),"             "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]})]}),(0,d.jsxs)(s.ol,{start:"7",children:["\n",(0,d.jsx)(s.li,{children:"\u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 kubelet:"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"systemctl start kubelet"}),(0,d.jsxs)(s.ol,{start:"8",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0438 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043e\u0448\u0438\u0431\u043e\u043a"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        export CONTAINER_ID="$(crictl ps -a  \
          --label io.kubernetes.container.name=etcd \
          --label io.kubernetes.pod.namespace=kube-system \
          | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"

        crictl ps --id $CONTAINER_ID

        crictl logs $CONTAINER_ID
      `}),(0,d.jsxs)(s.ol,{start:"9",children:["\n",(0,d.jsxs)(s.li,{children:["\u0412\u0435\u0440\u043d\u0438\u0442\u0435\u0441\u044c \u043a \u043f\u0435\u0440\u0432\u043e\u043c\u0443 \u0443\u0437\u043b\u0443 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435, \u0447\u0442\u043e \u0432\u0442\u043e\u0440\u043e\u0439 \u0443\u0437\u0435\u043b \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u043b\u0441\u044f (\u0415\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c ",(0,d.jsx)(s.code,{children:"started"}),"):"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"ectl member list -w table"}),(0,d.jsxs)(s.ol,{start:"10",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u043e\u0441\u043b\u0435 \u044d\u0442\u043e\u0433\u043e \u043f\u0435\u0440\u0435\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0442\u043e\u0440\u043e\u0439 \u0443\u0437\u0435\u043b \u0432 \u0440\u0430\u0431\u043e\u0447\u0438\u0439 \u0440\u0435\u0436\u0438\u043c:"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"ectl member promote ${ETCD_NODE_NAME_2}"}),(0,d.jsxs)(s.ol,{start:"11",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u041f\u0440\u0438 \u043f\u043e\u043c\u043e\u0449\u0438 \u043a\u043e\u043c\u0430\u043d\u0434 ",(0,d.jsx)(s.code,{children:"member list"})," \u0438 ",(0,d.jsx)(s.code,{children:"endpoint status"})," \u043e\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0445 \u0432\u044b\u0448\u0435 ",(0,d.jsx)(s.a,{href:"#%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0-%D0%BF%D0%BE%D0%B4%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D1%8F-%D0%B8-%D1%81%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%B8%D1%8F-%D0%BA%D0%BB%D0%B0%D1%81%D1%82%D0%B5%D1%80%D0%B0",children:"\u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"}),"."]}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"\u041f\u0435\u0440\u0435\u0445\u043e\u0434\u0438\u0442\u0435 \u043a \u0442\u0440\u0435\u0442\u044c\u0435\u043c\u0443 \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"}),"\n"]}),"\n"]})]}),(0,d.jsxs)(a.A,{value:"Master-3",children:[(0,d.jsxs)(s.ol,{children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a \u043f\u0435\u0440\u0432\u043e\u043c\u0443 \u0443\u0437\u043b\u0443 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0438 \u0434\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0442\u0440\u0435\u0442\u0438\u0439 \u0443\u0437\u0435\u043b \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 \u043e\u0431\u0443\u0447\u0430\u044e\u0449\u0435\u0433\u043e\u0441\u044f:"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"etcdctl member add ${ETCD_NODE_NAME_3} --peer-urls=https://${K8S_NODE_ADDRESS_3}:${ETCD_PEER_PORT} --learner ;"}),(0,d.jsxs)(s.ol,{start:"2",children:["\n",(0,d.jsxs)(s.li,{children:["\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a \u0412\u041c  \u0442\u0440\u0435\u0442\u044c\u0435\u0433\u043e \u0443\u0437\u043b\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e ssh \u0438 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 ",(0,d.jsx)(s.code,{children:"kubelet"}),", \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u0438\u0442\u044c \u0435\u043c\u0443 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c ETCD."]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"systemctl stop kubelet"}),(0,d.jsxs)(s.ol,{start:"3",children:["\n",(0,d.jsxs)(s.li,{children:["\u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 \u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 ",(0,d.jsx)(s.code,{children:"etcd"}),":"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        export CONTAINER_ID="$(crictl ps -a  \
          --label io.kubernetes.container.name=etcd \
          --label io.kubernetes.pod.namespace=kube-system \
          | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"
        crictl stop \${CONTAINER_ID}
        crictl rm \${CONTAINER_ID}
      `}),(0,d.jsxs)(s.ol,{start:"4",children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 ",(0,d.jsx)(s.a,{href:"#%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-%D1%80%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%BD%D0%BE%D0%B9-%D0%BA%D0%BE%D0%BF%D0%B8%D0%B8-%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2-%D0%B1%D0%B4",children:"\u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e"}),"."]}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["\u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0441\u0442\u0430\u0440\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0438\u0437 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 ",(0,d.jsx)("code",{children:o.D.dataDir.value})]}),"\n"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:`rm -rf ${o.D.workDir.value}/*`}),(0,d.jsxs)(s.ol,{start:"6",children:["\n",(0,d.jsxs)(s.li,{children:["\u041e\u0442\u043a\u0440\u043e\u0439\u0442\u0435 \u043d\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0444\u0430\u0439\u043b ",(0,d.jsxs)("code",{children:["$",i.M.kubernetesBaseFolderPath.value,"/manifests/etcd.yaml"]}),":\n\u041d\u0430\u0439\u0434\u0438\u0442\u0435 \u0438 \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0445 \u043a\u043b\u044e\u0447\u0435\u0439 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 ",(0,d.jsx)(s.code,{children:"spec.containers[0].command"})," \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u043e \u043f\u0440\u0438\u043c\u0435\u0440\u0443 \u043d\u0438\u0436\u0435\n\u0432 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0438 \u0441 \u0432\u0430\u0448\u0438\u043c\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438\u0438 \u0442\u0430\u0431\u043b\u0438\u0446\u0435\u0439 \u0441 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435\u043c:"]}),"\n"]}),(0,d.jsx)(u.iJ.Master3ETCDArgs,{}),(0,d.jsxs)("table",{children:[(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440"}),(0,d.jsx)("th",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"advertise-client-urls"}),"       "]}),(0,d.jsx)("td",{children:"\u0410\u043d\u043e\u043d\u0441\u0438\u0440\u0443\u0435\u043c\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0443\u0437\u043b\u0443, \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432. \u0421\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442 \u0441 IP \u0430\u0434\u0440\u0435\u0441\u043e\u043c \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"cert-file"}),"                   "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"client-cert-auth"}),"            "]}),(0,d.jsx)("td",{children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c/\u0432\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043f\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0443"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"data-dir"}),"                    "]}),(0,d.jsx)("td",{children:"\u0414\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0444\u0430\u0439\u043b\u044b \u0411\u0414 ETCD"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"key-file"}),"                    "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"initial-advertise-peer-urls"})," "]}),(0,d.jsx)("td",{children:"\u0410\u043d\u043e\u043d\u0441\u0438\u0440\u0443\u0435\u043c\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0434\u0430\u043d\u043d\u043e\u043c\u0443 \u0443\u0437\u043b\u0443 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"initial-cluster"}),"             "]}),(0,d.jsx)("td",{children:"\u041f\u0435\u0440\u0435\u0447\u0435\u043d\u044c \u0443\u0437\u043b\u043e\u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 ETCD \u0438 \u0438\u0445 \u0442\u043e\u0447\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u0432 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0411\u0414 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0443\u0437\u043b\u0430."})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-client-urls"}),"          "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-metrics-urls"}),"         "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a \u043c\u0435\u0442\u0440\u0438\u043a\u0430\u043c (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"listen-peer-urls"}),"            "]}),(0,d.jsxs)("td",{children:["\u0422\u043e\u0447\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 ETCD \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043e\u0442 \u0434\u0440\u0443\u0433\u0438\u0445 \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 (",(0,d.jsx)(s.code,{children:"0.0.0.0"}),", ",(0,d.jsx)(s.code,{children:"127.0.0.1"})," \u0438\u043b\u0438 IP \u0430\u0434\u0440\u0435\u0441 \u0443\u0437\u043b\u0430 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)"]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"name"}),"                        "]}),(0,d.jsx)("td",{children:"\u0418\u043c\u044f \u0443\u0437\u043b\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-cert-file"}),"              "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-client-cert-auth"}),"       "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-key-file"}),"               "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"peer-trusted-ca-file"}),"        "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsx)(s.code,{children:"trusted-ca-file"}),"             "]}),(0,d.jsx)("td",{children:"\u041f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"})]})]}),(0,d.jsxs)(s.ol,{start:"7",children:["\n",(0,d.jsx)(s.li,{children:"\u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 kubelet:"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"systemctl start kubelet"}),(0,d.jsxs)(s.ol,{start:"8",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0438 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043e\u0448\u0438\u0431\u043e\u043a"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:c.A`
        export CONTAINER_ID="$(crictl ps -a  \
          --label io.kubernetes.container.name=etcd \
          --label io.kubernetes.pod.namespace=kube-system \
          | awk 'NR>1{r=$1} $0~/Running/{exit} END{print r}')"

        crictl ps --id $CONTAINER_ID

        crictl logs $CONTAINER_ID
      `}),(0,d.jsxs)(s.ol,{start:"9",children:["\n",(0,d.jsxs)(s.li,{children:["\u0412\u0435\u0440\u043d\u0438\u0442\u0435\u0441\u044c \u043a \u043f\u0435\u0440\u0432\u043e\u043c\u0443 \u0443\u0437\u043b\u0443 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435, \u0447\u0442\u043e \u0442\u0440\u0435\u0442\u0438\u0439 \u0443\u0437\u0435\u043b \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u043b\u0441\u044f (\u0415\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c ",(0,d.jsx)(s.code,{children:"started"}),"):"]}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"ectl member list -w table"}),(0,d.jsxs)(s.ol,{start:"10",children:["\n",(0,d.jsx)(s.li,{children:"\u041f\u043e\u0441\u043b\u0435 \u044d\u0442\u043e\u0433\u043e \u043f\u0435\u0440\u0435\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0440\u0435\u0442\u0438\u0439 \u0443\u0437\u0435\u043b \u0432 \u0440\u0430\u0431\u043e\u0447\u0438\u0439 \u0440\u0435\u0436\u0438\u043c:"}),"\n"]}),(0,d.jsx)(l.A,{language:"bash",children:"ectl member promote ${ETCD_NODE_NAME_3}"}),(0,d.jsxs)(s.ol,{start:"11",children:["\n",(0,d.jsxs)(s.li,{children:["\u041f\u0440\u0438 \u043f\u043e\u043c\u043e\u0449\u0438 \u043a\u043e\u043c\u0430\u043d\u0434 ",(0,d.jsx)(s.code,{children:"member list"})," \u0438 ",(0,d.jsx)(s.code,{children:"endpoint status"})," \u043e\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0445 \u0432\u044b\u0448\u0435 ",(0,d.jsx)(s.a,{href:"#%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0-%D0%BF%D0%BE%D0%B4%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D1%8F-%D0%B8-%D1%81%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%B8%D1%8F-%D0%BA%D0%BB%D0%B0%D1%81%D1%82%D0%B5%D1%80%D0%B0",children:"\u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430"}),"."]}),"\n"]})]})]}),(0,d.jsx)(s.p,{children:"\u041f\u043e\u0441\u043b\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0440\u0430\u0431\u043e\u0442 \u043d\u0430 \u0432\u0441\u0435\u0445 \u0442\u0440\u0435\u0445 \u0443\u0437\u043b\u0430\u0445 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u043a\u043b\u0430\u0441\u0442\u0435\u0440 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u0438 \u0433\u043e\u0442\u043e\u0432 \u043a \u0440\u0430\u0431\u043e\u0442\u0435."})]})}function A(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,d.jsx)(s,{...e,children:(0,d.jsx)($,{...e})}):$(e)}function N(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},78207:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>o,contentTitle:()=>h,default:()=>x,frontMatter:()=>a,metadata:()=>r,toc:()=>D});const r=JSON.parse('{"id":"tech-docs/etcd/troubleshooting/RestoreEtcdK8s","title":"RestoreEtcdK8s","description":"5.1.5.8.1.1. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441 \u043e\u0434\u043d\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0438\u0437 \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043d\u0438\u043c\u043a\u0430","source":"@site/docs/tech-docs/etcd/troubleshooting/restoreEtcdK8s.mdx","sourceDirName":"tech-docs/etcd/troubleshooting","slug":"/tech-docs/etcd/troubleshooting/RestoreEtcdK8s","permalink":"/tech-docs/etcd/troubleshooting/RestoreEtcdK8s","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"RestoreEtcdK8s"}}');var d=t(74848),n=t(28453),l=t(74793),c=t(8450),i=t(61087);const a={id:"RestoreEtcdK8s"},h=void 0,o={},D=[{value:"5.1.5.8.1.1. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441 \u043e\u0434\u043d\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0438\u0437 \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043d\u0438\u043c\u043a\u0430",id:"515811-\u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435-\u0441-\u043e\u0434\u043d\u043e\u0433\u043e-\u0443\u0437\u043b\u0430-\u0438\u0437-\u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e-\u0441\u043d\u0438\u043c\u043a\u0430",level:3},...l.toc,{value:"5.1.5.8.1.2. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0432\u0441\u0435\u0445 \u0442\u0440\u0435\u0445 \u0443\u0437\u043b\u043e\u0432 \u0438\u0437 \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043d\u0438\u043c\u043a\u0430",id:"515812-\u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435-\u0432\u0441\u0435\u0445-\u0442\u0440\u0435\u0445-\u0443\u0437\u043b\u043e\u0432-\u0438\u0437-\u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e-\u0441\u043d\u0438\u043c\u043a\u0430",level:3},...c.toc,{value:"5.1.5.8.1.3. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u0440\u0438 \u043a\u043e\u043d\u0444\u043b\u0438\u043a\u0442\u0430\u0445 \u0438\u043b\u0438 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430\u0445 \u0441 \u043a\u0432\u043e\u0440\u0443\u043c\u043e\u043c",id:"515813-\u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435-\u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430-\u043f\u0440\u0438-\u043a\u043e\u043d\u0444\u043b\u0438\u043a\u0442\u0430\u0445-\u0438\u043b\u0438-\u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430\u0445-\u0441-\u043a\u0432\u043e\u0440\u0443\u043c\u043e\u043c",level:3},...i.toc];function u(e){const s={h3:"h3",hr:"hr",p:"p",...(0,n.R)(),...e.components},{Details:t}=s;return t||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.h3,{id:"515811-\u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435-\u0441-\u043e\u0434\u043d\u043e\u0433\u043e-\u0443\u0437\u043b\u0430-\u0438\u0437-\u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e-\u0441\u043d\u0438\u043c\u043a\u0430",children:"5.1.5.8.1.1. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441 \u043e\u0434\u043d\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0438\u0437 \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043d\u0438\u043c\u043a\u0430"}),"\n",(0,d.jsx)(s.p,{children:"\u0414\u0430\u043d\u043d\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u043f\u043e\u0434\u0440\u0430\u0437\u0443\u043c\u0435\u0432\u0430\u0435\u0442, \u0447\u0442\u043e \u0431\u044d\u043a\u0430\u043f \u0440\u0430\u0437\u0432\u043e\u0440\u0430\u0447\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u043f\u0435\u0440\u0432\u043e\u043c \u0443\u0437\u043b\u0435 \u0438 \u043a\u043b\u0430\u0441\u0442\u0435\u0440 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 \u043e\u0434\u043d\u043e\u0433\u043e \u0443\u0437\u043b\u0430.\n\u0414\u0430\u043b\u0435\u0435 \u043f\u043e\u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e \u0431\u0443\u0434\u0443\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0442\u044c\u0441\u044f \u0434\u0440\u0443\u0433\u0438\u0435 \u0443\u0437\u043b\u044b \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."}),"\n",(0,d.jsxs)(t,{children:[(0,d.jsx)("summary",{children:"\u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f"}),(0,d.jsx)(l.default,{})]}),"\n",(0,d.jsx)(s.hr,{}),"\n",(0,d.jsx)(s.h3,{id:"515812-\u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435-\u0432\u0441\u0435\u0445-\u0442\u0440\u0435\u0445-\u0443\u0437\u043b\u043e\u0432-\u0438\u0437-\u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e-\u0441\u043d\u0438\u043c\u043a\u0430",children:"5.1.5.8.1.2. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0432\u0441\u0435\u0445 \u0442\u0440\u0435\u0445 \u0443\u0437\u043b\u043e\u0432 \u0438\u0437 \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043d\u0438\u043c\u043a\u0430"}),"\n",(0,d.jsx)(s.p,{children:"\u0414\u0430\u043d\u043d\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u043f\u043e\u0434\u0440\u0430\u0437\u0443\u043c\u0435\u0432\u0430\u0435\u0442 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0411\u0414 \u0438 \u0435\u0435 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0445 \u043d\u0430 \u0432\u0441\u0435\u0445 \u0442\u0440\u0435\u0445 \u0443\u0437\u043b\u0430\u0445 \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e."}),"\n",(0,d.jsxs)(t,{children:[(0,d.jsx)("summary",{children:"\u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f"}),(0,d.jsx)(c.default,{})]}),"\n",(0,d.jsx)(s.hr,{}),"\n",(0,d.jsx)(s.h3,{id:"515813-\u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435-\u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430-\u043f\u0440\u0438-\u043a\u043e\u043d\u0444\u043b\u0438\u043a\u0442\u0430\u0445-\u0438\u043b\u0438-\u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430\u0445-\u0441-\u043a\u0432\u043e\u0440\u0443\u043c\u043e\u043c",children:"5.1.5.8.1.3. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u0440\u0438 \u043a\u043e\u043d\u0444\u043b\u0438\u043a\u0442\u0430\u0445 \u0438\u043b\u0438 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430\u0445 \u0441 \u043a\u0432\u043e\u0440\u0443\u043c\u043e\u043c"}),"\n",(0,d.jsx)(s.p,{children:"\u0414\u0430\u043d\u043d\u0430\u044f \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u044c \u043c\u043e\u0436\u0435\u0442 \u0432\u043e\u0437\u043d\u0438\u043a\u043d\u0443\u0442\u044c \u0432 \u0441\u043b\u0443\u0447\u0430\u044f\u0445:"}),"\n",(0,d.jsx)(s.p,{children:"I. \u041f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e\u044f\u0432\u0438\u043b\u043e\u0441\u044c \u0431\u043e\u043b\u044c\u0448\u0435 \u0438\u043b\u0438 \u043c\u0435\u043d\u044c\u0448\u0435 3\u0445 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0449\u0438\u0445 \u0443\u0437\u043b\u043e\u0432 K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430.\nII. \u0420\u0430\u0441\u043f\u0430\u043b\u0441\u044f \u043a\u0432\u043e\u0440\u0443\u043c ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430.\nIII. \u041f\u043e\u0432\u0440\u0435\u0436\u0434\u0435\u043d\u044b \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0411\u0414 \u043d\u0430 \u043e\u0434\u043d\u043e\u043c \u0438\u043b\u0438 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0443\u0437\u043b\u0430\u0445 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."}),"\n",(0,d.jsxs)(t,{children:[(0,d.jsx)("summary",{children:"\u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f"}),(0,d.jsx)(i.default,{})]})]})}function x(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,d.jsx)(s,{...e,children:(0,d.jsx)(u,{...e})}):u(e)}},80206:(e,s,t)=>{t.d(s,{QH:()=>h,LX:()=>a,iu:()=>j});var r=t(96540),d=t(1775),n=t(74848);var l=t(71635),c=t(97833),i=t(60513);const a=()=>{const[e,s]=(0,r.useState)(),[t,a]=(0,r.useState)();return(0,n.jsxs)(l.A,{vertical:!0,gap:"small",children:[(0,n.jsx)(c.A,{placeholder:"namespace",value:e,onChange:e=>s(e.target.value)}),(0,n.jsx)(c.A,{placeholder:"pod",value:t,onChange:e=>a(e.target.value)}),(0,n.jsx)(d.A,{language:"bash",children:i.A`
          export SEARCH_NAMESPACE=${e}
          export SEARCH_POD_NAME=${t}
          `})]})},h=()=>{const[e,s]=(0,r.useState)(),[t,a]=(0,r.useState)(),[h,o]=(0,r.useState)(),[D,u]=(0,r.useState)();return(0,n.jsxs)(l.A,{vertical:!0,gap:"small",children:[(0,n.jsx)(c.A,{placeholder:"namespace",value:e,onChange:e=>s(e.target.value)}),(0,n.jsx)(c.A,{placeholder:"pod",value:t,onChange:e=>a(e.target.value)}),(0,n.jsx)(c.A,{placeholder:"ssh node username",value:h,onChange:e=>o(e.target.value)}),(0,n.jsx)(c.A,{placeholder:"backup filename",value:D,onChange:e=>u(e.target.value)}),(0,n.jsx)(d.A,{language:"bash",children:i.A`
          export SEARCH_NAMESPACE=${e}
          export SEARCH_POD_NAME=${t}
          export NODE_USERNAME=${h}
          export BACKUP_FILE=${D}
          `})]})};var o=t(62774),D=t(87464);const u=e=>{let{command:s}=e;return(0,n.jsxs)("table",{children:[(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"}),(0,n.jsx)("th",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"})]})," ",(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)(d.A,{language:"bash",children:`${s} --endpoints=$(${s}Members) member list -w table`})}),(0,n.jsx)("td",{children:"\u0412\u044b\u0432\u0435\u0441\u0442\u0438 \u043f\u0435\u0440\u0435\u0447\u0435\u043d\u044c \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0441 \u043e\u0434\u043d\u043e\u0433\u043e \u0438\u0437 \u0443\u0437\u043b\u043e\u0432 \u0432 \u0442\u0430\u0431\u043b\u0438\u0447\u043d\u043e\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435"})]})," ",(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)(d.A,{language:"bash",children:`${s} --endpoints=$(${s}Members) endpoint status -w table`})}),(0,n.jsx)("td",{children:"\u0412\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u0442\u0430\u0442\u0443\u0441 \u0443\u0437\u043b\u043e\u0432 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0432 \u0442\u0430\u0431\u043b\u0438\u0447\u043d\u043e\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435"})]})," ",(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)(d.A,{language:"bash",children:`${s} --endpoints=$(${s}Members) get / --prefix`})}),(0,n.jsx)("td",{children:"\u0412\u044b\u0432\u0435\u0441\u0442\u0438 \u0432\u0441\u0435 \u043a\u043b\u044e\u0447\u0438 \u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, \u0447\u0435\u0439 \u043a\u043b\u044e\u0447 \u0443\u0434\u043e\u0432\u043b\u0435\u0442\u0432\u043e\u0440\u044f\u0435\u0442 \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u043c\u0443 \u043f\u0440\u0435\u0444\u0438\u043a\u0441\u0443."})]})," ",(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)(d.A,{language:"bash",children:`${s} --endpoints=$(${s}Members) get / --prefix --keys-only`})}),(0,n.jsx)("td",{children:"\u0412\u044b\u0432\u0435\u0441\u0442\u0438 \u0432\u0441\u0435 \u043a\u043b\u044e\u0447\u0438, \u0447\u0435\u0439 \u043a\u043b\u044e\u0447 \u0443\u0434\u043e\u0432\u043b\u0435\u0442\u0432\u043e\u0440\u044f\u0435\u0442 \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u043c\u0443 \u043f\u0440\u0435\u0444\u0438\u043a\u0441\u0443."})]})," ",(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)(d.A,{language:"bash",children:`${s} --endpoints=$(${s}Members) snapshot save PATH_TO_SAVE.db`})}),(0,n.jsx)("td",{children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043c\u043e\u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u043d\u0438\u043c\u043e\u043a \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 ETCD_api_address"})]})," ",(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)(d.A,{language:"bash",children:`${s} --endpoints=$(${s}Members) defrag --cluster`})}),(0,n.jsx)("td",{children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0434\u0435\u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e \u0444\u0430\u0439\u043b\u043e\u0432 \u0411\u0414. (\u041f\u0440\u0438 \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u043e\u043c \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435 \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u0441 \u0444\u043b\u0430\u0433\u043e\u043c --data-dir \u0438 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u043d\u0438\u0435\u043c \u043f\u0443\u0442\u0438 \u0434\u043e \u0444\u0430\u0439\u043b\u0430)"})]})," ",(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)(d.A,{language:"bash",children:`${s} --endpoints=$(${s}Members) compaction \${INDEX}`})}),(0,n.jsx)("td",{children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043a\u043e\u043c\u043f\u043e\u043d\u043e\u0432\u043a\u0443 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u043d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c \u043d\u043e\u043c\u0435\u0440 \u0440\u0435\u0432\u0438\u0437\u0438\u0438"})]})]})},x=["etcdctl","ectl","nectl","kectl"],j=()=>(0,n.jsx)(o.A,{groupId:"etcd-alias",children:x.map((e=>(0,n.jsx)(D.A,{value:e,label:e,children:(0,n.jsx)(u,{command:e})},e)))})},91476:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>o,contentTitle:()=>h,default:()=>x,frontMatter:()=>a,metadata:()=>r,toc:()=>D});const r=JSON.parse('{"id":"tech-docs/etcd/troubleshooting/RestoreEtcdKubeApi","title":"RestoreEtcdKubeApi","description":"5.1.5.8.2.1. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441 \u043e\u0434\u043d\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0438\u0437 \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043d\u0438\u043c\u043a\u0430","source":"@site/docs/tech-docs/etcd/troubleshooting/restoreEtcdKupeApi.mdx","sourceDirName":"tech-docs/etcd/troubleshooting","slug":"/tech-docs/etcd/troubleshooting/RestoreEtcdKubeApi","permalink":"/tech-docs/etcd/troubleshooting/RestoreEtcdKubeApi","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"RestoreEtcdKubeApi"}}');var d=t(74848),n=t(28453),l=t(94422),c=t(16049),i=t(62582);const a={id:"RestoreEtcdKubeApi"},h=void 0,o={},D=[{value:"5.1.5.8.2.1. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441 \u043e\u0434\u043d\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0438\u0437 \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043d\u0438\u043c\u043a\u0430",id:"515821-\u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435-\u0441-\u043e\u0434\u043d\u043e\u0433\u043e-\u0443\u0437\u043b\u0430-\u0438\u0437-\u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e-\u0441\u043d\u0438\u043c\u043a\u0430",level:3},...l.toc,{value:"5.1.5.8.2.2. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0432\u0441\u0435\u0445 \u0442\u0440\u0435\u0445 \u0443\u0437\u043b\u043e\u0432 \u0438\u0437 \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043d\u0438\u043c\u043a\u0430",id:"515822-\u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435-\u0432\u0441\u0435\u0445-\u0442\u0440\u0435\u0445-\u0443\u0437\u043b\u043e\u0432-\u0438\u0437-\u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e-\u0441\u043d\u0438\u043c\u043a\u0430",level:3},...c.toc,{value:"5.1.5.8.2.3. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u0440\u0438 \u043a\u043e\u043d\u0444\u043b\u0438\u043a\u0442\u0430\u0445 \u0438\u043b\u0438 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430\u0445 \u0441 \u043a\u0432\u043e\u0440\u0443\u043c\u043e\u043c",id:"515823-\u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435-\u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430-\u043f\u0440\u0438-\u043a\u043e\u043d\u0444\u043b\u0438\u043a\u0442\u0430\u0445-\u0438\u043b\u0438-\u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430\u0445-\u0441-\u043a\u0432\u043e\u0440\u0443\u043c\u043e\u043c",level:3},...i.toc];function u(e){const s={h3:"h3",hr:"hr",p:"p",...(0,n.R)(),...e.components},{Details:t}=s;return t||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.h3,{id:"515821-\u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435-\u0441-\u043e\u0434\u043d\u043e\u0433\u043e-\u0443\u0437\u043b\u0430-\u0438\u0437-\u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e-\u0441\u043d\u0438\u043c\u043a\u0430",children:"5.1.5.8.2.1. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441 \u043e\u0434\u043d\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0438\u0437 \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043d\u0438\u043c\u043a\u0430"}),"\n",(0,d.jsx)(s.p,{children:"\u0414\u0430\u043d\u043d\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u043f\u043e\u0434\u0440\u0430\u0437\u0443\u043c\u0435\u0432\u0430\u0435\u0442, \u0447\u0442\u043e \u0431\u044d\u043a\u0430\u043f \u0440\u0430\u0437\u0432\u043e\u0440\u0430\u0447\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u043f\u0435\u0440\u0432\u043e\u043c \u0443\u0437\u043b\u0435 \u0438 \u043a\u043b\u0430\u0441\u0442\u0435\u0440 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 \u043e\u0434\u043d\u043e\u0433\u043e \u0443\u0437\u043b\u0430.\n\u0414\u0430\u043b\u0435\u0435 \u043f\u043e\u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e \u0431\u0443\u0434\u0443\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0442\u044c\u0441\u044f \u0434\u0440\u0443\u0433\u0438\u0435 \u0443\u0437\u043b\u044b \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."}),"\n",(0,d.jsxs)(t,{children:[(0,d.jsx)("summary",{children:"\u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f"}),(0,d.jsx)(l.default,{})]}),"\n",(0,d.jsx)(s.hr,{}),"\n",(0,d.jsx)(s.h3,{id:"515822-\u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435-\u0432\u0441\u0435\u0445-\u0442\u0440\u0435\u0445-\u0443\u0437\u043b\u043e\u0432-\u0438\u0437-\u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e-\u0441\u043d\u0438\u043c\u043a\u0430",children:"5.1.5.8.2.2. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0432\u0441\u0435\u0445 \u0442\u0440\u0435\u0445 \u0443\u0437\u043b\u043e\u0432 \u0438\u0437 \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043d\u0438\u043c\u043a\u0430"}),"\n",(0,d.jsx)(s.p,{children:"\u0414\u0430\u043d\u043d\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u043f\u043e\u0434\u0440\u0430\u0437\u0443\u043c\u0435\u0432\u0430\u0435\u0442, \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0411\u0414 \u0438 \u0435\u0435 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0445 \u043d\u0430 \u0432\u0441\u0435\u0445 \u0442\u0440\u0435\u0445 \u0443\u0437\u043b\u0430\u0445 \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e."}),"\n",(0,d.jsxs)(t,{children:[(0,d.jsx)("summary",{children:"\u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f"}),(0,d.jsx)(c.default,{})]}),"\n",(0,d.jsx)(s.hr,{}),"\n",(0,d.jsx)(s.h3,{id:"515823-\u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435-\u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430-\u043f\u0440\u0438-\u043a\u043e\u043d\u0444\u043b\u0438\u043a\u0442\u0430\u0445-\u0438\u043b\u0438-\u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430\u0445-\u0441-\u043a\u0432\u043e\u0440\u0443\u043c\u043e\u043c",children:"5.1.5.8.2.3. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u0440\u0438 \u043a\u043e\u043d\u0444\u043b\u0438\u043a\u0442\u0430\u0445 \u0438\u043b\u0438 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430\u0445 \u0441 \u043a\u0432\u043e\u0440\u0443\u043c\u043e\u043c"}),"\n",(0,d.jsx)(s.p,{children:"\u0414\u0430\u043d\u043d\u0430\u044f \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u044c \u043c\u043e\u0436\u0435\u0442 \u0432\u043e\u0437\u043d\u0438\u043a\u043d\u0443\u0442\u044c \u0432 \u0441\u043b\u0443\u0447\u0430\u044f\u0445:"}),"\n",(0,d.jsx)(s.p,{children:"I. \u041f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043f\u043e\u044f\u0432\u0438\u043b\u043e\u0441\u044c \u0431\u043e\u043b\u044c\u0448\u0435 \u0438\u043b\u0438 \u043c\u0435\u043d\u044c\u0448\u0435 3\u0445 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0449\u0438\u0445 \u0443\u0437\u043b\u043e\u0432 K8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430.\nII. \u0420\u0430\u0441\u043f\u0430\u043b\u0441\u044f \u043a\u0432\u043e\u0440\u0443\u043c ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430.\nIII. \u041f\u043e\u0432\u0440\u0435\u0436\u0434\u0435\u043d\u044b \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0411\u0414 \u043d\u0430 \u043e\u0434\u043d\u043e\u043c \u0438\u043b\u0438 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0443\u0437\u043b\u0430\u0445 ETCD \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430."}),"\n",(0,d.jsxs)(t,{children:[(0,d.jsx)("summary",{children:"\u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f"}),(0,d.jsx)(i.default,{})]})]})}function x(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,d.jsx)(s,{...e,children:(0,d.jsx)(u,{...e})}):u(e)}},94422:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>a,contentTitle:()=>i,default:()=>D,frontMatter:()=>c,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"tech-docs/etcd/troubleshooting/restore/SingleNodeKubeApi","title":"SingleNodeKubeApi","description":"","source":"@site/docs/tech-docs/etcd/troubleshooting/restore/singleNodeKubeApi.mdx","sourceDirName":"tech-docs/etcd/troubleshooting/restore","slug":"/tech-docs/etcd/troubleshooting/restore/SingleNodeKubeApi","permalink":"/tech-docs/etcd/troubleshooting/restore/SingleNodeKubeApi","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"SingleNodeKubeApi"}}');var d=t(74848),n=t(28453),l=t(57462);const c={id:"SingleNodeKubeApi"},i=void 0,a={},h=[];function o(e){return l.hy||u("SingleNodeFunctionsKubeApi",!1),l.hy.Master||u("SingleNodeFunctionsKubeApi.Master",!0),(0,d.jsx)(l.hy.Master,{})}function D(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,d.jsx)(s,{...e,children:(0,d.jsx)(o,{...e})}):o()}function u(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}}}]);