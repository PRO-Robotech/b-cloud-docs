---
id: kube-state-metrics-base
title: Kube State Metrics
description: Kube State Metrics
---

**Описание :** `Kube State Metrics` (`KSM`) — это специализированный сервис для сбора и экспорта метрик, отражающих текущее состояние объектов Kubernetes (Pods, Deployments, Nodes, Services и др.). Он преобразует данные о конфигурациях и статусах ресурсов кластера в формат, совместимый с системами мониторинга (Prometheus, VictoriaMetrics), что обеспечивает прозрачность работы кластера и оперативное выявление проблем.

**Функции:** `Kube State Metrics` имеет следующие основные функции:

- Сбор метрик состояния объектов. Отслеживает ключевые статусы Kubernetes-ресурсов:
  * Pods: фазы жизненного цикла (Running, Pending, Failed).
  * Deployments/StatefulSets/DaemonSets: количество доступных реплик, статус обновлений.
  * Nodes: условия работоспособности (Ready, DiskPressure, MemoryPressure).
  * PersistentVolumes: состояние привязки и использования.
- Анализ конфигураций. Предоставляет метрики для аудита настроек:
  * Ресурсные лимиты: запросы и ограничения CPU/памяти для контейнеров.
  * Версии образов: информация о Docker-образах, используемых в Pods.
  * Политики управления: стратегии рестарта, политики обновлений Deployment.
- Отслеживание изменений. Фиксирует события, связанные с:
  * Обновлениями конфигураций (например, изменения в Deployment).
  * Переходом объектов в состояние ошибки или восстановлением.
- Контроль доступности/ Формирует метрики для оценки работоспособности кластера:
  * Количество готовых Pods в сервисе.
  * Соответствие запущенных реплик заданным в конфигурации.
  * Проблемы с выделением ресурсов (например, недостаток памяти на нодах).
- Совместимость с `VictoriaMetrics`: `Kube State Metrics` полностью совместим с `VictoriaMetrics`.

**Особенности**:

* Фокус на состоянии объектов, а не на ресурсопотреблении. `KSM` не отслеживает использование CPU, памяти или диска — эти задачи решаются инструментами вроде `metrics-server` и `cAdvisor`.
* `Kube State Metrics` взаимодействует с API Kubernetes для получения актуальной информации о ресурсах. Для этого требуются соответствующие права RBAC.
* `Kube State Metrics` — это критически важный инструмент для администраторов Kubernetes, обеспечивающий глубокую видимость состояния кластера. Он дополняет метрики ресурсопотребления, позволяя комплексно управлять надежностью и производительностью системы.

