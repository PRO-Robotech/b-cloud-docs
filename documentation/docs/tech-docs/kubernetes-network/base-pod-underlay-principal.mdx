---
id: base-pod-principal
---

import {getBasePrefix} from '@site/src/utils/getBasePrefix'

# Подовая сеть

## Принцип работы подовой сети

Подовая сеть в Kubernetes обеспечивает связь между подами, расположенными на разных нодах кластера. В отличие от оверлейных сетей, которые накладывают дополнительный уровень абстракции поверх существующей сети, underlay-сеть использует возможности базовой сети для прямой маршрутизации трафика между подами без дополнительной инкапсуляции.

<div className="center">
  <img src={`${getBasePrefix()}img/network/underlay-network.drawio.svg`} />
</div>

## Ключевые концепции

1. **Базовая сеть (Underlay Network):**

- Underlay-сеть — это физическая или виртуальная сеть, обеспечивающая реальный путь передачи данных между нодами.
- Сетевые устройства (коммутаторы, маршрутизаторы) знают о всех IP-адресах, используемых подами.
- Трафик между подами маршрутизируется напрямую с использованием возможностей базовой сети без дополнительных наложений.

2. **Прямая маршрутизация:**

- Каждому поду присваивается IP-адрес, маршрутизируемый внутри сети кластера.
- Ноды настроены на прямую передачу трафика подов через сеть без использования туннелей.
- Сеть настраивается таким образом, чтобы знать, какие IP-диапазоны подов находятся на каких нодах.

3. **Конфигурация сети нод:**

- Каждая нода рекламирует IP-адреса подов (CIDR-блоки), которые она обслуживает, в сеть.
- Используются протоколы динамической маршрутизации (например, BGP) или статические маршруты для распространения этой информации.
- Альтернативно, сеть может быть настроена с использованием VLAN или подсетей для обеспечения достижимости IP-адресов подов.

4. **Отсутствие инкапсуляции:**

- В отличие от оверлейных сетей, использующих инкапсуляцию (например, VXLAN, GRE), underlay-сеть избегает связанных с этим накладных расходов.
- Это может привести к улучшению производительности сети за счет уменьшения обработки пакетов.

5. **Упрощенный мониторинг и отладка:**

- Поскольку трафик подов виден на сетевом уровне без инкапсуляции, можно использовать стандартные инструменты мониторинга сети.
- Эта прозрачность упрощает отладку и анализ производительности.

6. **Реализация сетевых политик:**

- Сетевые политики все еще могут быть применены, но могут потребовать поддержки со стороны базовой сети.
- Такие возможности безопасности, как списки контроля доступа (ACL) и межсетевые экраны, необходимо настроить на уровне сети.

## Практические аспекты реализации

#### Управление IP-адресами:

- Требуется тщательное планирование, чтобы гарантировать отсутствие конфликтов IP-адресов подов и их принадлежность к маршрутизируемым диапазонам.
- Необходимо выделить достаточно большой IP-адресный пространство для всех подов в кластере.

#### Масштабируемость:

- Сетевое оборудование должно обрабатывать потенциально большое количество маршрутов из-за большого числа IP-адресов подов.
- Протоколы динамической маршрутизации (такие как BGP с соответствующими настройками) могут помочь управлять проблемами масштабируемости.

#### Требования к сетевой инфраструктуре:

- Сетевые устройства должны поддерживать необходимые протоколы маршрутизации и обладать достаточной производительностью.
- Необходима тесная координация с сетевыми администраторами для правильной настройки сети.

#### Сценарии использования:

- Среды, где сетевой инфраструктурой полностью управляют администраторы кластера.
- Приложения, чувствительные к производительности, где нежелательны накладные расходы оверлейных сетей.
- Кластеры, расположенные в собственных центрах обработки данных с развитым сетевым оборудованием.

**Заключение:**

Подход использования underlay-сети для подовой сети Kubernetes опирается на существующую сетевую инфраструктуру для прямой маршрутизации трафика подов. Этот метод исключает необходимость в оверлеях и инкапсуляции, потенциально улучшая производительность и упрощая сетевые операции. Однако он требует более сложной настройки сети и тесного сотрудничества с сетевыми администраторами для управления распределением IP-адресов, маршрутизацией и политиками безопасности.
